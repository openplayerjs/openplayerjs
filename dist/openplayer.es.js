var $s=f=>{throw TypeError(f)},Ds=(f,t,s)=>t.has(f)||$s("Cannot "+s),e=(f,t,s)=>(Ds(f,t,"read from private field"),s?s.call(f):t.get(f)),h=(f,t,s)=>t.has(f)?$s("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(f):t.set(f,s),o=(f,t,s,i)=>(Ds(f,t,"write to private field"),i?i.call(f,s):t.set(f,s),s),Ps=(f,t,s,i)=>({set _(a){o(f,t,a,s)},get _(){return e(f,t,i)}}),$,B,Re,H,J,Is,pt,mt,Ht,qt,te,we,ae,Vt,ns,as,vt,os,rs,I,se,Q,D,ft,st,Kt,ls,N,C,q,hs,ds,w,S,y,Ve,be,Ee,W,St,cs,us,V,gt,ke,F,U,_t,ps,ms,X,fe,Ne,oe,Ue,$e,vs,fs,G,K,re,Ge,ge,le,it,zt,gs,Ut,bt,he,b,Me,_s,bs,Y,Ce,Es,ee,De,ys,O,ie,Gt,Qt,Ot,ks,Xt,Wt,As,Pt,It,xt,P,k,de,Rt,Qe,Yt,nt,Et,Nt,yt,Fe,Te,Se,at,$t,Ke,kt,Xe,x,At,ce,g,Ye,Ae,Ls,Oe,ye,qe,ne,Lt,Be,ot,rt,We,R,Je,Jt,Dt,Ft,Zt,ws,Ze,wt,Z,et,_,lt,z,ue,ht,Mt,Ct,dt,Bt,T,ct,Tt,ut;const Le=typeof window<"u"?window.navigator:null,ze=Le?Le.userAgent.toLowerCase():null,jt=ze?/iphone/i.test(ze)&&!window.MSStream:!1,_e=ze?/ipad|iphone|ipod/i.test(ze)&&!window.MSStream:!1,pe=ze?/android/i.test(ze):!1,Vs=ze?/chrome/i.test(ze):!1,Ks=ze?/safari/i.test(ze)&&!Vs:!1,Fs=typeof window<"u"?"MediaSource"in window:!1,zs=()=>{if(typeof window>"u")return!1;const f=window.MediaSource||window.WebKitMediaSource,t=window.SourceBuffer||window.WebKitSourceBuffer,s=f&&typeof f.isTypeSupported=="function"&&f.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),i=!t||t.prototype&&typeof t.prototype.appendBuffer=="function"&&typeof t.prototype.remove=="function";return!!s&&!!i&&!Ks},Bs=120,u={passive:!1};function Pe(f){return f.tagName.toLowerCase()==="video"}function me(f){return f.tagName.toLowerCase()==="audio"}function Ms(f){return new Promise((t,s)=>{const i=document.createElement("script");i.src=f,i.async=!0,i.onload=()=>{i.remove(),t()},i.onerror=()=>{i.remove(),s(new Error(`${f} could not be loaded`))},document.head&&document.head.appendChild(i)})}function es(f){const t=f.getBoundingClientRect();return{left:t.left+(window.pageXOffset||document.documentElement.scrollLeft),top:t.top+(window.pageYOffset||document.documentElement.scrollTop)}}function Ie(f,t=!0){const a=new DOMParser().parseFromString(f,"text/html").body||document.createElement("body"),n=a.querySelectorAll("script");for(let l=0,d=n.length;l<d;l++)n[l].remove();const r=l=>{const d=l.children;for(let p=0,A=d.length;p<A;p++){const m=d[p],{attributes:c}=m;for(let v=0,L=c.length;v<L;v++){const{name:M,value:j}=c[v],ve=j.replace(/\s+/g,"").toLowerCase();["src","href","xlink:href"].includes(M)&&(ve.includes("javascript:")||ve.includes("data:"))&&m.removeAttribute(M),M.startsWith("on")&&m.removeAttribute(M)}r(m)}};return r(a),t?(a.textContent||"").replace(/\s{2,}/g,""):a.innerHTML}function Us(f){let t;if(typeof DOMParser<"u")t=s=>new DOMParser().parseFromString(s,"text/xml");else return!1;try{if(t(f).getElementsByTagName("parsererror").length>0)return!1}catch{return!1}return!0}function E(f,t){let s={};return t&&t.detail&&(s={detail:t.detail}),new CustomEvent(f,s)}class Gs{constructor(t,s,i){h(this,$),h(this,B),h(this,Re),h(this,H),h(this,J,{button:{},global:{},media:{}}),h(this,Is),h(this,pt),h(this,mt,"off"),h(this,Ht),h(this,qt),o(this,$,t),o(this,Ht,s),o(this,qt,i),this._formatMenuItems=this._formatMenuItems.bind(this),this._setDefaultTrack=this._setDefaultTrack.bind(this),this._showCaptions=this._showCaptions.bind(this),this._hideCaptions=this._hideCaptions.bind(this)}create(){var t;const{labels:s,detachMenus:i}=e(this,$).getOptions();o(this,B,document.createElement("button")),e(this,B).className=`op-controls__captions op-control__${e(this,Ht)}`,e(this,B).tabIndex=0,e(this,B).title=s?.toggleCaptions||"",e(this,B).setAttribute("aria-controls",e(this,$).id),e(this,B).setAttribute("aria-pressed","false"),e(this,B).setAttribute("aria-label",s?.toggleCaptions||""),e(this,B).setAttribute("data-active-captions","off"),o(this,Re,document.createElement("div")),e(this,Re).className="op-captions";const a=e(this,$).getContainer();if(a.insertBefore(e(this,Re),a.firstChild),i){e(this,B).classList.add("op-control--no-hover"),o(this,H,document.createElement("div")),e(this,H).className="op-settings op-captions__menu",e(this,H).setAttribute("aria-hidden","true"),e(this,H).innerHTML=`<div class="op-settings__menu" role="menu" id="menu-item-captions">
                <div class="op-settings__submenu-item" tabindex="0" role="menuitemradio" aria-checked="${e(this,mt)==="off"?"true":"false"}">
                    <div class="op-settings__submenu-label op-subtitles__option" data-value="captions-off">${s?.off}</div>
                </div>
            </div>`;const n=document.createElement("div");n.className=`op-controls__container op-control__${e(this,Ht)}`,n.append(e(this,B),e(this,H)),e(this,$).getControls().getLayer(e(this,qt)).append(n);for(const r of e(this,$).getElement().textTracks){const l=document.createElement("div"),d=((t=s?.lang)==null?void 0:t[r.language])||null;l.className="op-settings__submenu-item",l.tabIndex=0,l.setAttribute("role","menuitemradio"),l.setAttribute("aria-checked",e(this,mt)===r.language?"true":"false"),l.innerHTML=`<div class="op-settings__submenu-label op-subtitles__option"
                    data-value="captions-${r.language}">
                    ${d||r.label}
                </div>`,e(this,H).append(l)}}else e(this,$).getControls().getLayer(e(this,qt)).append(e(this,B));["play","loadeddata"].forEach(n=>{e(this,J).button.click=l=>{var d;const p=l.target;if(i){const A=e(this,$).getContainer().querySelectorAll(".op-settings");for(const m of Array.from(A))m!==e(this,H)&&m.setAttribute("aria-hidden","true");e(this,H).getAttribute("aria-hidden")==="true"?e(this,H).setAttribute("aria-hidden","false"):e(this,H).setAttribute("aria-hidden","true")}else{p.setAttribute("aria-pressed","true"),p.classList.contains("op-controls__captions--on")?(p.classList.remove("op-controls__captions--on"),p.setAttribute("data-active-captions","off"),this._hideCaptions()):(p.classList.add("op-controls__captions--on"),p.setAttribute("data-active-captions",((d=e(this,pt))==null?void 0:d.language)||"off"),this._showCaptions());for(const A of e(this,$).getElement().textTracks)A.mode=p.getAttribute("data-active-captions")===A.language?"showing":"hidden"}},e(this,J).button.mouseover=()=>{if(!_e&&!pe&&i){const l=e(this,$).getContainer().querySelectorAll(".op-settings");for(let d=0,p=l.length;d<p;++d)l[d]!==e(this,H)&&l[d].setAttribute("aria-hidden","true");e(this,H).getAttribute("aria-hidden")==="true"&&e(this,H).setAttribute("aria-hidden","false")}},e(this,J).button.mouseout=()=>{if(!_e&&!pe&&i){const l=e(this,$).getContainer().querySelectorAll(".op-settings");for(let d=0,p=l.length;d<p;++d)l[d].setAttribute("aria-hidden","true");e(this,H).getAttribute("aria-hidden")==="false"&&e(this,H).setAttribute("aria-hidden","true")}},e(this,B).addEventListener("click",e(this,J).button.click,u),e(this,J).global.click=l=>{const d=l.target;if(d.closest(`#${e(this,$).id}`)&&d.classList.contains("op-subtitles__option")){const p=d.getAttribute("data-value").replace("captions-","");this._hideCaptions(),p==="off"&&o(this,pt,void 0);for(const m of e(this,$).getElement().textTracks)console.log({language:p,track:m}),m.mode=m.language===p?"showing":"hidden",m.language===p&&(o(this,pt,m),this._showCaptions());if(i){e(this,B).classList.contains("op-controls__captions--on")?(e(this,B).classList.remove("op-controls__captions--on"),e(this,B).setAttribute("data-active-captions","off")):(e(this,B).classList.add("op-controls__captions--on"),e(this,B).setAttribute("data-active-captions",p));const m=e(this,H).querySelectorAll(".op-settings__submenu-item");for(const c of Array.from(m))c.setAttribute("aria-checked","false");d.parentElement.setAttribute("aria-checked","true"),e(this,H).setAttribute("aria-hidden","false")}else e(this,B).setAttribute("data-active-captions",p);const A=E("captionschanged");e(this,$).getElement().dispatchEvent(A)}},e(this,J).global.cuechange=l=>{var d;this._hideCaptions();const p=l.target;p.mode!=="showing"||e(this,B).getAttribute("data-active-captions")==="off"||p.activeCues&&((d=p.activeCues)==null?void 0:d.length)>0&&this._showCaptions()},i&&(e(this,B).addEventListener("mouseover",e(this,J).button.mouseover,u),e(this,H).addEventListener("mouseover",e(this,J).button.mouseover,u),e(this,H).addEventListener("mouseout",e(this,J).button.mouseout,u),e(this,$).getElement().addEventListener("controlshidden",e(this,J).button.mouseout,u)),document.addEventListener("click",e(this,J).global.click,u),e(this,$).getElement().addEventListener(n,()=>{for(const l of e(this,$).getElement().textTracks)l.mode=l.mode!=="showing"?"hidden":l.mode,l.addEventListener("cuechange",e(this,J).global.cuechange,u)});const r=e(this,$).getElement().querySelector('track:is([kind="subtitles"],[kind="captions"])[default]');if(r){const l=Array.from(e(this,$).getElement().textTracks).find(d=>d.language===r.srclang);l&&this._setDefaultTrack(l)}})}destroy(){const{detachMenus:t}=e(this,$).getOptions();if(e(this,Is)){for(const s of e(this,$).getElement().textTracks)s.removeEventListener("cuechange",e(this,J).global.cuechange);document.removeEventListener("click",e(this,J).global.click),e(this,B).removeEventListener("click",e(this,J).button.click),t&&(e(this,B).removeEventListener("mouseover",e(this,J).button.mouseover),e(this,H).removeEventListener("mouseover",e(this,J).button.mouseover),e(this,H).removeEventListener("mouseout",e(this,J).button.mouseout),e(this,$).getElement().removeEventListener("controlshidden",e(this,J).button.mouseout),e(this,H).remove()),e(this,B).remove()}}addSettings(){const{detachMenus:t,labels:s}=e(this,$).getOptions();if(t||e(this,$).getElement().textTracks.length<=1)return{};const i=this._formatMenuItems();return i.length>2?{className:"op-subtitles__option",default:e(this,mt)||"off",key:"captions",name:s?.captions||"",subitems:i}:{}}_formatMenuItems(){const{labels:t,detachMenus:s}=e(this,$).getOptions();if(e(this,$).getElement().textTracks.length<=1&&!s)return[];let i=[{key:"off",label:t?.off||""}];for(const a of e(this,$).getElement().textTracks){const n=t?.lang?t.lang[a.language]:null;i=i.filter(r=>r.key!==a.language),i.push({key:a.language,label:n||a.label})}return i}_setDefaultTrack(t){var s,i;t.mode="showing",o(this,mt,t.language),e(this,B).setAttribute("data-active-captions",e(this,mt)),e(this,B).classList.add("op-controls__captions--on"),e(this,Re).classList.add("op-captions--on"),o(this,pt,t);const a=document.querySelectorAll(".op-settings__submenu-item")||[];for(const n of Array.from(a))n.setAttribute("aria-checked","false");(i=(s=document.querySelector(`.op-subtitles__option[data-value="captions-${t.language}"]`))==null?void 0:s.parentElement)==null||i.setAttribute("aria-checked","true")}_showCaptions(){var t;for(const s of Array.from(((t=e(this,pt))==null?void 0:t.activeCues)||[])){const i=s?.text||"";if(i&&e(this,Re)){const a=document.createElement("span");a.innerHTML=i,e(this,Re).prepend(a),e(this,Re).classList.add("op-captions--on")}else this._hideCaptions()}}_hideCaptions(){for(var t;(t=e(this,Re))!=null&&t.lastChild;)e(this,Re).removeChild(e(this,Re).lastChild)}}$=new WeakMap,B=new WeakMap,Re=new WeakMap,H=new WeakMap,J=new WeakMap,Is=new WeakMap,pt=new WeakMap,mt=new WeakMap,Ht=new WeakMap,qt=new WeakMap;class js{constructor(t,s,i){h(this,te),h(this,we),h(this,ae),h(this,Vt,[]),h(this,ns,0),h(this,as,0),h(this,vt),h(this,os),h(this,rs),o(this,te,t),o(this,os,s),o(this,rs,i),o(this,we,document.body.classList.contains("op-fullscreen__on"));const a=document;this.fullScreenEnabled=!!(a.fullscreenEnabled||a.mozFullScreenEnabled||a.msFullscreenEnabled||a.webkitSupportsFullscreen||a.webkitFullscreenEnabled||document.createElement("video").webkitRequestFullScreen),this._enterSpaceKeyEvent=this._enterSpaceKeyEvent.bind(this),this._resize=this._resize.bind(this),this._fullscreenChange=this._fullscreenChange.bind(this),this._setFullscreen=this._setFullscreen.bind(this),this._unsetFullscreen=this._unsetFullscreen.bind(this),o(this,Vt,["fullscreenchange","mozfullscreenchange","webkitfullscreenchange","msfullscreenchange"]),e(this,Vt).forEach(n=>{document.addEventListener(n,this._fullscreenChange,u)}),this._setFullscreenData(!1),e(this,te).getContainer().addEventListener("keydown",this._enterSpaceKeyEvent,u),jt&&(e(this,te).getElement().addEventListener("webkitbeginfullscreen",this._setFullscreen,u),e(this,te).getElement().addEventListener("webkitendfullscreen",this._unsetFullscreen,u))}create(){const{labels:t}=e(this,te).getOptions();o(this,ae,document.createElement("button")),e(this,ae).type="button",e(this,ae).className=`op-controls__fullscreen op-control__${e(this,os)}`,e(this,ae).tabIndex=0,e(this,ae).title=t?.fullscreen||"",e(this,ae).setAttribute("aria-controls",e(this,te).id),e(this,ae).setAttribute("aria-pressed","false"),e(this,ae).setAttribute("aria-label",t?.fullscreen||""),o(this,vt,()=>{e(this,ae).setAttribute("aria-pressed","true"),this.toggleFullscreen()}),o(this,vt,e(this,vt).bind(this)),e(this,ae).addEventListener("click",e(this,vt),u),e(this,te).getControls().getLayer(e(this,rs)).appendChild(e(this,ae))}destroy(){e(this,te).getContainer().removeEventListener("keydown",this._enterSpaceKeyEvent),e(this,Vt).forEach(t=>{document.removeEventListener(t,this._fullscreenChange)}),jt&&(e(this,te).getElement().removeEventListener("webkitbeginfullscreen",this._setFullscreen),e(this,te).getElement().removeEventListener("webkitendfullscreen",this._unsetFullscreen)),e(this,ae).removeEventListener("click",e(this,vt)),e(this,ae).remove()}toggleFullscreen(){if(e(this,we)){const t=document;t.exitFullscreen?t.exitFullscreen():t.mozCancelFullScreen?t.mozCancelFullScreen():t.webkitCancelFullScreen?t.webkitCancelFullScreen():t.msExitFullscreen?t.msExitFullscreen():this._fullscreenChange(),document.body.classList.remove("op-fullscreen__on")}else{const t=e(this,te).getElement();o(this,ns,window.screen.width),o(this,as,window.screen.height),t.requestFullscreen?t.parentElement.requestFullscreen():t.mozRequestFullScreen?t.parentElement.mozRequestFullScreen():t.webkitRequestFullScreen?t.parentElement.webkitRequestFullScreen():t.msRequestFullscreen?t.parentElement.msRequestFullscreen():t.webkitEnterFullscreen?t.webkitEnterFullscreen():this._fullscreenChange(),document.body.classList.add("op-fullscreen__on")}if(typeof window<"u"&&(pe||jt)){const{screen:t}=window;t.orientation&&!e(this,we)&&t.orientation.lock("landscape")}}_fullscreenChange(){const t=e(this,we)?void 0:e(this,ns),s=e(this,we)?void 0:e(this,as);this._setFullscreenData(!e(this,we)),e(this,te).isAd()&&e(this,te).getAd().resizeAds(t,s),o(this,we,!e(this,we)),e(this,we)?document.body.classList.add("op-fullscreen__on"):document.body.classList.remove("op-fullscreen__on"),this._resize(t,s)}_setFullscreenData(t){e(this,te).getContainer().setAttribute("data-fullscreen",(!!t).toString()),e(this,ae)&&(t?e(this,ae).classList.add("op-controls__fullscreen--out"):e(this,ae).classList.remove("op-controls__fullscreen--out"))}_resize(t,s){const i=e(this,te).getContainer(),a=e(this,te).getElement(),n=e(this,te).getOptions();let r="";if(t)i.style.width="100%",a.style.width="100%";else if(n.width){const l=typeof n.width=="number"?`${n.width}px`:n.width;r+=`width: ${l} !important;`,a.style.removeProperty("width")}else a.style.removeProperty("width"),i.style.removeProperty("width");if(s)a.style.height="100%",i.style.height="100%";else if(n.height){const l=typeof n.height=="number"?`${n.height}px`:n.height;r+=`height: ${l} !important;`,a.style.removeProperty("height")}else a.style.removeProperty("height"),i.style.removeProperty("height");r&&i.setAttribute("style",r)}_enterSpaceKeyEvent(t){var s;const i=t.which||t.keyCode||0;((s=document?.activeElement)==null?void 0:s.classList.contains("op-controls__fullscreen"))&&(i===13||i===32)&&(this.toggleFullscreen(),t.preventDefault(),t.stopPropagation())}_setFullscreen(){o(this,we,!0),this._setFullscreenData(!0),document.body.classList.add("op-fullscreen__on")}_unsetFullscreen(){o(this,we,!1),this._setFullscreenData(!1),document.body.classList.remove("op-fullscreen__on")}}te=new WeakMap,we=new WeakMap,ae=new WeakMap,Vt=new WeakMap,ns=new WeakMap,as=new WeakMap,vt=new WeakMap,os=new WeakMap,rs=new WeakMap;function Qs(f){const n=((((f.split("?")[0]||"").split("\\")||[]).pop()||"").split("/")||[]).pop()||"";return n.includes(".")?n.substring(n.lastIndexOf(".")+1):""}function Cs(f){return/\.m3u8$/i.test(f.src)||["application/x-mpegURL","application/vnd.apple.mpegurl"].includes(f.type)}function xs(f){return/\.mpd/i.test(f.src)||f.type==="application/dash+xml"}function Hs(f){return/(^rtmp:\/\/|\.flv$)/i.test(f.src)||["video/x-flv","video/flv"].includes(f.type)}function ts(f,t){const s=Qs(f);if(!s)return me(t)?"audio/mp3":"video/mp4";switch(s){case"m3u8":case"m3u":return"application/x-mpegURL";case"mpd":return"application/dash+xml";case"mp4":return me(t)?"audio/mp4":"video/mp4";case"mp3":return"audio/mp3";case"webm":return me(t)?"audio/webm":"video/webm";case"ogg":return me(t)?"audio/ogg":"video/ogg";case"ogv":return"video/ogg";case"oga":return"audio/ogg";case"3gp":return"audio/3gpp";case"wav":return"audio/wav";case"aac":return"audio/aac";case"flac":return"audio/flac";default:return me(t)?"audio/mp3":"video/mp4"}}function Xs(f,t,s,i,a){const n=f.play();n!==void 0?n.then(()=>{f.pause(),s(!0),i(!1),a()}).catch(()=>{f.volume=0,f.muted=!0,f.play().then(()=>{f.pause(),s(!0),i(!0),a()}).catch(()=>{f.volume=t,f.muted=!1,s(!1),i(!1),a()})}):(s(!f.paused||"Promise"in window&&n instanceof Promise),f.pause(),i(!1),a())}class Ys{constructor(t,s,i){h(this,I),h(this,se),h(this,Q),h(this,D,{button:{},global:{},media:{}}),h(this,ft,[]),h(this,st,""),h(this,Kt),h(this,ls),o(this,I,t),o(this,Kt,s),o(this,ls,i)}create(){const{labels:t,defaultLevel:s,detachMenus:i}=e(this,I).getOptions(),a=s!==null?parseInt(s||"0",10):e(this,I).getMedia().level;o(this,st,`${a}`);const n=this._formatMenuItems(),r=n.length?n.find(m=>m.key===e(this,st)):null,l=r?r.label:t?.auto||"";let d=!1;o(this,se,document.createElement("button")),e(this,se).className=`op-controls__levels op-control__${e(this,Kt)}`,e(this,se).tabIndex=0,e(this,se).title=t?.mediaLevels||"",e(this,se).setAttribute("aria-controls",e(this,I).id),e(this,se).setAttribute("aria-label",t?.mediaLevels||""),e(this,se).setAttribute("data-active-level",e(this,st)),e(this,se).innerHTML=`<span>${l}</span>`;const p=()=>{e(this,ft).length?d||(e(this,I).getMedia().level=a,d=!0):(this._gatherLevels(),setTimeout(()=>{e(this,I).getMedia().level=a;const m=E("controlschanged");e(this,I).getElement().dispatchEvent(m)},0))};e(this,D).media.loadedmetadata=p.bind(this),e(this,D).media.manifestLoaded=p.bind(this),e(this,D).media.hlsManifestParsed=p.bind(this),i&&(this._buildMenu(),e(this,D).button.click=()=>{if(i){const m=e(this,I).getContainer().querySelectorAll(".op-settings");for(let c=0,v=m.length;c<v;++c)m[c]!==e(this,Q)&&m[c].setAttribute("aria-hidden","true");e(this,Q).getAttribute("aria-hidden")==="true"?e(this,Q).setAttribute("aria-hidden","false"):e(this,Q).setAttribute("aria-hidden","true")}},e(this,D).button.mouseover=()=>{if(!_e&&!pe){const m=e(this,I).getContainer().querySelectorAll(".op-settings");for(let c=0,v=m.length;c<v;++c)m[c]!==e(this,Q)&&m[c].setAttribute("aria-hidden","true");e(this,Q).getAttribute("aria-hidden")==="true"&&e(this,Q).setAttribute("aria-hidden","false")}},e(this,D).button.mouseout=()=>{if(!_e&&!pe){const m=e(this,I).getContainer().querySelectorAll(".op-settings");for(let c=0,v=m.length;c<v;++c)m[c].setAttribute("aria-hidden","true");e(this,Q).getAttribute("aria-hidden")==="false"&&e(this,Q).setAttribute("aria-hidden","true")}},e(this,se).addEventListener("click",e(this,D).button.click,u),e(this,se).addEventListener("mouseover",e(this,D).button.mouseover,u),e(this,Q).addEventListener("mouseover",e(this,D).button.mouseover,u),e(this,Q).addEventListener("mouseout",e(this,D).button.mouseout,u),e(this,I).getElement().addEventListener("controlshidden",e(this,D).button.mouseout,u)),e(this,D).global.click=m=>{const c=m.target,{currentTime:v}=e(this,I).getMedia(),L=e(this,I).getMedia().paused;if(c.closest(`#${e(this,I).id}`)&&c.classList.contains("op-levels__option")){const M=c.getAttribute("data-value"),j=M?M.replace("levels-",""):"-1";if(o(this,st,`${j}`),i){e(this,se).setAttribute("data-active-level",`${j}`),e(this,se).innerHTML=`<span>${Ie(c.innerText,!0)}</span>`;const xe=c.parentElement&&c.parentElement.parentElement?c.parentElement.parentElement.querySelectorAll(".op-settings__submenu-item"):[];for(let He=0,is=xe.length;He<is;++He)xe[He].setAttribute("aria-checked","false");c.parentElement&&c.parentElement.setAttribute("aria-checked","true"),e(this,Q).setAttribute("aria-hidden","false")}e(this,I).getMedia().level=j,e(this,I).getMedia().currentTime=v,L||e(this,I).play();const ve=E("levelchanged",{detail:{label:c.innerText.trim(),level:j}});e(this,I).getElement().dispatchEvent(ve),m.preventDefault(),m.stopPropagation()}};const A=Le?.connection||Le?.mozConnection||Le?.webkitConnection;e(this,D).global.connection=()=>{const m=e(this,I).getMedia().current;if(!xs(m)&&!Cs(m)){const c=A?.effectiveType||"",v=e(this,ft).map(M=>({...M,resolution:parseInt(M.label.replace("p",""),10)}));let L=v.find(M=>M.resolution<360);c==="4g"?L=v.find(M=>M.resolution>=720):c==="3g"&&(L=v.find(M=>M.resolution>=360&&M.resolution<720)),L&&(e(this,I).pause(),e(this,I).getMedia().level=L.id,e(this,I).play())}},Object.keys(e(this,D).media).forEach(m=>{e(this,I).getElement().addEventListener(m,e(this,D).media[m],u)}),document.addEventListener("click",e(this,D).global.click,u),A&&A.addEventListener("change",e(this,D).global.connection,u)}destroy(){const{detachMenus:t}=e(this,I).getOptions(),s=Le?.connection||Le?.mozConnection||Le?.webkitConnection;Object.keys(e(this,D).media).forEach(i=>{e(this,I).getElement().removeEventListener(i,e(this,D).media[i])}),document.removeEventListener("click",e(this,D).global.click),s&&s.removeEventListener("change",e(this,D).global.connection),t&&(e(this,se).removeEventListener("click",e(this,D).button.click),e(this,se).remove(),e(this,se).removeEventListener("mouseover",e(this,D).button.mouseover),e(this,Q).removeEventListener("mouseover",e(this,D).button.mouseover),e(this,Q).removeEventListener("mouseout",e(this,D).button.mouseout),e(this,I).getElement().removeEventListener("controlshidden",e(this,D).button.mouseout),e(this,Q).remove())}addSettings(){const{labels:t,detachMenus:s}=e(this,I).getOptions();if(s)return{};const i=this._formatMenuItems();return i.length>2?{className:"op-levels__option",default:e(this,st)||"-1",key:"levels",name:t?.levels,subitems:i}:{}}_formatMenuItems(){const{labels:t}=e(this,I).getOptions(),s=this._gatherLevels(),i=s.length;let a=i?[{key:"-1",label:t?.auto}]:[];for(let n=0;n<i;n++){const r=s[n];a=a.filter(l=>l.key!==r.id),a.push({key:r.id,label:r.label})}return a.reduce((n,r)=>n.find(d=>d.label===r.label)?n:n.concat([r]),[]).sort((n,r)=>parseInt(n?.label||"",10)>parseInt(r?.label||"",10)?1:-1)}_getResolutionsLabel(t){const{labels:s}=e(this,I).getOptions();return t>=4320?"8K":t>=2160?"4K":t>=1440?"1440p":t>=1080?"1080p":t>=720?"720p":t>=480?"480p":t>=360?"360p":t>=240?"240p":t>=144?"144p":s?.auto||""}_gatherLevels(){return e(this,ft).length||e(this,I).getMedia().levels.forEach(t=>{e(this,ft).push({...t,label:t.label||this._getResolutionsLabel(t.height)})}),e(this,ft)}_buildMenu(){const{detachMenus:t}=e(this,I).getOptions();if(t){e(this,se).classList.add("op-control--no-hover"),o(this,Q,document.createElement("div")),e(this,Q).className="op-settings op-levels__menu",e(this,Q).setAttribute("aria-hidden","true");const s="op-levels__option",a=`<div class="op-settings__menu" role="menu" id="menu-item-levels">
                ${this._formatMenuItems().map(r=>`
                <div class="op-settings__submenu-item" tabindex="0" role="menuitemradio"
                    aria-checked="${e(this,st)===r.key?"true":"false"}">
                    <div class="op-settings__submenu-label ${s}" data-value="levels-${r.key}">${r.label}</div>
                </div>`).join("")}
            </div>`;e(this,Q).innerHTML=a;const n=document.createElement("div");n.className=`op-controls__container op-control__${e(this,Kt)}`,n.appendChild(e(this,se)),n.appendChild(e(this,Q)),e(this,I).getControls().getLayer(e(this,ls)).appendChild(n)}}}I=new WeakMap,se=new WeakMap,Q=new WeakMap,D=new WeakMap,ft=new WeakMap,st=new WeakMap,Kt=new WeakMap,ls=new WeakMap;class Js{constructor(t,s,i){h(this,N),h(this,C),h(this,q,{controls:{},media:{}}),h(this,hs),h(this,ds),o(this,N,t),o(this,hs,s),o(this,ds,i),this._enterSpaceKeyEvent=this._enterSpaceKeyEvent.bind(this)}create(){var t;const{labels:s}=e(this,N).getOptions();o(this,C,document.createElement("button")),e(this,C).type="button",e(this,C).className=`op-controls__playpause op-control__${e(this,hs)}`,e(this,C).tabIndex=0,e(this,C).title=s?.play||"",e(this,C).setAttribute("aria-controls",e(this,N).id),e(this,C).setAttribute("aria-pressed","false"),e(this,C).setAttribute("aria-label",s?.play||""),e(this,N).getControls().getLayer(e(this,ds)).appendChild(e(this,C)),e(this,q).button=n=>{e(this,C).setAttribute("aria-pressed","true");const r=e(this,N).activeElement();r.paused||r.ended?(e(this,N).getAd()&&(e(this,N).getAd().playRequested=!0),r.play(),e(this,q).media.play()):(r.pause(),e(this,q).media.pause()),n.preventDefault(),n.stopPropagation()};const i=me(e(this,N).getElement());e(this,q).media.play=()=>{var n;e(this,N).activeElement().ended?(e(this,N).isMedia()?e(this,C).classList.add("op-controls__playpause--replay"):e(this,C).classList.add("op-controls__playpause--pause"),e(this,C).title=s?.play||"",e(this,C).setAttribute("aria-label",s?.play||"")):(e(this,C).classList.remove("op-controls__playpause--replay"),e(this,C).classList.add("op-controls__playpause--pause"),e(this,C).title=s?.pause||"",e(this,C).setAttribute("aria-label",s?.pause||""),(n=e(this,N).getOptions())!=null&&n.pauseOthers&&Object.keys(Ns.instances).forEach(r=>{r!==e(this,N).id&&Ns.instances[r].activeElement().pause()}))},e(this,q).media.loadedmetadata=()=>{e(this,C).classList.contains("op-controls__playpause--pause")&&(e(this,C).classList.remove("op-controls__playpause--replay"),e(this,C).classList.remove("op-controls__playpause--pause"),e(this,C).title=s?.play||"",e(this,C).setAttribute("aria-label",s?.play||""))},e(this,q).media.playing=()=>{e(this,C).classList.contains("op-controls__playpause--pause")||(e(this,C).classList.remove("op-controls__playpause--replay"),e(this,C).classList.add("op-controls__playpause--pause"),e(this,C).title=s?.pause||"",e(this,C).setAttribute("aria-label",s?.pause||""))},e(this,q).media.pause=()=>{e(this,C).classList.remove("op-controls__playpause--pause"),e(this,C).title=s?.play||"",e(this,C).setAttribute("aria-label",s?.play||"")},e(this,q).media.ended=()=>{e(this,N).activeElement().ended&&e(this,N).isMedia()?(e(this,C).classList.add("op-controls__playpause--replay"),e(this,C).classList.remove("op-controls__playpause--pause")):e(this,N).getElement().currentTime>=e(this,N).getElement().duration||e(this,N).getElement().currentTime<=0?(e(this,C).classList.add("op-controls__playpause--replay"),e(this,C).classList.remove("op-controls__playpause--pause")):(e(this,C).classList.remove("op-controls__playpause--replay"),e(this,C).classList.add("op-controls__playpause--pause")),e(this,C).title=s?.play||"",e(this,C).setAttribute("aria-label",s?.play||"")},e(this,q).media.adsmediaended=()=>{e(this,C).classList.remove("op-controls__playpause--replay"),e(this,C).classList.add("op-controls__playpause--pause"),e(this,C).title=s?.pause||"",e(this,C).setAttribute("aria-label",s?.pause||"")},e(this,q).media.playererror=()=>{i&&e(this,N).activeElement().pause()};const a=e(this,N).getElement();e(this,q).controls.controlschanged=()=>{if(!e(this,N).activeElement().paused){const n=E("playing");a.dispatchEvent(n)}},Object.keys(e(this,q).media).forEach(n=>{a.addEventListener(n,e(this,q).media[n],u)}),(t=e(this,N).getOptions().media)!=null&&t.pauseOnClick&&a.addEventListener("click",e(this,q).button,u),e(this,N).getControls().getContainer().addEventListener("controlschanged",e(this,q).controls.controlschanged,u),e(this,N).getContainer().addEventListener("keydown",this._enterSpaceKeyEvent,u),e(this,C).addEventListener("click",e(this,q).button,u)}destroy(){var t;Object.keys(e(this,q).media).forEach(s=>{e(this,N).getElement().removeEventListener(s,e(this,q).media[s])}),(t=e(this,N).getOptions().media)!=null&&t.pauseOnClick&&e(this,N).getElement().removeEventListener("click",e(this,q).button),e(this,N).getControls().getContainer().removeEventListener("controlschanged",e(this,q).controls.controlschanged),e(this,N).getContainer().removeEventListener("keydown",this._enterSpaceKeyEvent),e(this,C).removeEventListener("click",e(this,q).button),e(this,C).remove()}_enterSpaceKeyEvent(t){var s;const i=t.which||t.keyCode||0;((s=document?.activeElement)==null?void 0:s.classList.contains("op-controls__playpause"))&&(i===13||i===32)&&e(this,q).button(t)}}N=new WeakMap,C=new WeakMap,q=new WeakMap,hs=new WeakMap,ds=new WeakMap;function je(f,t){const s=Math.floor(f%1*0);let i=Math.floor(f),a=Math.floor(i/60);const n=Math.floor(a/60),r=l=>{const d=l.toString();return l<10?l<=0?"00":`0${d}`:d};return a%=60,i%=60,`${n>0?`${r(n)}:`:""}${r(a)}:${r(i)}${s?`:${r(s)}`:""}`}class Zs{constructor(t,s,i){h(this,w),h(this,S),h(this,y),h(this,Ve),h(this,be),h(this,Ee),h(this,W,{container:{},controls:{},global:{},media:{},slider:{}}),h(this,St,!1),h(this,cs),h(this,us),o(this,w,t),o(this,cs,s),o(this,us,i),this._enterSpaceKeyEvent=this._enterSpaceKeyEvent.bind(this)}create(){var t;const{labels:s,progress:i}=e(this,w).getOptions();o(this,S,document.createElement("div")),e(this,S).className=`op-controls__progress op-control__${e(this,cs)}`,e(this,S).tabIndex=0,e(this,S).setAttribute("aria-label",s?.progressSlider||""),e(this,S).setAttribute("aria-valuemin","0"),e(this,S).setAttribute("aria-valuenow","0"),e(this,S).setAttribute("role","slider"),o(this,y,document.createElement("input")),e(this,y).type="range",e(this,y).className="op-controls__progress--seek",e(this,y).tabIndex=-1,e(this,y).setAttribute("min","0"),e(this,y).setAttribute("step","0.1"),e(this,y).value="0",e(this,y).setAttribute("aria-label",s?.progressRail||""),e(this,y).setAttribute("role","slider"),o(this,Ve,document.createElement("progress")),e(this,Ve).className="op-controls__progress--buffer",e(this,Ve).setAttribute("max","100"),e(this,Ve).value=0,o(this,be,document.createElement("progress")),e(this,be).className="op-controls__progress--played",e(this,be).setAttribute("max","100"),e(this,be).value=0,e(this,S).appendChild(e(this,y)),e(this,S).appendChild(e(this,be)),e(this,S).appendChild(e(this,Ve)),!_e&&!pe&&(o(this,Ee,document.createElement("span")),e(this,Ee).className="op-controls__tooltip",e(this,Ee).tabIndex=-1,e(this,Ee).innerHTML="00:00",e(this,S).appendChild(e(this,Ee)));const a=()=>{var c;e(this,y).classList.contains("error")&&e(this,y).classList.remove("error");const v=e(this,w).activeElement();if(v.duration!==1/0&&!e(this,w).getElement().getAttribute("op-live__enabled")&&!e(this,w).getElement().getAttribute("op-dvr__enabled")){const L=e(this,w).isMedia()?v.currentTime:v.duration-v.currentTime;e(this,y).value=L.toString(),Number.isNaN(v.duration)||(e(this,y).setAttribute("max",`${v.duration}`),e(this,S).setAttribute("aria-valuemax",v.duration.toString()))}else e(this,w).getElement().getAttribute("op-dvr__enabled")?(e(this,y).setAttribute("max","1"),e(this,y).value="1",e(this,y).style.backgroundSize="100% 100%",e(this,be).value=1,e(this,S).setAttribute("aria-valuemax","1"),e(this,S).setAttribute("aria-hidden","false")):(c=e(this,w).getOptions().live)!=null&&c.showProgress||e(this,S).setAttribute("aria-hidden","true")};let n=0;const r=((t=e(this,w).getOptions().progress)==null?void 0:t.duration)||0,l=me(e(this,w).getElement());e(this,W).media.loadedmetadata=a.bind(this),e(this,W).controls.controlschanged=a.bind(this),e(this,W).media.progress=c=>{var v;const L=c.target;if(L.duration!==1/0&&!e(this,w).getElement().getAttribute("op-live__enabled")){if(L.duration>0){for(let M=0,j=L.buffered.length;M<j;M++)if(L.buffered.start(L.buffered.length-1-M)<L.currentTime){e(this,Ve).value=L.buffered.end(L.buffered.length-1-M)/L.duration*100;break}}}else!e(this,w).getElement().getAttribute("op-dvr__enabled")&&e(this,S).getAttribute("aria-hidden")==="false"&&!((v=e(this,w).getOptions().live)!=null&&v.showProgress)&&e(this,S).setAttribute("aria-hidden","true")},e(this,W).media.waiting=()=>{l&&!e(this,y).classList.contains("loading")&&e(this,y).classList.add("loading"),l&&e(this,y).classList.contains("error")&&e(this,y).classList.remove("error")},e(this,W).media.playererror=()=>{l&&!e(this,y).classList.contains("error")&&e(this,y).classList.add("error"),l&&e(this,y).classList.contains("loading")&&e(this,y).classList.remove("loading")},e(this,W).media.pause=()=>{const c=e(this,w).activeElement();if(c.duration!==1/0&&!e(this,w).getElement().getAttribute("op-live__enabled")){const v=c.currentTime;e(this,S).setAttribute("aria-valuenow",v.toString()),e(this,S).setAttribute("aria-valuetext",je(v))}},e(this,W).media.play=()=>{l&&e(this,y).classList.contains("loading")&&e(this,y).classList.remove("loading"),l&&e(this,y).classList.contains("error")&&e(this,y).classList.remove("error"),e(this,w).activeElement().duration!==1/0&&!e(this,w).getElement().getAttribute("op-live__enabled")&&(e(this,S).removeAttribute("aria-valuenow"),e(this,S).removeAttribute("aria-valuetext"))},e(this,W).media.playing=()=>{l&&e(this,y).classList.contains("loading")&&e(this,y).classList.remove("loading"),l&&e(this,y).classList.contains("error")&&e(this,y).classList.remove("error")},e(this,W).media.timeupdate=()=>{var c;const v=e(this,w).activeElement();if(v.duration!==1/0&&(!e(this,w).getElement().getAttribute("op-live__enabled")||e(this,w).getElement().getAttribute("op-dvr__enabled"))){(!e(this,y).getAttribute("max")||e(this,y).getAttribute("max")==="0"||parseFloat(e(this,y).getAttribute("max")||"-1")!==v.duration)&&(Number.isNaN(v.duration)||e(this,y).setAttribute("max",`${v.duration}`),e(this,S).setAttribute("aria-hidden","false"));const L=v.duration-v.currentTime+1>=100?100:v.duration-v.currentTime+1,M=e(this,w).isMedia()?v.currentTime:L,j=parseFloat(e(this,y).min),ve=parseFloat(e(this,y).max);e(this,y).value=M.toString(),e(this,y).style.backgroundSize=`${(M-j)*100/(ve-j)}% 100%`,e(this,be).value=v.duration<=0||Number.isNaN(v.duration)||!Number.isFinite(v.duration)?r:M/v.duration*100,e(this,w).getElement().getAttribute("op-dvr__enabled")&&Math.floor(e(this,be).value)>=99&&(n=v.currentTime,e(this,S).setAttribute("aria-hidden","false"))}else!e(this,w).getElement().getAttribute("op-dvr__enabled")&&e(this,S).getAttribute("aria-hidden")==="false"&&!((c=e(this,w).getOptions().live)!=null&&c.showProgress)&&e(this,S).setAttribute("aria-hidden","true")},e(this,W).media.durationchange=()=>{const c=e(this,w).activeElement(),v=e(this,w).isMedia()?c.currentTime:c.duration-c.currentTime;Number.isNaN(c.duration)||(e(this,y).setAttribute("max",`${c.duration}`),e(this,S).setAttribute("aria-valuemax",c.duration.toString())),e(this,be).value=c.duration<=0||Number.isNaN(c.duration)||!Number.isFinite(c.duration)?r:v/c.duration*100},e(this,W).media.ended=()=>{e(this,y).style.backgroundSize="0% 100%",e(this,y).getAttribute("max")&&e(this,y).setAttribute("max","0"),e(this,Ve).value=0,e(this,be).value=0};const d=c=>{const v=e(this,w).activeElement(),L=c.target,M=parseFloat(L.value);if(e(this,y).classList.contains("op-progress--pressed")||M<v.currentTime&&!i?.allowRewind||M>v.currentTime&&!i?.allowSkip){e(this,y).value=v.currentTime.toString();return}e(this,y).classList.add(".op-progress--pressed");const j=parseFloat(L.min),ve=parseFloat(L.max),xe=parseFloat(L.value);e(this,y).style.backgroundSize=`${(xe-j)*100/(ve-j)}% 100%`,e(this,be).value=v.duration<=0||Number.isNaN(v.duration)||!Number.isFinite(v.duration)?r:xe/v.duration*100,e(this,w).getElement().getAttribute("op-dvr__enabled")?v.currentTime=Math.round(e(this,be).value)>=99?n:xe:v.currentTime=xe,e(this,y).classList.remove(".op-progress--pressed")},p=c=>{const v=e(this,w).activeElement(),L=c.which||c.keyCode||0,M=e(this,y),j=Math.round(Number(M.value)),ve=Math.round(v.currentTime);(j<ve&&i?.allowRewind||j>=ve&&i?.allowSkip)&&(L===1||L===0)&&e(this,w).isMedia()&&!v.paused&&(v.pause(),o(this,St,!0))},A=()=>{const c=e(this,w).activeElement();e(this,St)===!0&&e(this,w).isMedia()&&c.paused&&(c.play(),o(this,St,!1))},m=c=>{var v;const L=e(this,w).activeElement();if(L.duration!==1/0){const{changedTouches:M}=c,He=((((v=M[0])==null?void 0:v.pageX)||0)-es(e(this,S)).left)/e(this,S).offsetWidth*L.duration;(He<L.currentTime&&i?.allowRewind||He>L.currentTime&&i?.allowSkip)&&(e(this,y).value=He.toString(),d(c),L.paused||(L.pause(),o(this,St,!0)))}};e(this,W).slider.input=d.bind(this),e(this,W).slider.change=d.bind(this),e(this,W).slider.mousedown=p.bind(this),e(this,W).slider.mouseup=A.bind(this),e(this,W).slider.touchstart=m.bind(this),e(this,W).slider.touchend=A.bind(this),!_e&&!pe&&(e(this,W).container.mousemove=c=>{const v=e(this,w).activeElement();if(v.duration!==1/0&&!e(this,w).isAd()){const L=c.pageX;let M=L-es(e(this,S)).left;const j=e(this,Ee).offsetWidth/2,ve=M/e(this,S).offsetWidth,xe=ve*v.duration,He=e(this,w).getContainer(),is=He.offsetWidth-e(this,Ee).offsetWidth;M<=0||L-es(He).left<=j?M=0:L-es(He).left>=is?M=is-es(e(this,y)).left-10:M-=j,ve>=0&&ve<=1?e(this,Ee).classList.add("op-controls__tooltip--visible"):e(this,Ee).classList.remove("op-controls__tooltip--visible"),e(this,Ee).style.left=`${M}px`,e(this,Ee).innerHTML=Number.isNaN(xe)?"00:00":je(xe)}},e(this,W).global.mousemove=c=>{(!c.target.closest(".op-controls__progress")||e(this,w).isAd())&&e(this,Ee).classList.remove("op-controls__tooltip--visible")}),Object.keys(e(this,W).media).forEach(c=>{e(this,w).getElement().addEventListener(c,e(this,W).media[c],u)}),Object.keys(e(this,W).slider).forEach(c=>{e(this,y).addEventListener(c,e(this,W).slider[c],u)}),e(this,S).addEventListener("keydown",e(this,w).getEvents().keydown,u),e(this,S).addEventListener("mousemove",e(this,W).container.mousemove,u),document.addEventListener("mousemove",e(this,W).global.mousemove,u),e(this,w).getContainer().addEventListener("keydown",this._enterSpaceKeyEvent,u),e(this,w).getControls().getContainer().addEventListener("controlschanged",e(this,W).controls.controlschanged,u),e(this,w).getControls().getLayer(e(this,us)).appendChild(e(this,S))}destroy(){Object.keys(e(this,W)).forEach(t=>{e(this,w).getElement().removeEventListener(t,e(this,W)[t])}),Object.keys(e(this,W).slider).forEach(t=>{e(this,y).removeEventListener(t,e(this,W).slider[t])}),e(this,S).removeEventListener("keydown",e(this,w).getEvents().keydown),e(this,S).removeEventListener("mousemove",e(this,W).container.mousemove),document.removeEventListener("mousemove",e(this,W).global.mousemove),e(this,w).getContainer().removeEventListener("keydown",this._enterSpaceKeyEvent),e(this,w).getControls().getContainer().removeEventListener("controlschanged",e(this,W).controls.controlschanged),e(this,Ve).remove(),e(this,be).remove(),e(this,y).remove(),!_e&&!pe&&e(this,Ee).remove(),e(this,S).remove()}_enterSpaceKeyEvent(t){const s=e(this,w).activeElement(),i=e(this,w).isAd(),a=t.which||t.keyCode||0;if(!i&&a>=48&&a<=57&&s.duration!==1/0){let n=0;for(let r=48,l=57;r<=l;r++)r<a&&n++;s.currentTime=s.duration*(.1*n),t.preventDefault(),t.stopPropagation()}}}w=new WeakMap,S=new WeakMap,y=new WeakMap,Ve=new WeakMap,be=new WeakMap,Ee=new WeakMap,W=new WeakMap,St=new WeakMap,cs=new WeakMap,us=new WeakMap;class qs{constructor(t,s,i){h(this,V),h(this,gt,{}),h(this,ke),h(this,F),h(this,U,{global:{},media:{}}),h(this,_t,""),h(this,ps),h(this,ms),o(this,V,t),o(this,ps,s),o(this,ms,i),this._enterSpaceKeyEvent=this._enterSpaceKeyEvent.bind(this)}create(){const{labels:t}=e(this,V).getOptions();o(this,ke,document.createElement("button")),e(this,ke).className=`op-controls__settings op-control__${e(this,ps)}`,e(this,ke).tabIndex=0,e(this,ke).title=t?.settings||"",e(this,ke).setAttribute("aria-controls",e(this,V).id),e(this,ke).setAttribute("aria-pressed","false"),e(this,ke).setAttribute("aria-label",t?.settings||""),o(this,F,document.createElement("div")),e(this,F).className="op-settings",e(this,F).setAttribute("aria-hidden","true"),e(this,F).innerHTML='<div class="op-settings__menu" role="menu"></div>',this.clickEvent=()=>{e(this,ke).setAttribute("aria-pressed","true");const s=e(this,V).getContainer().querySelectorAll(".op-settings");for(let i=0,a=s.length;i<a;++i)s[i]!==e(this,F)&&s[i].setAttribute("aria-hidden","true");e(this,F).setAttribute("aria-hidden",e(this,F).getAttribute("aria-hidden")==="false"?"true":"false")},this.hideEvent=()=>{let s;s&&typeof window<"u"&&window.cancelAnimationFrame(s),typeof window<"u"&&(s=window.requestAnimationFrame(()=>{e(this,F).innerHTML=e(this,_t),e(this,F).setAttribute("aria-hidden","true")}))},this.removeEvent=s=>{const{id:i,type:a}=s.detail;this.removeItem(i,a)},this.clickEvent=this.clickEvent.bind(this),this.hideEvent=this.hideEvent.bind(this),this.removeEvent=this.removeEvent.bind(this),e(this,U).media.controlshidden=this.hideEvent.bind(this),e(this,U).media.settingremoved=this.removeEvent.bind(this),e(this,U).media.play=this.hideEvent.bind(this),e(this,U).media.pause=this.hideEvent.bind(this),e(this,V).getContainer().addEventListener("keydown",this._enterSpaceKeyEvent,u),e(this,U).global.click=s=>{const{target:i}=s,a=i;if(a?.closest(`#${e(this,V).id}`)&&a?.classList.contains("op-speed__option")){const n=a?.getAttribute("data-value")||"";e(this,V).getMedia().playbackRate=parseFloat(n.replace("speed-",""))}},e(this,U).global.resize=this.hideEvent.bind(this),e(this,ke).addEventListener("click",this.clickEvent,u),Object.keys(e(this,U)).forEach(s=>{e(this,V).getElement().addEventListener(s,e(this,U).media[s],u)}),document.addEventListener("click",e(this,U).global.click,u),document.addEventListener("keydown",e(this,U).global.click,u),typeof window<"u"&&window.addEventListener("resize",e(this,U).global.resize,u),e(this,V).getControls().getLayer(e(this,ms)).appendChild(e(this,ke)),e(this,V).getContainer().appendChild(e(this,F))}destroy(){e(this,ke).removeEventListener("click",this.clickEvent),Object.keys(e(this,U)).forEach(t=>{e(this,V).getElement().removeEventListener(t,e(this,U).media[t])}),document.removeEventListener("click",e(this,U).global.click),document.removeEventListener("keydown",e(this,U).global.click),typeof window<"u"&&window.removeEventListener("resize",e(this,U).global.resize),e(this,U).global["settings.submenu"]!==void 0&&(document.removeEventListener("click",e(this,U).global["settings.submenu"]),e(this,V).getElement().removeEventListener("controlshidden",this.hideEvent)),e(this,V).getContainer().removeEventListener("keydown",this._enterSpaceKeyEvent),e(this,F).remove(),e(this,ke).remove()}addSettings(){const t=e(this,V).getMedia(),{labels:s}=e(this,V).getOptions();let i=1;return e(this,V)&&t&&(i=t.defaultPlaybackRate!==t.playbackRate?t.playbackRate:t.defaultPlaybackRate),{className:"op-speed__option",default:i.toString(),key:"speed",name:s?.speed||"",subitems:[{key:"0.25",label:"0.25"},{key:"0.5",label:"0.5"},{key:"0.75",label:"0.75"},{key:"1",label:s?.speedNormal||""},{key:"1.25",label:"1.25"},{key:"1.5",label:"1.5"},{key:"2",label:"2"}]}}addItem(t,s,i,a,n){const r=`${s}-${Ie(i,!0)}`,l=document.createElement("div");l.className="op-settings__menu-item",l.tabIndex=0,l.setAttribute("role","menuitemradio"),l.innerHTML=`<div class="op-settings__menu-label" data-value="${r}">${t}</div>`;const d=a?a.find(A=>A.key===i):null;d&&(l.innerHTML+=`<div class="op-settings__menu-content" tabindex="0">${d.label}</div>`);const p=e(this,F).querySelector(".op-settings__menu");if(p&&p.appendChild(l),o(this,_t,e(this,F).innerHTML),a){const A=`
                <div class="op-settings__header">
                    <button type="button" class="op-settings__back" tabindex="0">${t}</button>
                </div>
                <div class="op-settings__menu" role="menu" id="menu-item-${s}">
                    ${a.map(m=>`
                    <div class="op-settings__submenu-item" role="menuitemradio" aria-checked="${i===m.key?"true":"false"}">
                        <div class="op-settings__submenu-label ${n||""}" tabindex="0" data-value="${s}-${m.key}">
                            ${m.label}
                        </div>
                    </div>`).join("")}
                </div>`;e(this,gt)[s]=A}e(this,U).global["settings.submenu"]=A=>{const m=A.target;if(m.closest(`#${e(this,V).id}`)){if(m.classList.contains("op-settings__back"))e(this,F).classList.add("op-settings--sliding"),setTimeout(()=>{e(this,F).innerHTML=e(this,_t),e(this,F).classList.remove("op-settings--sliding")},100);else if(m.classList.contains("op-settings__menu-content")){const c=m.parentElement?m.parentElement.querySelector(".op-settings__menu-label"):null,v=c?c.getAttribute("data-value"):null,L=v?v.split("-"):[];if(L.length>0){L.pop();const M=L.join("-").replace(/^\-|\-$/,"");typeof e(this,gt)[M]<"u"&&(e(this,F).classList.add("op-settings--sliding"),setTimeout(()=>{e(this,F).innerHTML=e(this,gt)[M],e(this,F).classList.remove("op-settings--sliding")},100))}}else if(m.classList.contains("op-settings__submenu-label")){const c=m.getAttribute("data-value"),v=c?c.replace(`${s}-`,""):"",L=m.innerText,M=e(this,F).querySelector(`#menu-item-${s} .op-settings__submenu-item[aria-checked=true]`);M&&(M.setAttribute("aria-checked","false"),m.parentElement&&m.parentElement.setAttribute("aria-checked","true"),e(this,gt)[s]=e(this,F).innerHTML,e(this,F).classList.add("op-settings--sliding"),setTimeout(()=>{e(this,F).innerHTML=e(this,_t);const j=e(this,F).querySelector(`.op-settings__menu-label[data-value="${s}-${i}"]`);j&&(j.setAttribute("data-value",`${c}`),j.nextElementSibling&&(j.nextElementSibling.textContent=L)),i=v,o(this,_t,e(this,F).innerHTML),e(this,F).classList.remove("op-settings--sliding")},100))}}else this.hideEvent()},document.addEventListener("click",e(this,U).global["settings.submenu"],u),e(this,V).getElement().addEventListener("controlshidden",this.hideEvent,u)}removeItem(t,s,i=2){const a=e(this,V).getElement().querySelector(`.op-settings__submenu-label[data-value=${s}-${t}]`);if(a&&a.remove(),e(this,V).getElement().querySelectorAll(`.op-settings__submenu-label[data-value^=${s}]`).length<i){delete e(this,gt)[s];const n=e(this,V).getElement().querySelector(`.op-settings__menu-label[data-value^=${s}]`),r=n?n.closest(".op-settings__menu-item"):null;r&&r.remove()}}_enterSpaceKeyEvent(t){var s,i,a,n;const r=t.which||t.keyCode||0,l=e(this,V).isAd(),d=(s=document?.activeElement)==null?void 0:s.classList.contains("op-controls__settings"),p=((i=document?.activeElement)==null?void 0:i.classList.contains("op-settings__menu-content"))||((a=document?.activeElement)==null?void 0:a.classList.contains("op-settings__back"))||((n=document?.activeElement)==null?void 0:n.classList.contains("op-settings__submenu-label"));l||(d&&(r===13||r===32)?(this.clickEvent(),t.preventDefault(),t.stopPropagation()):p&&(r===13||r===32)&&(e(this,U).global["settings.submenu"](t),t.preventDefault(),t.stopPropagation()))}}V=new WeakMap,gt=new WeakMap,ke=new WeakMap,F=new WeakMap,U=new WeakMap,_t=new WeakMap,ps=new WeakMap,ms=new WeakMap;class ei{constructor(t,s,i){h(this,X),h(this,fe),h(this,Ne),h(this,oe),h(this,Ue),h(this,$e,{controls:{},media:{}}),h(this,vs),h(this,fs),o(this,X,t),o(this,vs,s),o(this,fs,i)}create(){const{labels:t,progress:s}=e(this,X).getOptions();o(this,fe,document.createElement("time")),e(this,fe).className="op-controls__current",e(this,fe).setAttribute("role","timer"),e(this,fe).setAttribute("aria-live","off"),e(this,fe).setAttribute("aria-hidden","false"),e(this,fe).innerText="0:00";const i=s?.showCurrentTimeOnly||!1;i||(o(this,Ne,document.createElement("span")),e(this,Ne).className="op-controls__time-delimiter",e(this,Ne).setAttribute("aria-hidden","false"),e(this,Ne).innerText="/",o(this,oe,document.createElement("time")),e(this,oe).className="op-controls__duration",e(this,oe).setAttribute("aria-hidden","false"),e(this,oe).innerText=je(s?.duration||0));const a=e(this,X).getControls().getLayer(e(this,fs));o(this,Ue,document.createElement("span")),e(this,Ue).className=`op-controls-time op-control__${e(this,vs)}`,e(this,Ue).appendChild(e(this,fe)),i||(e(this,Ue).appendChild(e(this,Ne)),e(this,Ue).appendChild(e(this,oe))),a.appendChild(e(this,Ue));const n=()=>{var l;const d=e(this,X).activeElement();if(d.duration!==1/0&&!e(this,X).getElement().getAttribute("op-live__enabled")){if(!i){const p=Number.isNaN(d.duration)?((l=e(this,X).getOptions().progress)==null?void 0:l.duration)||0:d.duration;e(this,oe).innerText=je(p)}e(this,fe).innerText=je(d.currentTime)}else i||(e(this,oe).setAttribute("aria-hidden","true"),e(this,Ne).setAttribute("aria-hidden","true"))};e(this,$e).media.loadedmetadata=n.bind(this),e(this,$e).controls.controlschanged=n.bind(this);const{showLabel:r}=e(this,X).getOptions().live||{};e(this,$e).media.timeupdate=()=>{const l=e(this,X).activeElement();if(l.duration!==1/0&&!e(this,X).getElement().getAttribute("op-live__enabled")&&!e(this,X).getElement().getAttribute("op-dvr__enabled")){const d=je(l.duration);!i&&!Number.isNaN(l.duration)&&d!==e(this,oe).innerText?(e(this,oe).innerText=d,e(this,oe).setAttribute("aria-hidden","false"),e(this,Ne).setAttribute("aria-hidden","false")):(i||d!==e(this,oe).innerText)&&(e(this,fe).innerText=r?t?.live||"":je(l.currentTime)),e(this,fe).innerText=je(l.currentTime)}else e(this,X).getElement().getAttribute("op-dvr__enabled")?(i||(e(this,oe).setAttribute("aria-hidden","true"),e(this,Ne).setAttribute("aria-hidden","true")),e(this,fe).innerText=je(l.currentTime)):i||!e(this,X).getElement().getAttribute("op-dvr__enabled")&&e(this,oe).getAttribute("aria-hidden")==="false"?(i||(e(this,oe).setAttribute("aria-hidden","true"),e(this,Ne).setAttribute("aria-hidden","true")),e(this,fe).innerText=r?t?.live||"":je(l.currentTime)):e(this,fe).innerText=r?t?.live||"":je(l.currentTime)},e(this,$e).media.ended=()=>{var l;const d=e(this,X).activeElement(),p=Number.isNaN(d.duration)?((l=e(this,X).getOptions().progress)==null?void 0:l.duration)||0:d.duration;!i&&e(this,X).isMedia()&&(e(this,oe).innerText=je(p))},Object.keys(e(this,$e).media).forEach(l=>{e(this,X).getElement().addEventListener(l,e(this,$e).media[l],u)}),e(this,X).getControls().getContainer().addEventListener("controlschanged",e(this,$e).controls.controlschanged,u)}destroy(){Object.keys(e(this,$e).media).forEach(s=>{e(this,X).getElement().removeEventListener(s,e(this,$e).media[s])}),e(this,X).getControls().getContainer().removeEventListener("controlschanged",e(this,$e).controls.controlschanged),e(this,fe).remove();const{showCurrentTimeOnly:t}=e(this,X).getOptions().progress||{};t||(e(this,Ne).remove(),e(this,oe).remove()),e(this,Ue).remove()}}X=new WeakMap,fe=new WeakMap,Ne=new WeakMap,oe=new WeakMap,Ue=new WeakMap,$e=new WeakMap,vs=new WeakMap,fs=new WeakMap;class ti{constructor(t,s,i){h(this,G),h(this,K),h(this,re),h(this,Ge),h(this,ge),h(this,le,{button:{},media:{},slider:{}}),h(this,it),h(this,zt),h(this,gs),o(this,G,t),o(this,it,e(this,G).getMedia().volume),o(this,zt,s),o(this,gs,i),this._enterSpaceKeyEvent=this._enterSpaceKeyEvent.bind(this)}create(){const{labels:t}=e(this,G).getOptions();o(this,re,document.createElement("div")),e(this,re).className=`op-controls__volume op-control__${e(this,zt)}`,e(this,re).tabIndex=0,e(this,re).setAttribute("aria-valuemin","0"),e(this,re).setAttribute("aria-valuemax","100"),e(this,re).setAttribute("aria-valuenow",`${e(this,it)}`),e(this,re).setAttribute("aria-valuetext",`${t?.volume||""}: ${e(this,it)}`),e(this,re).setAttribute("aria-orientation","vertical"),e(this,re).setAttribute("aria-label",t?.volumeSlider||""),e(this,re).setAttribute("role","slider"),o(this,ge,document.createElement("input")),e(this,ge).type="range",e(this,ge).className="op-controls__volume--input",e(this,ge).tabIndex=-1,e(this,ge).value=e(this,G).getMedia().volume.toString(),e(this,ge).setAttribute("min","0"),e(this,ge).setAttribute("max","1"),e(this,ge).setAttribute("step","0.1"),e(this,ge).setAttribute("aria-label",t?.volumeControl||""),o(this,Ge,document.createElement("progress")),e(this,Ge).className="op-controls__volume--display",e(this,Ge).setAttribute("max","10"),e(this,Ge).value=e(this,G).getMedia().volume*10,e(this,re).appendChild(e(this,ge)),e(this,re).appendChild(e(this,Ge)),o(this,K,document.createElement("button")),e(this,K).type="button",e(this,K).className=`op-controls__mute op-control__${e(this,zt)}`,e(this,K).tabIndex=0,e(this,K).title=t?.mute||"",e(this,K).setAttribute("aria-controls",e(this,G).id),e(this,K).setAttribute("aria-pressed","false"),e(this,K).setAttribute("aria-label",t?.mute||"");const s=n=>{const r=n.volume*1,l=Math.floor(r*100);e(this,ge).value=`${n.volume}`,e(this,Ge).value=r*10,e(this,re).setAttribute("aria-valuenow",`${l}`),e(this,re).setAttribute("aria-valuetext",`${t?.volume}: ${l}`)},i=n=>{const r=n.volume;r<=.5&&r>0?(e(this,K).classList.remove("op-controls__mute--muted"),e(this,K).classList.add("op-controls__mute--half")):r===0?(e(this,K).classList.add("op-controls__mute--muted"),e(this,K).classList.remove("op-controls__mute--half")):(e(this,K).classList.remove("op-controls__mute--muted"),e(this,K).classList.remove("op-controls__mute--half"))},a=n=>{const r=e(this,G).activeElement(),l=parseFloat(n.target.value);r.volume=l,r.muted=r.volume===0,o(this,it,l);const d=e(this,G).getContainer().querySelector(".op-player__unmute");!r.muted&&d&&d.remove();const p=E("volumechange");e(this,G).getElement().dispatchEvent(p)};if(e(this,le).media.volumechange=()=>{const n=e(this,G).activeElement();s(n),i(n)},e(this,le).media.loadedmetadata=()=>{const n=e(this,G).activeElement();n.muted&&(n.volume=0);const r=E("volumechange");e(this,G).getElement().dispatchEvent(r)},e(this,le).slider.input=a.bind(this),e(this,le).slider.change=a.bind(this),e(this,le).button.click=()=>{e(this,K).setAttribute("aria-pressed","true");const n=e(this,G).activeElement();n.muted=!n.muted,n.muted?(n.volume=0,e(this,K).title=t?.unmute||"",e(this,K).setAttribute("aria-label",t?.unmute||"")):(n.volume=e(this,it),e(this,K).title=t?.mute||"",e(this,K).setAttribute("aria-label",t?.mute||""));const r=E("volumechange");e(this,G).getElement().dispatchEvent(r)},e(this,K).addEventListener("click",e(this,le).button.click,u),Object.keys(e(this,le).media).forEach(n=>{e(this,G).getElement().addEventListener(n,e(this,le).media[n],u)}),Object.keys(e(this,le).slider).forEach(n=>{e(this,ge).addEventListener(n,e(this,le).slider[n],u)}),e(this,G).getContainer().addEventListener("keydown",this._enterSpaceKeyEvent,u),!pe&&!_e||!e(this,G).getOptions().useDeviceVolume){const n=e(this,G).getControls().getLayer(e(this,gs));n.appendChild(e(this,K)),n.appendChild(e(this,re))}}destroy(){e(this,K).removeEventListener("click",e(this,le).button.click),Object.keys(e(this,le).media).forEach(t=>{e(this,G).getElement().removeEventListener(t,e(this,le).media[t])}),Object.keys(e(this,le).slider).forEach(t=>{e(this,ge).removeEventListener(t,e(this,le).slider[t])}),e(this,G).getContainer().removeEventListener("keydown",this._enterSpaceKeyEvent),e(this,ge).remove(),e(this,Ge).remove(),e(this,re).remove()}_enterSpaceKeyEvent(t){var s;const i=t.which||t.keyCode||0,a=e(this,G).activeElement();((s=document?.activeElement)==null?void 0:s.classList.contains("op-controls__mute"))&&(i===13||i===32)&&(a.muted=!a.muted,a.volume=a.muted?0:e(this,it),e(this,le).button.click(),t.preventDefault(),t.stopPropagation())}}G=new WeakMap,K=new WeakMap,re=new WeakMap,Ge=new WeakMap,ge=new WeakMap,le=new WeakMap,it=new WeakMap,zt=new WeakMap,gs=new WeakMap;class si{constructor(t){h(this,Ut),h(this,bt),h(this,he),h(this,b),h(this,Me),h(this,_s),this.events={media:{},mouse:{}},o(this,bt,0),o(this,_s,{Captions:Gs,Fullscreen:js,Levels:Ys,Play:Js,Progress:Zs,Settings:qs,Time:ei,Volume:ti}),o(this,b,t),this._setElements()}create(){e(this,b).getElement().controls=!1;const t=Pe(e(this,b).getElement());this._createControlsLayer(),this._buildElements(),this.events.controlschanged=()=>{this.destroy(),this._setElements(),this.create()},this.events.ended=()=>{e(this,b).getContainer().classList.remove("op-controls--hidden")},e(this,b).getElement().addEventListener("controlschanged",this.events.controlschanged,u),e(this,b).getElement().addEventListener("ended",this.events.ended,u);const{alwaysVisible:s}=e(this,b).getOptions().controls||{};if(!s){const i=()=>{t&&(e(this,b).getContainer().classList.remove("op-controls--hidden"),this._stopControlTimer())};this.events.mouse.mouseenter=()=>{t&&!e(this,b).activeElement().paused&&(this._stopControlTimer(),e(this,b).activeElement().currentTime?(e(this,b).playBtn.setAttribute("aria-hidden",e(this,b).isMedia()?"false":"true"),e(this,b).loader.setAttribute("aria-hidden","true")):e(this,b).getOptions().showLoaderOnInit&&(e(this,b).playBtn.setAttribute("aria-hidden","true"),e(this,b).loader.setAttribute("aria-hidden","false")),e(this,b).getContainer().classList.remove("op-controls--hidden"),this._startControlTimer(2500))},this.events.mouse.mousemove=()=>{t&&!e(this,b).activeElement().paused&&(e(this,b).activeElement().currentTime?(e(this,b).loader.setAttribute("aria-hidden","true"),e(this,b).playBtn.setAttribute("aria-hidden",e(this,b).isMedia()?"false":"true")):(e(this,b).playBtn.setAttribute("aria-hidden",e(this,b).getOptions().showLoaderOnInit?"true":"false"),e(this,b).loader.setAttribute("aria-hidden",e(this,b).getOptions().showLoaderOnInit?"false":"true")),e(this,b).getContainer().classList.remove("op-controls--hidden"),this._startControlTimer(2500))},this.events.mouse.mouseleave=()=>{t&&!e(this,b).activeElement().paused&&this._startControlTimer(1e3)},this.events.media.play=()=>{t&&this._startControlTimer(e(this,b).getOptions().hidePlayBtnTimer||350)},this.events.media.loadedmetadata=i.bind(this),this.events.media.pause=i.bind(this),this.events.media.waiting=i.bind(this),this.events.media.stalled=i.bind(this),this.events.media.playererror=i.bind(this),Object.keys(this.events.media).forEach(a=>{e(this,b).getElement().addEventListener(a,this.events.media[a],u)}),pe||_e?e(this,b).getContainer().addEventListener("click",this.events.mouse.mouseenter,u):Object.keys(this.events.mouse).forEach(a=>{e(this,b).getContainer().addEventListener(a,this.events.mouse[a],u)}),t&&!e(this,b).activeElement().paused&&this._startControlTimer(3e3)}}destroy(){!pe&&!_e&&(Object.keys(this.events.mouse).forEach(t=>{e(this,b).getContainer().removeEventListener(t,this.events.mouse[t])}),Object.keys(this.events.media).forEach(t=>{e(this,b).getElement().removeEventListener(t,this.events.media[t])}),this._stopControlTimer()),e(this,b).getElement().removeEventListener("controlschanged",this.events.controlschanged),e(this,b).getElement().removeEventListener("ended",this.events.ended),Object.keys(e(this,Me)).forEach(t=>{e(this,Me)[t].forEach(s=>{s.custom?this._destroyCustomElement(s):typeof s.destroy=="function"&&s.destroy()})}),e(this,he).remove()}getContainer(){return e(this,he)}getLayer(t){return e(this,he).querySelector(`.op-controls-layer__${t}`)||e(this,he)}_createControlsLayer(){if(!e(this,he)||!e(this,b).getContainer().querySelector(".op-controls")){o(this,he,document.createElement("div")),e(this,he).className="op-controls",e(this,b).getContainer().appendChild(e(this,he));const t=document.createElement("div");t.className="op-status",t.innerHTML="<span></span>",t.tabIndex=-1,t.setAttribute("aria-hidden","true"),me(e(this,b).getElement())&&e(this,he).appendChild(t)}}_startControlTimer(t){const s=e(this,b).activeElement();this._stopControlTimer(),typeof window<"u"&&o(this,bt,window.setTimeout(()=>{if((!s.paused||!s.ended)&&Pe(e(this,b).getElement())){e(this,b).getContainer().classList.add("op-controls--hidden"),e(this,b).playBtn.setAttribute("aria-hidden","true"),this._stopControlTimer();const i=E("controlshidden");e(this,b).getElement().dispatchEvent(i)}},t))}_stopControlTimer(){e(this,bt)!==0&&(clearTimeout(e(this,bt)),o(this,bt,0))}_setElements(){var t;const s=((t=e(this,b).getOptions().controls)==null?void 0:t.layers)||{};o(this,Me,{"bottom-left":[],"bottom-middle":[],"bottom-right":[],left:[],main:[],middle:[],right:[],"top-left":[],"top-middle":[],"top-right":[]});const i=Pe(e(this,b).getElement()),a=me(e(this,b).getElement()),n=Object.keys(s),r=n.find(l=>/^(top|bottom)/.test(l));this._createControlsLayer(),n.forEach(l=>{const[d,p]=l.split("-");if(p){e(this,he).classList.contains("op-controls__stacked")||e(this,he).classList.add("op-controls__stacked");const m=`op-controls-layer__${d}`;if(!e(this,he).querySelector(`.${m}`)){const c=document.createElement("div");c.className=m,e(this,he).appendChild(c)}}else if(r){const m="op-controls-layer__center";if(!e(this,he).querySelector(`.${m}`)){const c=document.createElement("div");c.className=m,e(this,he).appendChild(c)}}const A=s?s[l]:null;A&&A.filter((m,c,v)=>v.indexOf(m)===c).forEach(m=>{const c=r&&!p?"center":d,v=`${m.charAt(0).toUpperCase()}${m.slice(1)}`,L=new(e(this,_s))[v](e(this,b),p||d,c);m==="settings"&&o(this,Ut,L),(i||m!=="fullscreen"&&a)&&e(this,Me)[l].push(L)})}),e(this,b).getCustomControls().forEach(l=>{const[d,p]=l.position.split("-"),A=r&&!p?"center":d;l.layer=A,l.position=p||d,typeof l.index=="number"?e(this,Me)[l.position].splice(l.index,0,l):l.position==="right"?e(this,Me)[l.position].unshift(l):e(this,Me)[l.position].push(l)})}_buildElements(){Object.keys(e(this,Me)).forEach(s=>{e(this,Me)[s].forEach(i=>{i.custom?this._createCustomElement(i):i.create()})}),Object.keys(e(this,Me)).forEach(s=>{e(this,Me)[s].forEach(i=>{const a=!e(this,b).getOptions().detachMenus||i instanceof qs,n=i;if(a&&!n.custom&&typeof n.addSettings=="function"){const r=n.addSettings();e(this,Ut)&&Object.keys(r).length&&e(this,Ut).addItem(r.name,r.key,r.default,r.subitems,r.className)}})});const t=E("controlschanged");e(this,he).dispatchEvent(t)}_hideCustomMenu(t){let s;s&&typeof window<"u"&&window.cancelAnimationFrame(s),typeof window<"u"&&(s=window.requestAnimationFrame(()=>{t.setAttribute("aria-hidden","true")}))}_toggleCustomMenu(t,s,i){e(this,b).getContainer().querySelectorAll(".op-settings").forEach(n=>{n.getAttribute("aria-hidden")==="false"&&n.id!==s.id&&n.setAttribute("aria-hidden","true")}),s.setAttribute("aria-hidden",s.getAttribute("aria-hidden")==="true"?"false":"true"),typeof i.click=="function"&&i.click(t)}_createCustomElement(t){const s=document.createElement(t.type);if(s.tabIndex=0,s.id=t.id,s.className=`op-controls__${t.id} op-control__${t.position} ${t.showInAds?"":"op-control__hide-in-ad"}`,t.styles&&Object.assign(s.style,t.styles),t.type==="button"&&t.icon?s.innerHTML=/\.(jpg|png|svg|gif)$/.test(t.icon)?`<img src="${Ie(t.icon)}"${t.alt?`alt="${Ie(t.alt)}"`:""}>`:Ie(t.icon):t.content&&(s.innerHTML=Ie(t.content,!1)),t.type==="button"&&t.title&&(s.title=Ie(t.title)),t.type==="img"&&t.alt&&(s.alt=Ie(t.alt)),t.type!=="button"&&t.click&&typeof t.click=="function"&&s.setAttribute("aria-role","button"),t.type==="button"&&t.subitems&&Array.isArray(t.subitems)&&t.subitems.length>0){const i=document.createElement("div");i.className="op-settings op-settings__custom",i.id=`${t.id}-menu`,i.setAttribute("aria-hidden","true");const a=t.subitems.map(n=>{let r="";return n.icon&&(r=/\.(jpg|png|svg|gif)$/.test(n.icon)?`<img src="${Ie(n.icon)}"${n.alt?`alt="${Ie(n.alt)}"`:""}>`:Ie(n.icon,!1)),`<div class="op-settings__menu-item" tabindex="0" ${n.title?`title="${n.title}"`:""} role="menuitemradio">
                    <div class="op-settings__menu-label" id="${n.id}" data-value="${t.id}-${n.id}">${r} ${n.label}</div>
                </div>`});i.innerHTML=`<div class="op-settings__menu" role="menu">${a.join("")}</div>`,e(this,b).getContainer().appendChild(i),t.subitems.forEach(n=>{const r=i.querySelector(`#${n.id}`);r&&n.click&&typeof n.click=="function"&&r.addEventListener("click",n.click,u)}),s.addEventListener("click",n=>this._toggleCustomMenu(n,i,t),u),e(this,b).getElement().addEventListener("controlshidden",()=>this._hideCustomMenu(i),u)}else t.click&&typeof t.click=="function"&&s.addEventListener("click",t.click,u);t.mouseenter&&typeof t.mouseenter=="function"&&s.addEventListener("mouseenter",t.mouseenter,u),t.mouseleave&&typeof t.mouseleave=="function"&&s.addEventListener("mouseleave",t.mouseleave,u),t.keydown&&typeof t.keydown=="function"&&s.addEventListener("keydown",t.keydown,u),t.blur&&typeof t.blur=="function"&&s.addEventListener("blur",t.blur,u),t.focus&&typeof t.focus=="function"&&s.addEventListener("focus",t.focus,u),t.layer&&(t.layer==="main"?e(this,b).getContainer().appendChild(s):this.getLayer(t.layer).appendChild(s)),t.init&&typeof t.init=="function"&&t.init(e(this,b))}_destroyCustomElement(t){const s=this.getContainer().querySelector(`.op-controls__${t.id}`);if(s){if(t.subitems&&Array.isArray(t.subitems)&&t.subitems.length>0){const i=e(this,b).getContainer().querySelector(`#${t.id}-menu`);i&&(t.subitems.forEach(a=>{const n=i.querySelector(`#${a.id}`);n&&a.click&&typeof a.click=="function"&&n.removeEventListener("click",a.click)}),s.removeEventListener("click",a=>this._toggleCustomMenu(a,i,t)),e(this,b).getElement().removeEventListener("controlshidden",()=>this._hideCustomMenu(i)),i.remove())}t.click&&typeof t.click=="function"&&s.removeEventListener("click",t.click),t.mouseenter&&typeof t.mouseenter=="function"&&s.removeEventListener("mouseenter",t.mouseenter),t.mouseleave&&typeof t.mouseleave=="function"&&s.removeEventListener("mouseleave",t.mouseleave),t.keydown&&typeof t.keydown=="function"&&s.removeEventListener("keydown",t.keydown),t.blur&&typeof t.blur=="function"&&s.removeEventListener("blur",t.blur),t.focus&&typeof t.focus=="function"&&s.removeEventListener("focus",t.focus),s.remove(),t.destroy&&typeof t.destroy=="function"&&t.destroy(e(this,b))}}}Ut=new WeakMap,bt=new WeakMap,he=new WeakMap,b=new WeakMap,Me=new WeakMap,_s=new WeakMap;class Ts{constructor(t,s){h(this,bs),this.element=t,this.media=s,this.promise=new Promise(i=>{i()})}set instance(t){o(this,bs,t)}get instance(){return e(this,bs)}play(){return this.element.play()}pause(){this.element.pause()}set volume(t){this.element.volume=t}get volume(){return this.element.volume}set muted(t){this.element.muted=t}get muted(){return this.element.muted}set playbackRate(t){this.element.playbackRate=t}get playbackRate(){return this.element.playbackRate}set defaultPlaybackRate(t){this.element.defaultPlaybackRate=t}get defaultPlaybackRate(){return this.element.defaultPlaybackRate}set currentTime(t){this.element.currentTime=t}get currentTime(){return this.element.currentTime}get duration(){return this.element.duration}get paused(){return this.element.paused}get ended(){return this.element.ended}}bs=new WeakMap;class ii extends Ts{constructor(t,s,i){super(t,s),h(this,Y),h(this,Ce,{}),h(this,Es,{}),o(this,Es,i),this._assign=this._assign.bind(this),this._preparePlayer=this._preparePlayer.bind(this),this.promise=typeof dashjs>"u"?Ms("https://cdn.dashjs.org/latest/dash.all.min.js"):new Promise(a=>{a({})}),this.promise.then(()=>{o(this,Y,dashjs.MediaPlayer().create()),this.instance=e(this,Y)})}canPlayType(t){return Fs&&t==="application/dash+xml"}load(){this._preparePlayer(),e(this,Y).attachSource(this.media.src);const t=E("loadedmetadata");this.element.dispatchEvent(t),e(this,Ce)||(o(this,Ce,dashjs.MediaPlayer.events),Object.keys(e(this,Ce)).forEach(s=>{e(this,Y).on(e(this,Ce)[s],this._assign)}))}destroy(){e(this,Ce)&&(Object.keys(e(this,Ce)).forEach(t=>{e(this,Y).off(e(this,Ce)[t],this._assign)}),o(this,Ce,[])),e(this,Y).reset()}set src(t){xs(t)&&(this.destroy(),o(this,Y,dashjs.MediaPlayer().create()),this._preparePlayer(),e(this,Y).attachSource(t.src),o(this,Ce,dashjs.MediaPlayer.events),Object.keys(e(this,Ce)).forEach(s=>{e(this,Y).on(e(this,Ce)[s],this._assign)}))}get levels(){const t=[];if(e(this,Y)){const s=e(this,Y).getBitrateInfoListFor("video");s.length&&s.forEach(i=>{if(s[i]){const{height:a,name:n}=s[i],r={height:a,id:`${i}`,label:n||null};t.push(r)}})}return t}set level(t){t==="0"?e(this,Y).setAutoSwitchQuality(!0):(e(this,Y).setAutoSwitchQuality(!1),e(this,Y).setQualityFor("video",t))}get level(){return e(this,Y)?e(this,Y).getQualityFor("video"):"-1"}_assign(t){if(t.type==="error"){const i=E("playererror",{detail:{message:t,type:"M(PEG)-DASH"}});this.element.dispatchEvent(i)}else{const s=E(t.type,{detail:t});this.element.dispatchEvent(s)}}_preparePlayer(){e(this,Y).updateSettings({debug:{logLevel:dashjs.Debug.LOG_LEVEL_NONE},streaming:{fastSwitchEnabled:!0,scheduleWhilePaused:!1},...e(this,Es)||{}}),e(this,Y).initialize(),e(this,Y).attachView(this.element),e(this,Y).setAutoPlay(!1)}}Y=new WeakMap,Ce=new WeakMap,Es=new WeakMap;class ni extends Ts{constructor(t,s,i){super(t,s),h(this,ee),h(this,De,{}),h(this,ys,{}),o(this,ys,i),this.element=t,this.media=s,this._create=this._create.bind(this),this._assign=this._assign.bind(this),this.promise=typeof flvjs>"u"?Ms("https://cdn.jsdelivr.net/npm/flv.js@latest/dist/flv.min.js"):new Promise(a=>{a({})}),this.promise.then(this._create)}canPlayType(t){return Fs&&(t==="video/x-flv"||t==="video/flv")}load(){e(this,ee).unload(),e(this,ee).detachMediaElement(),e(this,ee).attachMediaElement(this.element),e(this,ee).load();const t=E("loadedmetadata");this.element.dispatchEvent(t),e(this,De)||(o(this,De,flvjs.Events),Object.keys(e(this,De)).forEach(s=>{e(this,ee).on(e(this,De)[s],(...i)=>this._assign(e(this,De)[s],i))}))}destroy(){e(this,ee).destroy(),o(this,ee,null)}set src(t){Hs(t)&&(this.destroy(),this._create())}get levels(){const t=[];return e(this,ee)&&e(this,ee).levels&&e(this,ee).levels.length&&Object.keys(e(this,ee).levels).forEach(s=>{const{height:i,name:a}=e(this,ee).levels[s],n={height:i,id:s,label:a||null};t.push(n)}),t}set level(t){e(this,ee).currentLevel=t}get level(){return e(this,ee)?e(this,ee).currentLevel:"-1"}_create(){const{configs:t,...s}=e(this,ys)||{};flvjs.LoggingControl.enableDebug=s?.debug||!1,flvjs.LoggingControl.enableVerbose=s?.debug||!1;const i={...s,type:"flv",url:this.media.src};o(this,ee,flvjs.createPlayer(i,t||{})),this.instance=e(this,ee),e(this,De)||(o(this,De,flvjs.Events),Object.keys(e(this,De)).forEach(a=>{e(this,ee).on(e(this,De)[a],(...n)=>this._assign(e(this,De)[a],n))}))}_assign(t,s){if(t==="error"){const i={detail:{data:s,message:`${s[0]}: ${s[1]} ${s[2].msg}`,type:"FLV"}},a=E("playererror",i);this.element.dispatchEvent(a)}else{const i=E(t,{detail:{data:s}});this.element.dispatchEvent(i)}}}ee=new WeakMap,De=new WeakMap,ys=new WeakMap;class ai extends Ts{constructor(t,s,i,a){super(t,s),h(this,O),h(this,ie,{}),h(this,Gt,0),h(this,Qt,0),h(this,Ot),h(this,ks),o(this,Ot,a||{}),this.element=t,this.media=s,o(this,ks,i),this._create=this._create.bind(this),this._play=this._play.bind(this),this._pause=this._pause.bind(this),this._assign=this._assign.bind(this),this.promise=typeof Hls>"u"?Ms("https://cdn.jsdelivr.net/npm/hls.js@latest/dist/hls.min.js"):new Promise(n=>{n({})}),this.promise.then(this._create)}canPlayType(t){return zs()&&t==="application/x-mpegURL"}load(){e(this,O)&&(e(this,O).detachMedia(),e(this,O).loadSource(this.media.src),e(this,O).attachMedia(this.element));const t=E("loadedmetadata");this.element.dispatchEvent(t),e(this,ie)||(o(this,ie,Hls.Events),Object.keys(e(this,ie)).forEach(s=>{e(this,O).on(e(this,ie)[s],(...i)=>this._assign(e(this,ie)[s],i))}))}destroy(){e(this,O)&&e(this,O).stopLoad(),e(this,ie)&&Object.keys(e(this,ie)).forEach(t=>{e(this,O).off(e(this,ie)[t],(...s)=>this._assign(e(this,ie)[t],s))}),this.element.removeEventListener("play",this._play),this.element.removeEventListener("pause",this._pause),e(this,O)&&(e(this,O).destroy(),o(this,O,null))}set src(t){Cs(t)&&(this.destroy(),o(this,O,new Hls(e(this,Ot))),e(this,O).loadSource(t.src),e(this,O).attachMedia(this.element),o(this,ie,Hls.Events),Object.keys(e(this,ie)).forEach(s=>{e(this,O).on(e(this,ie)[s],(...i)=>this._assign(e(this,ie)[s],i))}))}get levels(){const t=[];return e(this,O)&&e(this,O).levels&&e(this,O).levels.length&&Object.keys(e(this,O).levels).forEach(s=>{const{height:i,name:a}=e(this,O).levels[s],n={height:i,id:s,label:a||null};t.push(n)}),t}set level(t){const s=Number(t);s&&s>-1?e(this,O).loadLevel=s:e(this,O).currentLevel=s}get level(){return e(this,O)?e(this,O).currentLevel:"-1"}_create(){const t=!!(this.element.preload==="auto"||e(this,ks));e(this,Ot).autoStartLoad=t,o(this,O,new Hls(e(this,Ot))),this.instance=e(this,O),o(this,ie,Hls.Events),Object.keys(e(this,ie)).forEach(s=>{e(this,O).on(e(this,ie)[s],(...i)=>this._assign(e(this,ie)[s],i))}),t||(this.element.addEventListener("play",this._play,u),this.element.addEventListener("pause",this._pause,u))}_assign(t,s){if(t==="hlsError"){const i={detail:{data:s,message:s[1].details,type:"HLS"}},a=E("playererror",i);this.element.dispatchEvent(a);const n=s[1].type,{fatal:r}=s[1],l=s[1];if(r)switch(n){case"mediaError":const d=new Date().getTime();if(!e(this,Gt)||d-e(this,Gt)>3e3)o(this,Gt,new Date().getTime()),e(this,O).recoverMediaError();else if(!e(this,Qt)||d-e(this,Qt)>3e3)o(this,Qt,new Date().getTime()),console.warn("Attempting to swap Audio Codec and recover from media error"),e(this,O).swapAudioCodec(),e(this,O).recoverMediaError();else{console.error("Cannot recover, last media error recovery failed");const v=E(n,{detail:{data:l}});this.element.dispatchEvent(v)}break;case"networkError":console.error("Network error");const A=E(n,{detail:{data:l}});this.element.dispatchEvent(A);break;default:e(this,O).destroy();const m=E(n,{detail:{data:l}});this.element.dispatchEvent(m);break}else{const d=E(n,{detail:{data:l}});this.element.dispatchEvent(d)}}else{const i=s[1];if(t==="hlsLevelLoaded"&&i.live===!0){this.element.setAttribute("op-live__enabled","true");const n=E("timeupdate");this.element.dispatchEvent(n)}else if(t==="hlsLevelUpdated"&&i.live===!0&&i.totalduration>Bs){this.element.setAttribute("op-dvr__enabled","true");const n=E("timeupdate");this.element.dispatchEvent(n)}else if(t==="hlsFragParsingMetadata"){const n=E("metadataready",{detail:{data:s[1]}});this.element.dispatchEvent(n)}const a=E(t,{detail:{data:s[1]}});this.element.dispatchEvent(a)}}_play(){e(this,O)&&e(this,O).startLoad()}_pause(){e(this,O)&&e(this,O).stopLoad()}}O=new WeakMap,ie=new WeakMap,Gt=new WeakMap,Qt=new WeakMap,Ot=new WeakMap,ks=new WeakMap;class Ss extends Ts{constructor(t,s){if(super(t,s),h(this,Xt),h(this,Wt,[]),h(this,As,!1),h(this,Pt,0),h(this,It,!1),h(this,xt),!me(t)&&!Pe(t))throw new TypeError("Native method only supports video/audio tags");this._clearTimeout=this._clearTimeout.bind(this),this._setTimeout=this._setTimeout.bind(this),this._dispatchError=this._dispatchError.bind(this),this._isDvrEnabled=this._isDvrEnabled.bind(this),this._readMediadataInfo=this._readMediadataInfo.bind(this),o(this,As,Cs(s)),this.element.addEventListener("playing",this._clearTimeout,u),this.element.addEventListener("stalled",this._setTimeout,u),this.element.addEventListener("error",this._dispatchError,u),this.element.addEventListener("loadeddata",this._isDvrEnabled,u),this.element.textTracks.addEventListener("addtrack",this._readMediadataInfo,u)}canPlayType(t){return!!this.element.canPlayType(t).replace("no","")}load(){this.element.load()}destroy(){this.element.removeEventListener("playing",this._clearTimeout),this.element.removeEventListener("stalled",this._setTimeout),this.element.removeEventListener("error",this._dispatchError),this.element.removeEventListener("loadeddata",this._isDvrEnabled),this.element.textTracks.removeEventListener("addtrack",this._readMediadataInfo)}get levels(){if(!e(this,Wt).length){const t=this.element.querySelectorAll("source[title]");for(let s=0,i=t.length;s<i;++s){const a={height:0,id:`${s}`,label:t[s].getAttribute("title")||""};e(this,Wt).push(a)}}return e(this,Wt)}set level(t){const s=e(this,Wt).findIndex(i=>i.id===t);if(s>-1){o(this,Xt,this.levels[s]);const i=this.element.querySelectorAll("source[title]");for(let a=0,n=i.length;a<n;++a){const r=i[a].getAttribute("src");r&&parseInt(e(this,Xt).id,10)===a&&(this.element.src=r)}}}get level(){var t;return((t=e(this,Xt))==null?void 0:t.id)||"-1"}set src(t){this.element.src=t.src}_isDvrEnabled(){const t=this.element.seekable.end(this.element.seekable.length-1)-this.element.seekable.start(0);if(e(this,As)&&t>Bs&&!this.element.getAttribute("op-dvr__enabled")){this.element.setAttribute("op-dvr__enabled","true");const s=E("timeupdate");this.element.dispatchEvent(s)}}_readMediadataInfo(t){var s;const i=t;((s=i?.track)==null?void 0:s.kind)==="metadata"&&(i.track.mode="hidden",i.track.addEventListener("cuechange",a=>{const n=a.target,r=n.activeCues?n.activeCues[0]:null;if(r){const l=E("metadataready",{detail:r});this.element.dispatchEvent(l)}},u))}_setTimeout(){!e(this,It)&&window!==void 0&&(o(this,It,!0),o(this,xt,window.setInterval(()=>{if(e(this,Pt)>=30){clearInterval(e(this,xt));const t="Media download failed part-way due to a network error",i=E("playererror",{detail:{data:{message:t,error:2},message:t,type:"HTML5"}});this.element.dispatchEvent(i),o(this,Pt,0),o(this,It,!1)}else Ps(this,Pt)._++},1e3)))}_clearTimeout(){e(this,xt)&&(clearInterval(e(this,xt)),o(this,Pt,0),o(this,It,!1))}_dispatchError(t){let s;const i=t.target,a=i?.error;switch(a?.code){case a?.MEDIA_ERR_ABORTED:s="Media playback aborted";break;case a?.MEDIA_ERR_NETWORK:s="Media download failed part-way due to a network error";break;case a?.MEDIA_ERR_DECODE:s=`Media playback aborted due to a corruption problem or because the
                    media used features your browser did not support.`;break;case a?.MEDIA_ERR_SRC_NOT_SUPPORTED:s=`Media could not be loaded, either because the server or network failed
                    or because the format is not supported.`;break;default:s="Unknown error occurred.";break}const n={detail:{data:{...t,message:s,error:a?.code},message:s,type:"HTML5"}},r=E("playererror",n);this.element.dispatchEvent(r)}}Xt=new WeakMap,Wt=new WeakMap,As=new WeakMap,Pt=new WeakMap,It=new WeakMap,xt=new WeakMap;class ss{constructor(t,s,i,a){h(this,P),h(this,k),h(this,de),h(this,Rt),h(this,Qe),h(this,Yt),h(this,nt,!1),h(this,Et,{media:{},optionsKey:{},rules:[]}),h(this,Nt),o(this,P,t),o(this,Qe,s),o(this,de,this._getMediaFiles()),o(this,Et,a),o(this,Yt,i)}canPlayType(t){return e(this,k).canPlayType(t)}async load(){if(!e(this,nt)){if(o(this,nt,!0),!e(this,de).length)throw new TypeError("Media not set");e(this,k)&&typeof e(this,k).destroy=="function"&&(e(this,de).length===1&&e(this,de)[0].src===e(this,k).media.src||e(this,k).destroy()),e(this,de).some(t=>{try{o(this,k,this._invoke(t))}catch{o(this,k,new Ss(e(this,P),t))}return e(this,k).canPlayType(t.type)});try{if(e(this,k)===null)throw new TypeError("Media cannot be played with any valid media type");await e(this,k).promise,e(this,k).load()}catch(t){throw e(this,k)&&e(this,k).destroy(),t}}}async play(){return e(this,nt)?await e(this,k).promise:(await this.load(),o(this,nt,!1)),o(this,Rt,e(this,k).play()),e(this,Rt)}async pause(){e(this,Rt)!==void 0&&await e(this,Rt),e(this,k).pause()}destroy(){e(this,k)&&e(this,k).destroy()}set src(t){if(typeof t=="string"?e(this,de).push({src:t,type:ts(t,e(this,P))}):Array.isArray(t)?o(this,de,t):typeof t=="object"&&e(this,de).push(t),o(this,de,e(this,de).filter(s=>s.src)),e(this,de).length>0){const[s]=e(this,de);e(this,P).src&&e(this,P).setAttribute("data-op-file",e(this,de)[0].src),e(this,P).src=s.src,o(this,Nt,s),e(this,k)&&(e(this,k).src=s)}else e(this,P).src=""}get src(){return e(this,de)}get current(){return e(this,Nt)}set mediaFiles(t){o(this,de,t)}get mediaFiles(){return e(this,de)}set volume(t){e(this,k)&&(e(this,k).volume=t)}get volume(){return e(this,k)?e(this,k).volume:e(this,P).volume}set muted(t){e(this,k)&&(e(this,k).muted=t)}get muted(){return e(this,k)?e(this,k).muted:e(this,P).muted}set playbackRate(t){e(this,k)&&(e(this,k).playbackRate=t)}get playbackRate(){return e(this,k)?e(this,k).playbackRate:e(this,P).playbackRate}set defaultPlaybackRate(t){e(this,k)&&(e(this,k).defaultPlaybackRate=t)}get defaultPlaybackRate(){return e(this,k)?e(this,k).defaultPlaybackRate:e(this,P).defaultPlaybackRate}set currentTime(t){e(this,k)&&(e(this,k).currentTime=t)}get currentTime(){return e(this,k)?e(this,k).currentTime:e(this,P).currentTime}get duration(){const t=e(this,k)?e(this,k).duration:e(this,P).duration;return t===1/0&&e(this,P).seekable&&e(this,P).seekable.length?e(this,P).seekable.end(0):t}get paused(){return e(this,k)?e(this,k).paused:e(this,P).paused}get ended(){return e(this,k)?e(this,k).ended:e(this,P).ended}set loaded(t){o(this,nt,t)}get loaded(){return e(this,nt)}set level(t){e(this,k)&&(e(this,k).level=t)}get level(){return e(this,k)?e(this,k).level:-1}get levels(){return e(this,k)?e(this,k).levels:[]}get instance(){return e(this,k)?e(this,k).instance:null}_getMediaFiles(){const t=[],s=e(this,P).querySelectorAll("source"),i=e(this,P).src;i&&t.push({src:i,type:e(this,P).getAttribute("type")||ts(i,e(this,P))});for(let a=0,n=s.length;a<n;a++){const r=s[a],{src:l}=r;if(t.push({src:l,type:r.getAttribute("type")||ts(l,e(this,P))}),a===0){const[d]=t;o(this,Nt,d)}}return t.length||t.push({src:"",type:ts("",e(this,P))}),t}_invoke(t){var s,i,a;const n=e(this,P).canPlayType("application/vnd.apple.mpegurl")||e(this,P).canPlayType("application/x-mpegURL");o(this,Nt,t);const{layers:r}=e(this,Qe).controls||{};let l=!1;if(r&&Object.keys(r).forEach(d=>{const p=r?r[d]:null;p&&p.indexOf("levels")>-1&&(l=!0)}),Object.keys(e(this,Et).media).length){let d;return e(this,Et).rules.forEach(p=>{const A=p(t.src);if(A){const m=e(this,Et).media[A],c=e(this,Qe)[e(this,Et).optionsKey[A]]||void 0;d=m(e(this,P),t,e(this,Yt),c)}}),d?(d.create(),d):new Ss(e(this,P),t)}if(Cs(t)){if(n&&e(this,Qe).forceNative&&!l)return new Ss(e(this,P),t);const d=((s=e(this,Qe))==null?void 0:s.hls)||void 0;return new ai(e(this,P),t,e(this,Yt),d)}if(xs(t)){const d=((i=e(this,Qe))==null?void 0:i.dash)||void 0;return new ii(e(this,P),t,d)}if(Hs(t)){const d=((a=e(this,Qe))==null?void 0:a.flv)||{debug:!1,type:"flv",url:t.src};return new ni(e(this,P),t,d)}return new Ss(e(this,P),t)}}P=new WeakMap,k=new WeakMap,de=new WeakMap,Rt=new WeakMap,Qe=new WeakMap,Yt=new WeakMap,nt=new WeakMap,Et=new WeakMap,Nt=new WeakMap;class Os{constructor(t,s,i,a,n){h(this,yt),h(this,Fe),h(this,Te),h(this,Se),h(this,at),h(this,$t),h(this,Ke),h(this,kt),h(this,Xe),h(this,x),h(this,At),h(this,ce),h(this,g),h(this,Ye),h(this,Ae),h(this,Ls),h(this,Oe),h(this,ye),h(this,qe),h(this,ne),h(this,Lt),h(this,Be),h(this,ot),h(this,rt),h(this,We),h(this,R),h(this,Je),h(this,Jt),h(this,Dt),h(this,Ft),h(this,Zt),h(this,ws),h(this,Ze);var r,l,d,p;this.loadedAd=!1,o(this,yt,!1),o(this,Fe,!1),o(this,Te,!1),o(this,Se,!1),o(this,at,0),o(this,Ke,!1),o(this,kt,0),o(this,Xe,0),o(this,x,null),o(this,Ye,[]),o(this,ot,!1),o(this,rt,!1),o(this,We,!1),o(this,Je,0),o(this,Ft,0),o(this,Zt,[]),o(this,ws,!1),o(this,Ze,null);const A={autoPlayAdBreaks:!0,customClick:{enabled:!1,label:"Click here for more info"},audioSkip:{enabled:!0,label:"Skip Ad",remainingLabel:"Skip in [[secs]] seconds"},debug:!1,enablePreloading:!1,language:"en",loop:!1,numRedirects:4,publisherId:void 0,sdkPath:"https://imasdk.googleapis.com/js/sdkloader/ima3.js",sessionId:void 0,src:[],vpaidMode:"enabled"};o(this,At,t),o(this,Ae,s),o(this,ce,t.getMedia()),o(this,g,t.getElement()),o(this,ot,i||!1),o(this,Ke,t.getElement().muted),o(this,rt,a||!1),o(this,R,{...A,...n}),n?.customClick&&Object.keys(n.customClick).length&&(e(this,R).customClick={...A.customClick,...n.customClick}),o(this,We,!1),o(this,Jt,e(this,g).volume),o(this,$t,e(this,Jt));const m=(r=e(this,R))!=null&&r.debug?(d=(l=e(this,R))==null?void 0:l.sdkPath)==null?void 0:d.replace(/(\.js$)/,"_debug.js"):(p=e(this,R))==null?void 0:p.sdkPath;this.load=this.load.bind(this),this.resizeAds=this.resizeAds.bind(this),this._handleClickInContainer=this._handleClickInContainer.bind(this),this._handleSkipAds=this._handleSkipAds.bind(this),this._loaded=this._loaded.bind(this),this._error=this._error.bind(this),this._assign=this._assign.bind(this),this._contentLoadedAction=this._contentLoadedAction.bind(this),this._loadedMetadataHandler=this._loadedMetadataHandler.bind(this),this._contentEndedListener=this._contentEndedListener.bind(this),this._handleResizeAds=this._handleResizeAds.bind(this),this._onContentPauseRequested=this._onContentPauseRequested.bind(this),this._onContentResumeRequested=this._onContentResumeRequested.bind(this),o(this,Ls,m&&(typeof google>"u"||typeof google.ima>"u")?Ms(m):new Promise(c=>{c()})),e(this,Ls).then(()=>{this.load()}).catch(c=>{let v="Ad script could not be loaded; please check if you have an AdBlock ";v+="turned on, or if you provided a valid URL is correct",console.error(`Ad error: ${v}.`);const M=E("playererror",{detail:{data:c,message:v,type:"Ads"}});e(this,g).dispatchEvent(M)})}load(t=!1){var s,i,a;if(typeof google>"u"||!google.ima||!t&&this.loadedAd&&e(this,R).autoPlayAdBreaks||!e(this,R).autoPlayAdBreaks&&!t)return;this.loadedAd=!0;const n=e(this,At).getContainer().querySelector(".op-ads");if(n&&n.parentNode&&n.parentNode.removeChild(n),o(this,Se,!0),o(this,ye,document.createElement("div")),e(this,ye).className="op-ads",e(this,ye).tabIndex=-1,e(this,g).parentElement&&e(this,g).parentElement.insertBefore(e(this,ye),e(this,g).nextSibling),e(this,ye).addEventListener("click",this._handleClickInContainer),(s=e(this,R).customClick)!=null&&s.enabled&&(o(this,qe,document.createElement("div")),e(this,qe).className="op-ads__click-container",e(this,qe).innerHTML=`<div class="op-ads__click-label">${e(this,R).customClick.label}</div>`,e(this,g).parentElement&&e(this,g).parentElement.insertBefore(e(this,qe),e(this,g).nextSibling)),me(e(this,g))&&((i=e(this,R).audioSkip)!=null&&i.enabled)){if((a=e(this,R).audioSkip)!=null&&a.element){const{element:l}=e(this,R).audioSkip||{};if(typeof l=="string"){const d=document.getElementById(l);d&&o(this,ne,d)}else l instanceof HTMLElement&&o(this,ne,l)}else o(this,ne,document.createElement("button")),e(this,ne).className="op-ads__skip hidden",e(this,At).getControls().getContainer().appendChild(e(this,ne));e(this,ne)&&e(this,ne).addEventListener("click",this._handleSkipAds,u)}o(this,Zt,e(this,ce).src);const r={disabled:google.ima.ImaSdkSettings.VpaidMode.DISABLED,enabled:google.ima.ImaSdkSettings.VpaidMode.ENABLED,insecure:google.ima.ImaSdkSettings.VpaidMode.INSECURE};google.ima.settings.setVpaidMode(r[e(this,R).vpaidMode||"enabled"]),google.ima.settings.setDisableCustomPlaybackForIOS10Plus(!0),google.ima.settings.setAutoPlayAdBreaks(e(this,R).autoPlayAdBreaks),google.ima.settings.setNumRedirects(e(this,R).numRedirects),google.ima.settings.setLocale(e(this,R).language),e(this,R).sessionId&&google.ima.settings.setSessionId(e(this,R).sessionId),e(this,R).publisherId&&google.ima.settings.setPpid(e(this,R).publisherId),google.ima.settings.setPlayerType("openplayerjs"),google.ima.settings.setPlayerVersion("3.0.0"),o(this,Lt,new google.ima.AdDisplayContainer(e(this,ye),e(this,g),e(this,qe))),o(this,Oe,new google.ima.AdsLoader(e(this,Lt))),e(this,Oe).addEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,this._loaded,u),e(this,Oe).addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,this._error,u),typeof window<"u"&&window.addEventListener("resize",this._handleResizeAds,u),e(this,g).addEventListener("loadedmetadata",this._handleResizeAds,u),(e(this,ot)===!0||e(this,rt)===!0||t===!0||e(this,R).enablePreloading===!0||e(this,We)===!0)&&(e(this,Fe)||(o(this,Fe,!0),e(this,Lt).initialize()),this._requestAds())}async play(){if(!e(this,Fe)){o(this,We,!0),this._initNotDoneAds();return}if(e(this,x))try{!e(this,at)&&e(this,Te)===!1?e(this,x).start():e(this,x).resume(),o(this,Te,!0);const t=E("play");e(this,g).dispatchEvent(t)}catch{this._resumeMedia()}}pause(){if(e(this,x)){o(this,Te,!1),e(this,x).pause();const t=E("pause");e(this,g).dispatchEvent(t)}}destroy(){var t,s;e(this,x)&&(e(this,x).removeEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,this._error),e(this,Ye)&&e(this,Ye).forEach(r=>{e(this,x).removeEventListener(r,this._assign)})),o(this,Ye,[]);const i=e(this,At).getControls(),a=i?i.events.mouse:{};Object.keys(a).forEach(r=>{e(this,ye)&&e(this,ye).removeEventListener(r,a[r])}),e(this,Oe)&&(e(this,Oe).removeEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,this._error),e(this,Oe).removeEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,this._loaded));const n=!Array.isArray(e(this,Ae))||e(this,Je)>e(this,Ae).length;e(this,x)&&n&&e(this,x).destroy(),(t=e(this,R).customClick)!=null&&t.enabled&&e(this,qe)&&e(this,qe).remove(),(s=e(this,R).audioSkip)!=null&&s.enabled&&e(this,ne)&&(e(this,ne).removeEventListener("click",this._handleSkipAds),e(this,ne).remove()),(_e||pe)&&e(this,g).removeEventListener("loadedmetadata",this._contentLoadedAction),e(this,g).removeEventListener("loadedmetadata",this._handleResizeAds),e(this,g).removeEventListener("loadedmetadata",this._loadedMetadataHandler),e(this,g).removeEventListener("ended",this._contentEndedListener),typeof window<"u"&&window.removeEventListener("resize",this._handleResizeAds),e(this,ye)&&(e(this,ye).removeEventListener("click",this._handleClickInContainer),e(this,ye).remove()),this.loadPromise=null,this.loadedAd=!1,o(this,Fe,!1),o(this,We,!1),o(this,kt,0),o(this,Xe,0),o(this,Ze,null)}resizeAds(t,s){if(e(this,x)){const i=e(this,g),a=i.getAttribute("data-fullscreen")==="true"?google.ima.ViewMode.FULLSCREEN:google.ima.ViewMode.NORMAL;let n=t;const r=t?t.toString():"";t&&r.indexOf("%")>-1&&e(this,g).parentElement&&(n=e(this,g).parentElement.offsetWidth*(parseInt(r,10)/100));let l=s;const d=s?s.toString():"";s&&d.indexOf("%")>-1&&e(this,g).parentElement&&(l=e(this,g).parentElement.offsetHeight*(parseInt(d,10)/100));let p;p&&typeof window<"u"&&window.cancelAnimationFrame(p),typeof window<"u"&&(p=window.requestAnimationFrame(()=>{e(this,x).resize(n||i.offsetWidth,l||i.offsetHeight,a)}))}}getAdsManager(){return e(this,x)}getAdsLoader(){return e(this,Oe)}started(){return e(this,Se)}set src(t){o(this,Ae,t)}set isDone(t){o(this,Fe,t)}set playRequested(t){o(this,We,t)}set volume(t){e(this,x)&&(o(this,$t,t),e(this,x).setVolume(t),this._setMediaVolume(t),o(this,Ke,t===0))}get volume(){return e(this,x)?e(this,x).getVolume():e(this,Jt)}set muted(t){e(this,x)&&(t?(e(this,x).setVolume(0),o(this,Ke,!0),this._setMediaVolume(0)):(e(this,x).setVolume(e(this,$t)),o(this,Ke,!1),this._setMediaVolume(e(this,$t))))}get muted(){return e(this,Ke)}set currentTime(t){o(this,Xe,t)}get currentTime(){return e(this,Xe)}get duration(){return e(this,kt)}get paused(){return!e(this,Te)}get ended(){return e(this,yt)}_assign(t){var s,i;const a=t.getAd();switch(a&&o(this,Ze,a),t.type){case google.ima.AdEvent.Type.LOADED:if(!a.isLinear())this._onContentResumeRequested();else if(jt&&Pe(e(this,g))&&(e(this,g).controls=!1),o(this,kt,a.getDuration()),o(this,Xe,a.getDuration()),!e(this,ws)&&!_e&&!pe){const d=E("waiting");e(this,g).dispatchEvent(d);const p=E("loadedmetadata");e(this,g).dispatchEvent(p),this.resizeAds()}break;case google.ima.AdEvent.Type.STARTED:if(a.isLinear()){e(this,g).parentElement&&!e(this,g).parentElement.classList.contains("op-ads--active")&&e(this,g).parentElement.classList.add("op-ads--active"),e(this,ce).paused||e(this,ce).pause(),o(this,Te,!0);const d=E("play");e(this,g).dispatchEvent(d);let p;if(p||(this.resizeAds(),p=!0),e(this,ce).ended){o(this,yt,!1);const A=E("adsmediaended");e(this,g).dispatchEvent(A)}typeof window<"u"&&o(this,at,window.setInterval(()=>{if(e(this,Te)===!0){o(this,Xe,Math.round(e(this,x).getRemainingTime()));const A=E("timeupdate");e(this,g).dispatchEvent(A)}},350))}break;case google.ima.AdEvent.Type.COMPLETE:case google.ima.AdEvent.Type.SKIPPED:if(a.isLinear()){if(t.type===google.ima.AdEvent.Type.SKIPPED){const d=E("adsskipped");e(this,g).dispatchEvent(d)}e(this,g).parentElement&&e(this,g).parentElement.classList.remove("op-ads--active"),o(this,Te,!1),clearInterval(e(this,at))}break;case google.ima.AdEvent.Type.VOLUME_CHANGED:this._setMediaVolume(this.volume);break;case google.ima.AdEvent.Type.VOLUME_MUTED:if(a.isLinear()){const d=E("volumechange");e(this,g).dispatchEvent(d)}break;case google.ima.AdEvent.Type.ALL_ADS_COMPLETED:if(a.isLinear()&&(o(this,Te,!1),o(this,yt,!0),o(this,at,0),o(this,Ke,!1),o(this,Se,!1),o(this,Ze,null),e(this,g).parentElement&&e(this,g).parentElement.classList.remove("op-ads--active"),this.destroy(),e(this,g).currentTime>=e(this,g).duration)){const d=E("ended");e(this,g).dispatchEvent(d)}break;case google.ima.AdEvent.Type.CLICK:const n=E("pause");e(this,g).dispatchEvent(n);break;case google.ima.AdEvent.Type.AD_BREAK_READY:e(this,R).autoPlayAdBreaks||this.play();break;case google.ima.AdEvent.Type.AD_PROGRESS:const r=t.getAdData(),l=e(this,Ze)?e(this,Ze).getSkipTimeOffset():-1;if(e(this,ne))if(l!==-1){const d=e(this,x).getAdSkippableState(),p=Math.ceil(l-r.currentTime);e(this,ne).classList.remove("hidden"),d?(e(this,ne).textContent=((s=e(this,R).audioSkip)==null?void 0:s.label)||"",e(this,ne).classList.remove("disabled")):(e(this,ne).textContent=((i=e(this,R).audioSkip)==null?void 0:i.remainingLabel.replace("[[secs]]",p.toString()))||"",e(this,ne).classList.add("disabled"))}else e(this,ne).classList.add("hidden");break}if(t.type===google.ima.AdEvent.Type.LOG){const n=t.getAdData();if(n.adError){const r=n.adError.getMessage();console.warn(`Ad warning: Non-fatal error occurred: ${r}`);const l={detail:{data:n.adError,message:r,type:"Ads"}},d=E("playererror",l);e(this,g).dispatchEvent(d)}}else{const n=E(`ads${t.type}`);e(this,g).dispatchEvent(n)}}_error(t){const s=t.getError(),i={detail:{data:s,message:s.toString(),type:"Ads"}},a=E("playererror",i);e(this,g).dispatchEvent(a);const n=[100,101,102,300,301,302,303,400,401,402,403,405,406,407,408,409,410,500,501,502,503,900,901,1005];Array.isArray(e(this,Ae))&&e(this,Ae).length>1&&e(this,Je)<e(this,Ae).length-1?(Ps(this,Je)._++,this.destroy(),o(this,Se,!0),o(this,We,!0),this.load(!0),console.warn(`Ad warning: ${s.toString()}`)):(n.indexOf(s.getErrorCode())>-1?(e(this,x)&&e(this,x).destroy(),console.error(`Ad error: ${s.toString()}`)):console.warn(`Ad warning: ${s.toString()}`),o(this,Ze,null),(e(this,ot)===!0||e(this,rt)===!0||e(this,Se)===!0)&&(o(this,Te,!1),this._resumeMedia()))}_loaded(t){const s=new google.ima.AdsRenderingSettings;s.restoreCustomPlaybackStateOnAdBreakComplete=!1,s.enablePreloading=e(this,R).enablePreloading,o(this,x,t.getAdsManager(e(this,g),s)),this._start(e(this,x)),this.loadPromise=new Promise(i=>{i()})}_start(t){e(this,qe)&&t.isCustomClickTrackingUsed()&&e(this,qe).classList.add("op-ads__click-container--visible"),t.addEventListener(google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED,this._onContentPauseRequested,u),t.addEventListener(google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED,this._onContentResumeRequested,u),o(this,Ye,[google.ima.AdEvent.Type.ALL_ADS_COMPLETED,google.ima.AdEvent.Type.CLICK,google.ima.AdEvent.Type.VIDEO_CLICKED,google.ima.AdEvent.Type.VIDEO_ICON_CLICKED,google.ima.AdEvent.Type.AD_PROGRESS,google.ima.AdEvent.Type.AD_BUFFERING,google.ima.AdEvent.Type.IMPRESSION,google.ima.AdEvent.Type.DURATION_CHANGE,google.ima.AdEvent.Type.USER_CLOSE,google.ima.AdEvent.Type.LINEAR_CHANGED,google.ima.AdEvent.Type.SKIPPABLE_STATE_CHANGED,google.ima.AdEvent.Type.AD_METADATA,google.ima.AdEvent.Type.INTERACTION,google.ima.AdEvent.Type.COMPLETE,google.ima.AdEvent.Type.FIRST_QUARTILE,google.ima.AdEvent.Type.LOADED,google.ima.AdEvent.Type.MIDPOINT,google.ima.AdEvent.Type.PAUSED,google.ima.AdEvent.Type.RESUMED,google.ima.AdEvent.Type.USER_CLOSE,google.ima.AdEvent.Type.STARTED,google.ima.AdEvent.Type.THIRD_QUARTILE,google.ima.AdEvent.Type.SKIPPED,google.ima.AdEvent.Type.VOLUME_CHANGED,google.ima.AdEvent.Type.VOLUME_MUTED,google.ima.AdEvent.Type.LOG]),e(this,R).autoPlayAdBreaks||e(this,Ye).push(google.ima.AdEvent.Type.AD_BREAK_READY);const s=e(this,At).getControls(),i=s?s.events.mouse:{};if(Object.keys(i).forEach(a=>{e(this,ye)&&e(this,ye).addEventListener(a,i[a],u)}),e(this,Ye).forEach(a=>{t.addEventListener(a,this._assign,u)}),e(this,ot)===!0||e(this,rt)===!0||e(this,We)===!0){if(o(this,We,!1),!e(this,Fe)){this._initNotDoneAds();return}t.init(e(this,g).offsetWidth,e(this,g).offsetHeight,e(this,g).parentElement&&e(this,g).parentElement.getAttribute("data-fullscreen")==="true"?google.ima.ViewMode.FULLSCREEN:google.ima.ViewMode.NORMAL),t.start();const a=E("play");e(this,g).dispatchEvent(a)}else e(this,R).enablePreloading===!0&&t.init(e(this,g).offsetWidth,e(this,g).offsetHeight,e(this,g).parentElement&&e(this,g).parentElement.getAttribute("data-fullscreen")==="true"?google.ima.ViewMode.FULLSCREEN:google.ima.ViewMode.NORMAL)}_initNotDoneAds(){e(this,Lt)?(o(this,Fe,!0),e(this,Lt).initialize(),_e||pe?(o(this,Dt,this._contentLoadedAction),e(this,g).addEventListener("loadedmetadata",this._contentLoadedAction,u),e(this,g).load()):this._contentLoadedAction()):(this.load(),this.loadedAd=!1)}_contentEndedListener(){o(this,yt,!0),o(this,Te,!1),o(this,Se,!1),e(this,Oe).contentComplete()}_onContentPauseRequested(){e(this,g).removeEventListener("ended",this._contentEndedListener),o(this,Ft,e(this,ce).currentTime),e(this,Se)?e(this,ce).pause():o(this,Se,!0);const t=E("play");e(this,g).dispatchEvent(t)}_onContentResumeRequested(){if(e(this,g).addEventListener("ended",this._contentEndedListener,u),e(this,g).addEventListener("loadedmetadata",this._loadedMetadataHandler,u),_e||pe)e(this,ce).src=e(this,Zt),e(this,ce).load(),this._prepareMedia(),e(this,g).parentElement&&e(this,g).parentElement.classList.add("op-ads--active");else{const t=E("loadedmetadata");e(this,g).dispatchEvent(t)}}_loadedMetadataHandler(){Array.isArray(e(this,Ae))?(Ps(this,Je)._++,e(this,Je)<=e(this,Ae).length-1?(e(this,x)&&e(this,x).destroy(),e(this,Oe).contentComplete(),o(this,We,!0),o(this,Se,!0),o(this,Fe,!1),this.load(!0)):(e(this,R).autoPlayAdBreaks||this._resetAdsAfterManualBreak(),this._prepareMedia())):e(this,g).seekable.length?e(this,g).seekable.end(0)>e(this,Ft)&&(e(this,R).autoPlayAdBreaks||this._resetAdsAfterManualBreak(),this._prepareMedia()):setTimeout(this._loadedMetadataHandler,100)}_resumeMedia(){if(o(this,at,0),o(this,Ke,!1),o(this,Se,!1),o(this,kt,0),o(this,Xe,0),e(this,g).parentElement&&e(this,g).parentElement.classList.remove("op-ads--active"),e(this,ce).ended){const t=E("ended");e(this,g).dispatchEvent(t)}else try{e(this,ce).play(),setTimeout(()=>{const t=E("play");e(this,g).dispatchEvent(t)},50)}catch(t){console.error(t)}}_requestAds(){o(this,Be,new google.ima.AdsRequest);const t=Array.isArray(e(this,Ae))?e(this,Ae)[e(this,Je)]:e(this,Ae);Us(t)?e(this,Be).adsResponse=t:e(this,Be).adTagUrl=t;const s=e(this,g).parentElement?e(this,g).parentElement.offsetWidth:0,i=e(this,g).parentElement?e(this,g).parentElement.offsetHeight:0;e(this,Be).linearAdSlotWidth=s,e(this,Be).linearAdSlotHeight=i,e(this,Be).nonLinearAdSlotWidth=s,e(this,Be).nonLinearAdSlotHeight=i/3,e(this,Be).setAdWillAutoPlay(e(this,ot)),e(this,Be).setAdWillPlayMuted(e(this,rt)),e(this,Oe).requestAds(e(this,Be))}_contentLoadedAction(){e(this,Dt)&&(e(this,g).removeEventListener("loadedmetadata",e(this,Dt)),o(this,Dt,null)),this._requestAds()}_resetAdsAfterManualBreak(){e(this,x)&&e(this,x).destroy(),e(this,Oe).contentComplete(),o(this,Fe,!1),o(this,We,!0)}_prepareMedia(){e(this,ce).currentTime=e(this,Ft),e(this,g).removeEventListener("loadedmetadata",this._loadedMetadataHandler),this._resumeMedia()}_setMediaVolume(t){e(this,ce).volume=t,e(this,ce).muted=t===0}_handleClickInContainer(){if(e(this,ce).paused){const t=E("paused");e(this,g).dispatchEvent(t),this.pause()}}_handleResizeAds(){this.resizeAds()}_handleSkipAds(){e(this,x).skip()}}yt=new WeakMap,Fe=new WeakMap,Te=new WeakMap,Se=new WeakMap,at=new WeakMap,$t=new WeakMap,Ke=new WeakMap,kt=new WeakMap,Xe=new WeakMap,x=new WeakMap,At=new WeakMap,ce=new WeakMap,g=new WeakMap,Ye=new WeakMap,Ae=new WeakMap,Ls=new WeakMap,Oe=new WeakMap,ye=new WeakMap,qe=new WeakMap,ne=new WeakMap,Lt=new WeakMap,Be=new WeakMap,ot=new WeakMap,rt=new WeakMap,We=new WeakMap,R=new WeakMap,Je=new WeakMap,Jt=new WeakMap,Dt=new WeakMap,Ft=new WeakMap,Zt=new WeakMap,ws=new WeakMap,Ze=new WeakMap;const Rs=class tt{constructor(t,s){h(this,wt),h(this,Z),h(this,et),h(this,_),h(this,lt),h(this,z),h(this,ue),h(this,ht),h(this,Mt),h(this,Ct),h(this,dt),h(this,Bt),h(this,T),h(this,ct),h(this,Tt),h(this,ut);var i;this.proxy=null,o(this,et,""),o(this,ue,{}),o(this,ht,!1),o(this,Ct,!1),o(this,dt,!1),o(this,Bt,!1),o(this,ct,[]),o(this,ut,{controls:{alwaysVisible:!1,layers:{left:["play","time","volume"],middle:["progress"],right:["captions","settings","fullscreen"]}},defaultLevel:void 0,detachMenus:!1,forceNative:!1,height:0,hidePlayBtnTimer:350,labels:{auto:"Auto",captions:"CC/Subtitles",click:"Click to unmute",fullscreen:"Fullscreen",lang:{en:"English"},levels:"Quality Levels",live:"Live Broadcast",mediaLevels:"Change Quality",mute:"Mute",off:"Off",pause:"Pause",play:"Play",progressRail:"Time Rail",progressSlider:"Time Slider",settings:"Player Settings",speed:"Speed",speedNormal:"Normal",tap:"Tap to unmute",toggleCaptions:"Toggle Captions",unmute:"Unmute",volume:"Volume",volumeControl:"Volume Control",volumeSlider:"Volume Slider"},live:{showLabel:!0,showProgress:!1},media:{pauseOnClick:!1},mode:"responsive",onError:a=>console.error(a),pauseOthers:!0,progress:{allowRewind:!0,allowSkip:!0,duration:0,showCurrentTimeOnly:!1},showLoaderOnInit:!1,startTime:0,startVolume:1,step:0,useDeviceVolume:!0,width:0}),o(this,_,t instanceof HTMLMediaElement?t:document.getElementById(t)),e(this,_)&&(o(this,ht,e(this,_).autoplay||!1),typeof s!="string"&&!Array.isArray(s)&&this._mergeOptions(s),e(this,_).volume=e(this,T).startVolume||1,e(this,T).ads&&e(this,T).ads.src&&o(this,lt,e(this,T).ads.src),(((i=e(this,T))==null?void 0:i.startTime)||0)>0&&(e(this,_).currentTime=e(this,T).startTime||0),o(this,Mt,e(this,_).volume)),this._autoplay=this._autoplay.bind(this),this._enableKeyBindings=this._enableKeyBindings.bind(this)}static init(){tt.instances={};const t=document.querySelectorAll("video.op-player, audio.op-player");for(let s=0,i=t.length;s<i;s++){const a=t[s],n=a.getAttribute("data-op-settings"),r=n?JSON.parse(n):{};new tt(a,r).init()}}static addMedia(t,s,i,a){tt.customMedia.media[s]=a,tt.customMedia.optionsKey[s]=t,tt.customMedia.rules.push(i)}async init(){this._isValid()&&(this._wrapInstance(),await this._prepareMedia(),this._createPlayButton(),this._createUID(),this._createControls(),this._setEvents(),tt.instances[this.id]=this)}async load(){return e(this,z)?(e(this,z).loaded=!1,this.isMedia()?e(this,z).load():void 0):(await this._prepareMedia(),e(this,z).load())}async play(){return e(this,z).loaded||(await e(this,z).load(),e(this,z).loaded=!0),e(this,Z)?(e(this,Z).playRequested=!0,await e(this,Z).loadPromise,e(this,Z).play()):e(this,z).play()}pause(){e(this,Z)?e(this,Z).pause():e(this,z).pause()}stop(){this.pause(),e(this,z)&&(e(this,z).currentTime=0,this.src=[{src:"",type:"video/mp4"}])}destroy(){var t;e(this,Z)&&(e(this,Z).pause(),e(this,Z).destroy()),e(this,Tt)&&e(this,Tt).destroy();const s=e(this,_);e(this,z)&&e(this,z).destroy(),Object.keys(e(this,ue)).forEach(n=>{s.removeEventListener(n,e(this,ue)[n])}),this.getContainer().removeEventListener("keydown",this._enableKeyBindings),e(this,ht)&&!e(this,Bt)&&Pe(e(this,_))&&s.removeEventListener("canplay",this._autoplay),e(this,wt)&&e(this,wt).destroy(),Pe(e(this,_))&&(this.playBtn&&this.playBtn.remove(),this.loader&&this.loader.remove()),(t=e(this,T))!=null&&t.onError&&e(this,_).removeEventListener("playererror",e(this,T).onError),s.controls=!0,s.setAttribute("id",e(this,et)),s.removeAttribute("op-live__enabled"),s.removeAttribute("op-dvr__enabled");const i=e(this,T).mode==="fit"&&!me(s)?s.closest(".op-player__fit--wrapper"):s.parentElement;i&&i.parentNode&&i.parentNode.replaceChild(s,i),delete tt.instances[e(this,et)];const a=E("playerdestroyed");s.dispatchEvent(a)}getContainer(){return e(this,_).parentElement||e(this,_)}getControls(){return e(this,wt)}getCustomControls(){return e(this,ct)}getElement(){return e(this,_)}getEvents(){return e(this,ue)}getOptions(){return e(this,T)}activeElement(){return e(this,Z)&&e(this,Z).started()?e(this,Z):e(this,z)}isMedia(){return this.activeElement()instanceof ss}isAd(){return this.activeElement()instanceof Os}getMedia(){return e(this,z)}getAd(){return e(this,Z)}addCaptions(t){if(t.default){const n=e(this,_).querySelectorAll("track");for(let r=0,l=n.length;r<l;r++)n[r].default=!1}const s=e(this,_);let i=s.querySelector(`track[srclang="${t.srclang}"][kind="${t.kind}"]`);i?(i.src=t.src,i.label=t.label,i.default=t.default||!1):(i=document.createElement("track"),i.srclang=t.srclang,i.src=t.src,i.kind=t.kind,i.label=t.label,i.default=t.default||!1,s.appendChild(i));const a=E("controlschanged");s.dispatchEvent(a)}addControl(t){t.custom=!0,t.type="button",e(this,ct).push(t);const s=E("controlschanged");e(this,_).dispatchEvent(s)}addElement(t){t.custom=!0,e(this,ct).push(t);const s=E("controlschanged");e(this,_).dispatchEvent(s)}removeControl(t){e(this,ct).forEach((i,a)=>{i.id===t&&e(this,ct).splice(a,1)});const s=E("controlschanged");e(this,_).dispatchEvent(s)}async _prepareMedia(){var t;try{(t=e(this,T))!=null&&t.onError&&e(this,_).addEventListener("playererror",e(this,T).onError,u),e(this,ht)&&Pe(e(this,_))&&e(this,_).addEventListener("canplay",this._autoplay,u),o(this,z,new ss(e(this,_),e(this,T),e(this,ht),tt.customMedia));const s=e(this,_).getAttribute("preload");if((e(this,lt)||!s||s!=="none")&&(await e(this,z).load(),e(this,z).loaded=!0),!e(this,ht)&&e(this,lt)){const i=e(this,T)&&e(this,T).ads?e(this,T).ads:void 0;o(this,Z,new Os(this,e(this,lt),!1,!1,i))}}catch(s){console.error(s)}}enableDefaultPlayer(){let t=!0,s=0;this.proxy&&!this.proxy.paused&&(t=!1,s=this.proxy.currentTime,this.proxy.pause()),this.proxy=this,this.getElement().addEventListener("loadedmetadata",()=>{this.getMedia().currentTime=s,t||this.play()})}async loadAd(t){try{if(this.isAd())this.getAd().destroy(),this.getAd().src=t,this.getAd().loadedAd=!1,this.getAd().load();else{const s=e(this,T)&&e(this,T).ads?e(this,T).ads:void 0,i=!this.activeElement().paused||e(this,Ct);o(this,Z,new Os(this,t,i,e(this,dt),s))}}catch(s){console.error(s)}}set src(t){e(this,z)instanceof ss?(e(this,z).mediaFiles=[],e(this,z).src=t):typeof t=="string"?e(this,_).src=t:Array.isArray(t)?t.forEach(s=>{const i=document.createElement("source");i.src=s.src,i.type=s.type||ts(s.src,e(this,_)),e(this,_).appendChild(i)}):typeof t=="object"&&(e(this,_).src=t.src)}get src(){return e(this,z).src}get id(){return e(this,et)}_isValid(){const t=e(this,_);return!(!(t instanceof HTMLElement)||!me(t)&&!Pe(t)||!t.classList.contains("op-player__media"))}_wrapInstance(){const t=document.createElement("div");t.className="op-player op-player__keyboard--inactive",t.className+=me(e(this,_))?" op-player__audio":" op-player__video",t.tabIndex=0,e(this,_).classList.remove("op-player"),e(this,_).parentElement&&e(this,_).parentElement.insertBefore(t,e(this,_)),t.appendChild(e(this,_));const s=document.createElement("div");if(s.className="op-status",s.innerHTML="<span></span>",s.tabIndex=-1,s.setAttribute("aria-hidden","true"),Pe(e(this,_))&&e(this,_).parentElement&&e(this,_).parentElement.insertBefore(s,e(this,_)),t.addEventListener("keydown",()=>{t.classList.contains("op-player__keyboard--inactive")&&t.classList.remove("op-player__keyboard--inactive")},u),t.addEventListener("click",()=>{t.classList.contains("op-player__keyboard--inactive")||t.classList.add("op-player__keyboard--inactive")},u),e(this,T).mode==="fill"&&!me(e(this,_))&&!jt)this.getContainer().classList.add("op-player__full");else if(e(this,T).mode==="fit"&&!me(e(this,_))){const i=this.getContainer();if(i.parentElement){const a=document.createElement("div");a.className="op-player__fit--wrapper",a.tabIndex=0,i.parentElement.insertBefore(a,i),a.appendChild(i),i.classList.add("op-player__fit")}}else{let i="";if(e(this,T).width){const a=typeof e(this,T).width=="number"?`${e(this,T).width}px`:e(this,T).width;i+=`width: ${a} !important;`}if(e(this,T).height){const a=typeof e(this,T).height=="number"?`${e(this,T).height}px`:e(this,T).height;i+=`height: ${a} !important;`}i&&t.setAttribute("style",i)}}_createControls(){jt&&Pe(e(this,_))&&this.getContainer().classList.add("op-player__ios--iphone"),o(this,wt,new si(this)),e(this,wt).create()}_createUID(){e(this,_).id?(o(this,et,e(this,_).id),e(this,_).removeAttribute("id")):o(this,et,`op_${crypto.getRandomValues(new Uint32Array(1))[0].toString(36).substring(2,9)}`),e(this,_).parentElement&&(e(this,_).parentElement.id=e(this,et))}_createPlayButton(){var t,s;me(e(this,_))||(this.playBtn=document.createElement("button"),this.playBtn.className="op-player__play",this.playBtn.tabIndex=0,this.playBtn.title=((t=e(this,T).labels)==null?void 0:t.play)||"",this.playBtn.innerHTML=`<span>${((s=e(this,T).labels)==null?void 0:s.play)||""}</span>`,this.playBtn.setAttribute("aria-pressed","false"),this.playBtn.setAttribute("aria-hidden","false"),this.loader=document.createElement("span"),this.loader.className="op-player__loader",this.loader.tabIndex=-1,this.loader.setAttribute("aria-hidden","true"),e(this,_).parentElement&&(e(this,_).parentElement.insertBefore(this.loader,e(this,_)),e(this,_).parentElement.insertBefore(this.playBtn,e(this,_))),this.playBtn.addEventListener("click",()=>{e(this,Z)&&(e(this,Z).playRequested=this.activeElement().paused),this.activeElement().paused?this.activeElement().play():this.activeElement().pause()},u))}_setEvents(){if(Pe(e(this,_))){e(this,ue).loadedmetadata=()=>{const s=this.activeElement();e(this,T).showLoaderOnInit&&!_e&&!pe?(this.loader.setAttribute("aria-hidden","false"),this.playBtn.setAttribute("aria-hidden","true")):(this.loader.setAttribute("aria-hidden","true"),this.playBtn.setAttribute("aria-hidden","false")),s.paused&&(this.playBtn.classList.remove("op-player__play--paused"),this.playBtn.setAttribute("aria-pressed","false"))},e(this,ue).waiting=()=>{this.playBtn.setAttribute("aria-hidden","true"),this.loader.setAttribute("aria-hidden","false")},e(this,ue).seeking=()=>{const s=this.activeElement();this.playBtn.setAttribute("aria-hidden","true"),this.loader.setAttribute("aria-hidden",s instanceof ss?"false":"true")},e(this,ue).seeked=()=>{const s=this.activeElement();Math.round(s.currentTime)===0?(this.playBtn.setAttribute("aria-hidden","true"),this.loader.setAttribute("aria-hidden","false")):(this.playBtn.setAttribute("aria-hidden",s instanceof ss?"false":"true"),this.loader.setAttribute("aria-hidden","true"))},e(this,ue).play=()=>{var s;this.playBtn.classList.add("op-player__play--paused"),this.playBtn.title=((s=e(this,T).labels)==null?void 0:s.pause)||"",this.loader.setAttribute("aria-hidden","true"),e(this,T).showLoaderOnInit?this.playBtn.setAttribute("aria-hidden","true"):setTimeout(()=>{this.playBtn.setAttribute("aria-hidden","true")},e(this,T).hidePlayBtnTimer)},e(this,ue).playing=()=>{this.loader.setAttribute("aria-hidden","true"),this.playBtn.setAttribute("aria-hidden","true")},e(this,ue).pause=()=>{var s;const i=this.activeElement();this.playBtn.classList.remove("op-player__play--paused"),this.playBtn.title=((s=e(this,T).labels)==null?void 0:s.play)||"",e(this,T).showLoaderOnInit&&Math.round(i.currentTime)===0?(this.playBtn.setAttribute("aria-hidden","true"),this.loader.setAttribute("aria-hidden","false")):(this.playBtn.setAttribute("aria-hidden","false"),this.loader.setAttribute("aria-hidden","true"))},e(this,ue).ended=()=>{this.loader.setAttribute("aria-hidden","true"),this.playBtn.setAttribute("aria-hidden","true")};let t=!1;e(this,ue).timeupdate=()=>{if(e(this,_).loop&&this.isMedia()&&e(this,Z)){const s=this.getMedia(),i=s.duration-s.currentTime;if(i>0&&i<=.25&&!t){t=!0;const a=E("ended");e(this,_).dispatchEvent(a)}else i===0&&(t=!1)}}}Object.keys(e(this,ue)).forEach(t=>{e(this,_).addEventListener(t,e(this,ue)[t],u)}),this.getContainer().addEventListener("keydown",this._enableKeyBindings,u)}_autoplay(){e(this,Bt)||(o(this,Bt,!0),e(this,_).removeEventListener("canplay",this._autoplay),Xs(e(this,_),e(this,Mt),t=>{o(this,Ct,t)},t=>{o(this,dt,t)},()=>{var t,s;if(e(this,dt)){this.activeElement().muted=!0,this.activeElement().volume=0;const i=E("volumechange");e(this,_).dispatchEvent(i);const a=document.createElement("div"),n=_e||pe?(t=e(this,T).labels)==null?void 0:t.tap:(s=e(this,T).labels)==null?void 0:s.click;a.className="op-player__unmute",a.innerHTML=`<span>${n}</span>`,a.tabIndex=0,a.addEventListener("click",()=>{this.activeElement().muted=!1,this.activeElement().volume=e(this,Mt);const l=E("volumechange");e(this,_).dispatchEvent(l),a.remove()},u);const r=this.getContainer();r.insertBefore(a,r.firstChild)}else this.activeElement().muted=e(this,_).muted,this.activeElement().volume=e(this,Mt);if(e(this,lt)){const i=e(this,T)&&e(this,T).ads?e(this,T).ads:void 0;o(this,Z,new Os(this,e(this,lt),e(this,Ct),e(this,dt),i))}else(e(this,Ct)||e(this,dt))&&this.play()}))}_mergeOptions(t){const s={...t||{}};if(o(this,T,{...e(this,ut),...s}),Object.keys(e(this,ut)).filter(a=>a!=="labels"&&typeof e(this,ut)[a]=="object").forEach(a=>{const n=s[a]||{};n&&Object.keys(n).length&&(e(this,T)[a]={...e(this,ut)[a],...n})}),s.labels){const a=s.labels?Object.keys(s.labels):[];let n={};a.forEach(r=>{const l=s.labels?s.labels[r]:null;l&&typeof l=="object"&&r==="lang"?Object.keys(l).forEach(d=>{const p=l?l[d]:null;p&&(n={...n,lang:{...n.lang,[d]:Ie(p)}})}):l&&(n={...n,[r]:Ie(l)})}),e(this,T).labels={...e(this,ut).labels,...n}}}_enableKeyBindings(t){var s,i;const a=t.which||t.keyCode||0,n=this.activeElement(),r=this.isAd(),l=(s=document?.activeElement)==null?void 0:s.classList.contains("op-player");switch(a){case 13:case 32:case 75:(l&&(a===13||a===32)||a===75)&&(n.paused?n.play():n.pause()),t.preventDefault(),t.stopPropagation();break;case 35:!r&&n.duration!==1/0&&(n.currentTime=n.duration,t.preventDefault(),t.stopPropagation());break;case 36:r||(n.currentTime=0,t.preventDefault(),t.stopPropagation());break;case 37:case 39:case 74:case 76:if(!r&&n.duration!==1/0){let p=5;const A=this.getOptions().step;A?p=a===74||a===76?A*2:A:(a===74||a===76)&&(p=10);const m=n.duration!==1/0?p:((i=this.getOptions().progress)==null?void 0:i.duration)||0;n.currentTime+=a===37||a===74?m*-1:m,n.currentTime<0?n.currentTime=0:n.currentTime>=n.duration&&(n.currentTime=n.duration),t.preventDefault(),t.stopPropagation()}break;case 38:case 40:const d=a===38?Math.min(n.volume+.1,1):Math.max(n.volume-.1,0);n.volume=d,n.muted=!(d>0),t.preventDefault(),t.stopPropagation();break;case 70:Pe(e(this,_))&&!t.ctrlKey&&(o(this,Tt,new js(this,"","")),typeof e(this,Tt).fullScreenEnabled<"u"&&(e(this,Tt).toggleFullscreen(),t.preventDefault(),t.stopPropagation()));break;case 77:n.muted=!n.muted,n.muted?n.volume=0:n.volume=e(this,Mt),t.preventDefault(),t.stopPropagation();break;case 188:case 190:if(!r&&t.shiftKey){const p=n;p.playbackRate=a===188?Math.max(p.playbackRate-.25,.25):Math.min(p.playbackRate+.25,2);const A=this.getContainer().querySelector(".op-status>span");A&&(A.textContent=`${p.playbackRate}x`,A.parentElement&&A.parentElement.setAttribute("aria-hidden","false"),setTimeout(()=>{A.parentElement&&A.parentElement.setAttribute("aria-hidden","true")},500));const m=E("controlschanged");dispatchEvent(m),t.preventDefault(),t.stopPropagation()}else!r&&n.paused&&(n.currentTime+=1/25*(a===188?-1:1),t.preventDefault(),t.stopPropagation());break}}};wt=new WeakMap,Z=new WeakMap,et=new WeakMap,_=new WeakMap,lt=new WeakMap,z=new WeakMap,ue=new WeakMap,ht=new WeakMap,Mt=new WeakMap,Ct=new WeakMap,dt=new WeakMap,Bt=new WeakMap,T=new WeakMap,ct=new WeakMap,Tt=new WeakMap,ut=new WeakMap,Rs.instances={},Rs.customMedia={media:{},optionsKey:{},rules:[]};let Ws=Rs;const Ns=Ws;typeof window<"u"&&(window.OpenPlayer=Ws,window.OpenPlayerJS=Ws,Ws.init());export{Ns as default};
//# sourceMappingURL=openplayer.es.js.map
