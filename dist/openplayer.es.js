var Ds=(g,t,s)=>{if(!t.has(g))throw TypeError("Cannot "+s)},e=(g,t,s)=>(Ds(g,t,"read from private field"),s?s.call(g):t.get(g)),h=(g,t,s)=>{if(t.has(g))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(g):t.set(g,s)},o=(g,t,s,i)=>(Ds(g,t,"write to private field"),i?i.call(g,s):t.set(g,s),s),Rs=(g,t,s,i)=>({set _(n){o(g,t,n,s)},get _(){return e(g,t,i)}}),Z,F,be,j,Y,Me,qt,mt,vt,Vt,Kt,te,Ce,ae,zt,os,rs,ft,ls,hs,I,se,G,$,gt,it,Ut,ds,x,C,H,cs,us,w,S,E,Ke,ye,Ee,W,Ot,ps,ms,q,_t,Ae,D,z,bt,vs,fs,Q,fe,$e,oe,Ge,De,gs,_s,U,V,re,Qe,ge,le,nt,Gt,bs,Qt,yt,he,b,Te,ys,Es,X,Se,ks,ee,Fe,As,O,ie,Xt,Yt,Wt,Ls,Jt,Pt,ws,It,Rt,Nt,P,k,de,xt,Xe,Zt,at,Et,$t,kt,Be,Oe,We,ot,Dt,ze,At,Ye,R,Lt,ce,f,Je,Le,Ms,Pe,ke,Ve,ne,wt,je,rt,lt,Ie,N,Ze,es,Ft,Bt,ts,Cs,et,Mt,J,tt,_,ht,K,ue,dt,Ct,Tt,ct,jt,T,ut,St,pt;const we=typeof window<"u"?window.navigator:null,Ue=we?we.userAgent.toLowerCase():null,Ht=Ue?/iphone/i.test(Ue)&&!window.MSStream:!1,_e=Ue?/ipad|iphone|ipod/i.test(Ue)&&!window.MSStream:!1,pe=Ue?/android/i.test(Ue):!1,Vs=Ue?/chrome/i.test(Ue):!1,Ks=Ue?/safari/i.test(Ue)&&!Vs:!1,Fs=typeof window<"u"?"MediaSource"in window:!1,zs=()=>{if(typeof window>"u")return!1;const g=window.MediaSource||window.WebKitMediaSource,t=window.SourceBuffer||window.WebKitSourceBuffer,s=g&&typeof g.isTypeSupported=="function"&&g.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),i=!t||t.prototype&&typeof t.prototype.appendBuffer=="function"&&typeof t.prototype.remove=="function";return!!s&&!!i&&!Ks},Bs=120,p={passive:!1};function Re(g){return g.tagName.toLowerCase()==="video"}function me(g){return g.tagName.toLowerCase()==="audio"}function Ts(g){return new Promise((t,s)=>{const i=document.createElement("script");i.src=g,i.async=!0,i.onload=()=>{i.remove(),t()},i.onerror=()=>{i.remove(),s(new Error(`${g} could not be loaded`))},document.head&&document.head.appendChild(i)})}function ss(g){const t=g.getBoundingClientRect();return{left:t.left+(window.pageXOffset||document.documentElement.scrollLeft),top:t.top+(window.pageYOffset||document.documentElement.scrollTop)}}function Ne(g,t=!0){const n=new DOMParser().parseFromString(g,"text/html").body||document.createElement("body"),a=n.querySelectorAll("script");for(let r=0,d=a.length;r<d;r++)a[r].remove();const l=r=>{const d=r.children;for(let u=0,A=d.length;u<A;u++){const m=d[u],{attributes:c}=m;for(let v=0,L=c.length;v<L;v++){const{name:M,value:B}=c[v],ve=B.replace(/\s+/g,"").toLowerCase();["src","href","xlink:href"].includes(M)&&(ve.includes("javascript:")||ve.includes("data:"))&&m.removeAttribute(M),M.startsWith("on")&&m.removeAttribute(M)}l(m)}};return l(n),t?(n.textContent||"").replace(/\s{2,}/g,""):n.innerHTML}function Us(g){let t;if(typeof DOMParser<"u")t=s=>new DOMParser().parseFromString(s,"text/xml");else return!1;try{if(t(g).getElementsByTagName("parsererror").length>0)return!1}catch{return!1}return!0}function y(g,t){let s={};return t&&t.detail&&(s={detail:t.detail}),new CustomEvent(g,s)}class Gs{constructor(t,s,i){h(this,Z,void 0),h(this,F,void 0),h(this,be,void 0),h(this,j,void 0),h(this,Y,{button:{},global:{},media:{}}),h(this,Me,void 0),h(this,qt,void 0),h(this,mt,void 0),h(this,vt,"off"),h(this,Vt,void 0),h(this,Kt,void 0),o(this,Z,t),o(this,Vt,s),o(this,Kt,i),this._formatMenuItems=this._formatMenuItems.bind(this),this._setDefaultTrack=this._setDefaultTrack.bind(this),this._showCaptions=this._showCaptions.bind(this),this._hideCaptions=this._hideCaptions.bind(this)}create(){var t;const{textTracks:s}=e(this,Z).getElement(),{labels:i,detachMenus:n}=e(this,Z).getOptions();if(o(this,Me,Object.keys(s).map(r=>s[Number(r)]).filter(r=>["subtitles","captions"].includes(r.kind)&&r.language)),o(this,qt,!!e(this,Me).length),!e(this,qt))return;o(this,F,document.createElement("button")),e(this,F).className=`op-controls__captions op-control__${e(this,Vt)}`,e(this,F).tabIndex=0,e(this,F).title=i?.toggleCaptions||"",e(this,F).setAttribute("aria-controls",e(this,Z).id),e(this,F).setAttribute("aria-pressed","false"),e(this,F).setAttribute("aria-label",i?.toggleCaptions||""),e(this,F).setAttribute("data-active-captions","off"),o(this,be,document.createElement("div")),e(this,be).className="op-captions";const a=e(this,Z).getContainer();if(a.insertBefore(e(this,be),a.firstChild),n){e(this,F).classList.add("op-control--no-hover"),o(this,j,document.createElement("div")),e(this,j).className="op-settings op-captions__menu",e(this,j).setAttribute("aria-hidden","true"),e(this,j).innerHTML=`<div class="op-settings__menu" role="menu" id="menu-item-captions">
                <div class="op-settings__submenu-item" tabindex="0" role="menuitemradio" aria-checked="${e(this,vt)==="off"?"true":"false"}">
                    <div class="op-settings__submenu-label op-subtitles__option" data-value="captions-off">${i?.off}</div>
                </div>
            </div>`;const r=document.createElement("div");r.className=`op-controls__container op-control__${e(this,Vt)}`,r.append(e(this,F),e(this,j)),e(this,Z).getControls().getLayer(e(this,Kt)).append(r);for(const d of e(this,Me)){const u=document.createElement("div"),A=((t=i?.lang)==null?void 0:t[d.language])||null;u.className="op-settings__submenu-item",u.tabIndex=0,u.setAttribute("role","menuitemradio"),u.setAttribute("aria-checked",e(this,vt)===d.language?"true":"false"),u.innerHTML=`<div class="op-settings__submenu-label op-subtitles__option"
                    data-value="captions-${d.language}">
                    ${A||d.label}
                </div>`,e(this,j).append(u)}}else e(this,Z).getControls().getLayer(e(this,Kt)).append(e(this,F));e(this,Y).button.click=r=>{var d;const u=r.target;if(n){const A=e(this,Z).getContainer().querySelectorAll(".op-settings");for(const m of Array.from(A))m!==e(this,j)&&m.setAttribute("aria-hidden","true");e(this,j).getAttribute("aria-hidden")==="true"?e(this,j).setAttribute("aria-hidden","false"):e(this,j).setAttribute("aria-hidden","true")}else{u.setAttribute("aria-pressed","true"),u.classList.contains("op-controls__captions--on")?(u.classList.remove("op-controls__captions--on"),u.setAttribute("data-active-captions","off"),this._hideCaptions()):(u.classList.add("op-controls__captions--on"),u.setAttribute("data-active-captions",((d=e(this,mt))==null?void 0:d.language)||"off"),this._showCaptions());for(const A of e(this,Me))A.mode=u.getAttribute("data-active-captions")===A.language?"showing":"hidden"}},e(this,Y).button.mouseover=()=>{if(!_e&&!pe&&n){const r=e(this,Z).getContainer().querySelectorAll(".op-settings");for(let d=0,u=r.length;d<u;++d)r[d]!==e(this,j)&&r[d].setAttribute("aria-hidden","true");e(this,j).getAttribute("aria-hidden")==="true"&&e(this,j).setAttribute("aria-hidden","false")}},e(this,Y).button.mouseout=()=>{if(!_e&&!pe&&n){const r=e(this,Z).getContainer().querySelectorAll(".op-settings");for(let d=0,u=r.length;d<u;++d)r[d].setAttribute("aria-hidden","true");e(this,j).getAttribute("aria-hidden")==="false"&&e(this,j).setAttribute("aria-hidden","true")}},e(this,F).addEventListener("click",e(this,Y).button.click,p),e(this,Y).global.click=r=>{const d=r.target;if(d.closest(`#${e(this,Z).id}`)&&d.classList.contains("op-subtitles__option")){const u=d.getAttribute("data-value").replace("captions-","");this._hideCaptions(),u==="off"&&o(this,mt,void 0);for(const m of e(this,Me))m.mode=m.language===u?"showing":"hidden",m.language===u&&(o(this,mt,m),this._showCaptions());if(n){e(this,F).classList.contains("op-controls__captions--on")?(e(this,F).classList.remove("op-controls__captions--on"),e(this,F).setAttribute("data-active-captions","off")):(e(this,F).classList.add("op-controls__captions--on"),e(this,F).setAttribute("data-active-captions",u));const m=e(this,j).querySelectorAll(".op-settings__submenu-item");for(const c of Array.from(m))c.setAttribute("aria-checked","false");d.parentElement.setAttribute("aria-checked","true"),e(this,j).setAttribute("aria-hidden","false")}else e(this,F).setAttribute("data-active-captions",u);const A=y("captionschanged");e(this,Z).getElement().dispatchEvent(A)}},e(this,Y).global.cuechange=r=>{var d;this._hideCaptions();const u=r.target;if(!(u.mode!=="showing"||e(this,F).getAttribute("data-active-captions")==="off"))if(u.activeCues&&((d=u.activeCues)==null?void 0:d.length)>0)this._showCaptions();else for(;e(this,be).lastChild;)e(this,be).removeChild(e(this,be).lastChild)},n&&(e(this,F).addEventListener("mouseover",e(this,Y).button.mouseover,p),e(this,j).addEventListener("mouseover",e(this,Y).button.mouseover,p),e(this,j).addEventListener("mouseout",e(this,Y).button.mouseout,p),e(this,Z).getElement().addEventListener("controlshidden",e(this,Y).button.mouseout,p)),document.addEventListener("click",e(this,Y).global.click,p);for(const r of e(this,Me))r.mode=r.mode!=="showing"?"hidden":r.mode,r.addEventListener("cuechange",e(this,Y).global.cuechange,p);const l=e(this,Z).getElement().querySelector('track:is([kind="subtitles"],[kind="captions"])[default]');if(l){const r=e(this,Me).find(d=>d.language===l.srclang);r&&this._setDefaultTrack(r)}}destroy(){const{detachMenus:t}=e(this,Z).getOptions();if(e(this,qt)){for(const s of e(this,Me))s.removeEventListener("cuechange",e(this,Y).global.cuechange);document.removeEventListener("click",e(this,Y).global.click),e(this,F).removeEventListener("click",e(this,Y).button.click),t&&(e(this,F).removeEventListener("mouseover",e(this,Y).button.mouseover),e(this,j).removeEventListener("mouseover",e(this,Y).button.mouseover),e(this,j).removeEventListener("mouseout",e(this,Y).button.mouseout),e(this,Z).getElement().removeEventListener("controlshidden",e(this,Y).button.mouseout),e(this,j).remove()),e(this,F).remove()}}addSettings(){const{detachMenus:t,labels:s}=e(this,Z).getOptions();if(t||e(this,Me).length<=1)return{};const i=this._formatMenuItems();return i.length>2?{className:"op-subtitles__option",default:e(this,vt)||"off",key:"captions",name:s?.captions||"",subitems:i}:{}}_formatMenuItems(){const{labels:t,detachMenus:s}=e(this,Z).getOptions();if(e(this,Me).length<=1&&!s)return[];let i=[{key:"off",label:t?.off||""}];for(const n of e(this,Me)){const a=t?.lang?t.lang[n.language]:null;i=i.filter(l=>l.key!==n.language),i.push({key:n.language,label:a||n.label})}return i}_setDefaultTrack(t){var s,i;t.mode="showing",o(this,vt,t.language),e(this,F).setAttribute("data-active-captions",e(this,vt)),e(this,F).classList.add("op-controls__captions--on"),e(this,be).classList.add("op-captions--on"),o(this,mt,t);const n=document.querySelectorAll(".op-settings__submenu-item")||[];for(const a of Array.from(n))a.setAttribute("aria-checked","false");(i=(s=document.querySelector(`.op-subtitles__option[data-value="captions-${t.language}"]`))==null?void 0:s.parentElement)==null||i.setAttribute("aria-checked","true")}_showCaptions(){var t;for(const s of Array.from(((t=e(this,mt))==null?void 0:t.activeCues)||[])){const i=s?.text||"";if(i&&e(this,be)){const n=document.createElement("span");n.innerHTML=i,e(this,be).prepend(n),e(this,be).classList.add("op-captions--on")}else this._hideCaptions()}}_hideCaptions(){for(var t;(t=e(this,be))!=null&&t.lastChild;)e(this,be).removeChild(e(this,be).lastChild)}}Z=new WeakMap,F=new WeakMap,be=new WeakMap,j=new WeakMap,Y=new WeakMap,Me=new WeakMap,qt=new WeakMap,mt=new WeakMap,vt=new WeakMap,Vt=new WeakMap,Kt=new WeakMap;class js{constructor(t,s,i){h(this,te,void 0),h(this,Ce,void 0),h(this,ae,void 0),h(this,zt,[]),h(this,os,0),h(this,rs,0),h(this,ft,void 0),h(this,ls,void 0),h(this,hs,void 0),o(this,te,t),o(this,ls,s),o(this,hs,i),o(this,Ce,document.body.classList.contains("op-fullscreen__on"));const n=document;this.fullScreenEnabled=!!(n.fullscreenEnabled||n.mozFullScreenEnabled||n.msFullscreenEnabled||n.webkitSupportsFullscreen||n.webkitFullscreenEnabled||document.createElement("video").webkitRequestFullScreen),this._enterSpaceKeyEvent=this._enterSpaceKeyEvent.bind(this),this._resize=this._resize.bind(this),this._fullscreenChange=this._fullscreenChange.bind(this),this._setFullscreen=this._setFullscreen.bind(this),this._unsetFullscreen=this._unsetFullscreen.bind(this),o(this,zt,["fullscreenchange","mozfullscreenchange","webkitfullscreenchange","msfullscreenchange"]),e(this,zt).forEach(a=>{document.addEventListener(a,this._fullscreenChange,p)}),this._setFullscreenData(!1),e(this,te).getContainer().addEventListener("keydown",this._enterSpaceKeyEvent,p),Ht&&(e(this,te).getElement().addEventListener("webkitbeginfullscreen",this._setFullscreen,p),e(this,te).getElement().addEventListener("webkitendfullscreen",this._unsetFullscreen,p))}create(){const{labels:t}=e(this,te).getOptions();o(this,ae,document.createElement("button")),e(this,ae).type="button",e(this,ae).className=`op-controls__fullscreen op-control__${e(this,ls)}`,e(this,ae).tabIndex=0,e(this,ae).title=t?.fullscreen||"",e(this,ae).setAttribute("aria-controls",e(this,te).id),e(this,ae).setAttribute("aria-pressed","false"),e(this,ae).setAttribute("aria-label",t?.fullscreen||""),o(this,ft,()=>{e(this,ae).setAttribute("aria-pressed","true"),this.toggleFullscreen()}),o(this,ft,e(this,ft).bind(this)),e(this,ae).addEventListener("click",e(this,ft),p),e(this,te).getControls().getLayer(e(this,hs)).appendChild(e(this,ae))}destroy(){e(this,te).getContainer().removeEventListener("keydown",this._enterSpaceKeyEvent),e(this,zt).forEach(t=>{document.removeEventListener(t,this._fullscreenChange)}),Ht&&(e(this,te).getElement().removeEventListener("webkitbeginfullscreen",this._setFullscreen),e(this,te).getElement().removeEventListener("webkitendfullscreen",this._unsetFullscreen)),e(this,ae).removeEventListener("click",e(this,ft)),e(this,ae).remove()}toggleFullscreen(){if(e(this,Ce)){const t=document;t.exitFullscreen?t.exitFullscreen():t.mozCancelFullScreen?t.mozCancelFullScreen():t.webkitCancelFullScreen?t.webkitCancelFullScreen():t.msExitFullscreen?t.msExitFullscreen():this._fullscreenChange(),document.body.classList.remove("op-fullscreen__on")}else{const t=e(this,te).getElement();o(this,os,window.screen.width),o(this,rs,window.screen.height),t.requestFullscreen?t.parentElement.requestFullscreen():t.mozRequestFullScreen?t.parentElement.mozRequestFullScreen():t.webkitRequestFullScreen?t.parentElement.webkitRequestFullScreen():t.msRequestFullscreen?t.parentElement.msRequestFullscreen():t.webkitEnterFullscreen?t.webkitEnterFullscreen():this._fullscreenChange(),document.body.classList.add("op-fullscreen__on")}if(typeof window<"u"&&(pe||Ht)){const{screen:t}=window;t.orientation&&!e(this,Ce)&&t.orientation.lock("landscape")}}_fullscreenChange(){const t=e(this,Ce)?void 0:e(this,os),s=e(this,Ce)?void 0:e(this,rs);this._setFullscreenData(!e(this,Ce)),e(this,te).isAd()&&e(this,te).getAd().resizeAds(t,s),o(this,Ce,!e(this,Ce)),e(this,Ce)?document.body.classList.add("op-fullscreen__on"):document.body.classList.remove("op-fullscreen__on"),this._resize(t,s)}_setFullscreenData(t){e(this,te).getContainer().setAttribute("data-fullscreen",(!!t).toString()),e(this,ae)&&(t?e(this,ae).classList.add("op-controls__fullscreen--out"):e(this,ae).classList.remove("op-controls__fullscreen--out"))}_resize(t,s){const i=e(this,te).getContainer(),n=e(this,te).getElement(),a=e(this,te).getOptions();let l="";if(t)i.style.width="100%",n.style.width="100%";else if(a.width){const r=typeof a.width=="number"?`${a.width}px`:a.width;l+=`width: ${r} !important;`,n.style.removeProperty("width")}else n.style.removeProperty("width"),i.style.removeProperty("width");if(s)n.style.height="100%",i.style.height="100%";else if(a.height){const r=typeof a.height=="number"?`${a.height}px`:a.height;l+=`height: ${r} !important;`,n.style.removeProperty("height")}else n.style.removeProperty("height"),i.style.removeProperty("height");l&&i.setAttribute("style",l)}_enterSpaceKeyEvent(t){var s;const i=t.which||t.keyCode||0;((s=document?.activeElement)==null?void 0:s.classList.contains("op-controls__fullscreen"))&&(i===13||i===32)&&(this.toggleFullscreen(),t.preventDefault(),t.stopPropagation())}_setFullscreen(){o(this,Ce,!0),this._setFullscreenData(!0),document.body.classList.add("op-fullscreen__on")}_unsetFullscreen(){o(this,Ce,!1),this._setFullscreenData(!1),document.body.classList.remove("op-fullscreen__on")}}te=new WeakMap,Ce=new WeakMap,ae=new WeakMap,zt=new WeakMap,os=new WeakMap,rs=new WeakMap,ft=new WeakMap,ls=new WeakMap,hs=new WeakMap;function Qs(g){const a=((((g.split("?")[0]||"").split("\\")||[]).pop()||"").split("/")||[]).pop()||"";return a.includes(".")?a.substring(a.lastIndexOf(".")+1):""}function Ss(g){return/\.m3u8$/i.test(g.src)||["application/x-mpegURL","application/vnd.apple.mpegurl"].includes(g.type)}function Ns(g){return/\.mpd/i.test(g.src)||g.type==="application/dash+xml"}function Hs(g){return/(^rtmp:\/\/|\.flv$)/i.test(g.src)||["video/x-flv","video/flv"].includes(g.type)}function is(g,t){const s=Qs(g);if(!s)return me(t)?"audio/mp3":"video/mp4";switch(s){case"m3u8":case"m3u":return"application/x-mpegURL";case"mpd":return"application/dash+xml";case"mp4":return me(t)?"audio/mp4":"video/mp4";case"mp3":return"audio/mp3";case"webm":return me(t)?"audio/webm":"video/webm";case"ogg":return me(t)?"audio/ogg":"video/ogg";case"ogv":return"video/ogg";case"oga":return"audio/ogg";case"3gp":return"audio/3gpp";case"wav":return"audio/wav";case"aac":return"audio/aac";case"flac":return"audio/flac";default:return me(t)?"audio/mp3":"video/mp4"}}function Xs(g,t,s,i,n){const a=g.play();a!==void 0?a.then(()=>{g.pause(),s(!0),i(!1),n()}).catch(()=>{g.volume=0,g.muted=!0,g.play().then(()=>{g.pause(),s(!0),i(!0),n()}).catch(()=>{g.volume=t,g.muted=!1,s(!1),i(!1),n()})}):(s(!g.paused||"Promise"in window&&a instanceof Promise),g.pause(),i(!1),n())}class Ys{constructor(t,s,i){h(this,I,void 0),h(this,se,void 0),h(this,G,void 0),h(this,$,{button:{},global:{},media:{}}),h(this,gt,[]),h(this,it,""),h(this,Ut,void 0),h(this,ds,void 0),o(this,I,t),o(this,Ut,s),o(this,ds,i)}create(){const{labels:t,defaultLevel:s,detachMenus:i}=e(this,I).getOptions(),n=s!==null?parseInt(s||"0",10):e(this,I).getMedia().level;o(this,it,`${n}`);const a=this._formatMenuItems(),l=a.length?a.find(m=>m.key===e(this,it)):null,r=l?l.label:t?.auto||"";let d=!1;o(this,se,document.createElement("button")),e(this,se).className=`op-controls__levels op-control__${e(this,Ut)}`,e(this,se).tabIndex=0,e(this,se).title=t?.mediaLevels||"",e(this,se).setAttribute("aria-controls",e(this,I).id),e(this,se).setAttribute("aria-label",t?.mediaLevels||""),e(this,se).setAttribute("data-active-level",e(this,it)),e(this,se).innerHTML=`<span>${r}</span>`;const u=()=>{e(this,gt).length?d||(e(this,I).getMedia().level=n,d=!0):(this._gatherLevels(),setTimeout(()=>{e(this,I).getMedia().level=n;const m=y("controlschanged");e(this,I).getElement().dispatchEvent(m)},0))};e(this,$).media.loadedmetadata=u.bind(this),e(this,$).media.manifestLoaded=u.bind(this),e(this,$).media.hlsManifestParsed=u.bind(this),i&&(this._buildMenu(),e(this,$).button.click=()=>{if(i){const m=e(this,I).getContainer().querySelectorAll(".op-settings");for(let c=0,v=m.length;c<v;++c)m[c]!==e(this,G)&&m[c].setAttribute("aria-hidden","true");e(this,G).getAttribute("aria-hidden")==="true"?e(this,G).setAttribute("aria-hidden","false"):e(this,G).setAttribute("aria-hidden","true")}},e(this,$).button.mouseover=()=>{if(!_e&&!pe){const m=e(this,I).getContainer().querySelectorAll(".op-settings");for(let c=0,v=m.length;c<v;++c)m[c]!==e(this,G)&&m[c].setAttribute("aria-hidden","true");e(this,G).getAttribute("aria-hidden")==="true"&&e(this,G).setAttribute("aria-hidden","false")}},e(this,$).button.mouseout=()=>{if(!_e&&!pe){const m=e(this,I).getContainer().querySelectorAll(".op-settings");for(let c=0,v=m.length;c<v;++c)m[c].setAttribute("aria-hidden","true");e(this,G).getAttribute("aria-hidden")==="false"&&e(this,G).setAttribute("aria-hidden","true")}},e(this,se).addEventListener("click",e(this,$).button.click,p),e(this,se).addEventListener("mouseover",e(this,$).button.mouseover,p),e(this,G).addEventListener("mouseover",e(this,$).button.mouseover,p),e(this,G).addEventListener("mouseout",e(this,$).button.mouseout,p),e(this,I).getElement().addEventListener("controlshidden",e(this,$).button.mouseout,p)),e(this,$).global.click=m=>{const c=m.target,{currentTime:v}=e(this,I).getMedia(),L=e(this,I).getMedia().paused;if(c.closest(`#${e(this,I).id}`)&&c.classList.contains("op-levels__option")){const M=c.getAttribute("data-value"),B=M?M.replace("levels-",""):"-1";if(o(this,it,`${B}`),i){e(this,se).setAttribute("data-active-level",`${B}`),e(this,se).innerHTML=`<span>${Ne(c.innerText,!0)}</span>`;const xe=c.parentElement&&c.parentElement.parentElement?c.parentElement.parentElement.querySelectorAll(".op-settings__submenu-item"):[];for(let qe=0,as=xe.length;qe<as;++qe)xe[qe].setAttribute("aria-checked","false");c.parentElement&&c.parentElement.setAttribute("aria-checked","true"),e(this,G).setAttribute("aria-hidden","false")}e(this,I).getMedia().level=B,e(this,I).getMedia().currentTime=v,L||e(this,I).play();const ve=y("levelchanged",{detail:{label:c.innerText.trim(),level:B}});e(this,I).getElement().dispatchEvent(ve),m.preventDefault(),m.stopPropagation()}};const A=we?.connection||we?.mozConnection||we?.webkitConnection;e(this,$).global.connection=()=>{const m=e(this,I).getMedia().current;if(!Ns(m)&&!Ss(m)){const c=A?.effectiveType||"",v=e(this,gt).map(M=>({...M,resolution:parseInt(M.label.replace("p",""),10)}));let L=v.find(M=>M.resolution<360);c==="4g"?L=v.find(M=>M.resolution>=720):c==="3g"&&(L=v.find(M=>M.resolution>=360&&M.resolution<720)),L&&(e(this,I).pause(),e(this,I).getMedia().level=L.id,e(this,I).play())}},Object.keys(e(this,$).media).forEach(m=>{e(this,I).getElement().addEventListener(m,e(this,$).media[m],p)}),document.addEventListener("click",e(this,$).global.click,p),A&&A.addEventListener("change",e(this,$).global.connection,p)}destroy(){const{detachMenus:t}=e(this,I).getOptions(),s=we?.connection||we?.mozConnection||we?.webkitConnection;Object.keys(e(this,$).media).forEach(i=>{e(this,I).getElement().removeEventListener(i,e(this,$).media[i])}),document.removeEventListener("click",e(this,$).global.click),s&&s.removeEventListener("change",e(this,$).global.connection),t&&(e(this,se).removeEventListener("click",e(this,$).button.click),e(this,se).remove(),e(this,se).removeEventListener("mouseover",e(this,$).button.mouseover),e(this,G).removeEventListener("mouseover",e(this,$).button.mouseover),e(this,G).removeEventListener("mouseout",e(this,$).button.mouseout),e(this,I).getElement().removeEventListener("controlshidden",e(this,$).button.mouseout),e(this,G).remove())}addSettings(){const{labels:t,detachMenus:s}=e(this,I).getOptions();if(s)return{};const i=this._formatMenuItems();return i.length>2?{className:"op-levels__option",default:e(this,it)||"-1",key:"levels",name:t?.levels,subitems:i}:{}}_formatMenuItems(){const{labels:t}=e(this,I).getOptions(),s=this._gatherLevels(),i=s.length;let n=i?[{key:"-1",label:t?.auto}]:[];for(let a=0;a<i;a++){const l=s[a];n=n.filter(r=>r.key!==l.id),n.push({key:l.id,label:l.label})}return n.reduce((a,l)=>a.find(d=>d.label===l.label)?a:a.concat([l]),[]).sort((a,l)=>parseInt(a?.label||"",10)>parseInt(l?.label||"",10)?1:-1)}_getResolutionsLabel(t){const{labels:s}=e(this,I).getOptions();return t>=4320?"8K":t>=2160?"4K":t>=1440?"1440p":t>=1080?"1080p":t>=720?"720p":t>=480?"480p":t>=360?"360p":t>=240?"240p":t>=144?"144p":s?.auto||""}_gatherLevels(){return e(this,gt).length||e(this,I).getMedia().levels.forEach(t=>{e(this,gt).push({...t,label:t.label||this._getResolutionsLabel(t.height)})}),e(this,gt)}_buildMenu(){const{detachMenus:t}=e(this,I).getOptions();if(t){e(this,se).classList.add("op-control--no-hover"),o(this,G,document.createElement("div")),e(this,G).className="op-settings op-levels__menu",e(this,G).setAttribute("aria-hidden","true");const s="op-levels__option",n=`<div class="op-settings__menu" role="menu" id="menu-item-levels">
                ${this._formatMenuItems().map(l=>`
                <div class="op-settings__submenu-item" tabindex="0" role="menuitemradio"
                    aria-checked="${e(this,it)===l.key?"true":"false"}">
                    <div class="op-settings__submenu-label ${s}" data-value="levels-${l.key}">${l.label}</div>
                </div>`).join("")}
            </div>`;e(this,G).innerHTML=n;const a=document.createElement("div");a.className=`op-controls__container op-control__${e(this,Ut)}`,a.appendChild(e(this,se)),a.appendChild(e(this,G)),e(this,I).getControls().getLayer(e(this,ds)).appendChild(a)}}}I=new WeakMap,se=new WeakMap,G=new WeakMap,$=new WeakMap,gt=new WeakMap,it=new WeakMap,Ut=new WeakMap,ds=new WeakMap;class Js{constructor(t,s,i){h(this,x,void 0),h(this,C,void 0),h(this,H,{controls:{},media:{}}),h(this,cs,void 0),h(this,us,void 0),o(this,x,t),o(this,cs,s),o(this,us,i),this._enterSpaceKeyEvent=this._enterSpaceKeyEvent.bind(this)}create(){var t;const{labels:s}=e(this,x).getOptions();o(this,C,document.createElement("button")),e(this,C).type="button",e(this,C).className=`op-controls__playpause op-control__${e(this,cs)}`,e(this,C).tabIndex=0,e(this,C).title=s?.play||"",e(this,C).setAttribute("aria-controls",e(this,x).id),e(this,C).setAttribute("aria-pressed","false"),e(this,C).setAttribute("aria-label",s?.play||""),e(this,x).getControls().getLayer(e(this,us)).appendChild(e(this,C)),e(this,H).button=a=>{e(this,C).setAttribute("aria-pressed","true");const l=e(this,x).activeElement();l.paused||l.ended?(e(this,x).getAd()&&(e(this,x).getAd().playRequested=!0),l.play(),e(this,H).media.play()):(l.pause(),e(this,H).media.pause()),a.preventDefault(),a.stopPropagation()};const i=me(e(this,x).getElement());e(this,H).media.play=()=>{var a;e(this,x).activeElement().ended?(e(this,x).isMedia()?e(this,C).classList.add("op-controls__playpause--replay"):e(this,C).classList.add("op-controls__playpause--pause"),e(this,C).title=s?.play||"",e(this,C).setAttribute("aria-label",s?.play||"")):(e(this,C).classList.remove("op-controls__playpause--replay"),e(this,C).classList.add("op-controls__playpause--pause"),e(this,C).title=s?.pause||"",e(this,C).setAttribute("aria-label",s?.pause||""),(a=e(this,x).getOptions())!=null&&a.pauseOthers&&Object.keys($s.instances).forEach(l=>{l!==e(this,x).id&&$s.instances[l].activeElement().pause()}))},e(this,H).media.loadedmetadata=()=>{e(this,C).classList.contains("op-controls__playpause--pause")&&(e(this,C).classList.remove("op-controls__playpause--replay"),e(this,C).classList.remove("op-controls__playpause--pause"),e(this,C).title=s?.play||"",e(this,C).setAttribute("aria-label",s?.play||""))},e(this,H).media.playing=()=>{e(this,C).classList.contains("op-controls__playpause--pause")||(e(this,C).classList.remove("op-controls__playpause--replay"),e(this,C).classList.add("op-controls__playpause--pause"),e(this,C).title=s?.pause||"",e(this,C).setAttribute("aria-label",s?.pause||""))},e(this,H).media.pause=()=>{e(this,C).classList.remove("op-controls__playpause--pause"),e(this,C).title=s?.play||"",e(this,C).setAttribute("aria-label",s?.play||"")},e(this,H).media.ended=()=>{e(this,x).activeElement().ended&&e(this,x).isMedia()?(e(this,C).classList.add("op-controls__playpause--replay"),e(this,C).classList.remove("op-controls__playpause--pause")):e(this,x).getElement().currentTime>=e(this,x).getElement().duration||e(this,x).getElement().currentTime<=0?(e(this,C).classList.add("op-controls__playpause--replay"),e(this,C).classList.remove("op-controls__playpause--pause")):(e(this,C).classList.remove("op-controls__playpause--replay"),e(this,C).classList.add("op-controls__playpause--pause")),e(this,C).title=s?.play||"",e(this,C).setAttribute("aria-label",s?.play||"")},e(this,H).media.adsmediaended=()=>{e(this,C).classList.remove("op-controls__playpause--replay"),e(this,C).classList.add("op-controls__playpause--pause"),e(this,C).title=s?.pause||"",e(this,C).setAttribute("aria-label",s?.pause||"")},e(this,H).media.playererror=()=>{i&&e(this,x).activeElement().pause()};const n=e(this,x).getElement();e(this,H).controls.controlschanged=()=>{if(!e(this,x).activeElement().paused){const a=y("playing");n.dispatchEvent(a)}},Object.keys(e(this,H).media).forEach(a=>{n.addEventListener(a,e(this,H).media[a],p)}),(t=e(this,x).getOptions().media)!=null&&t.pauseOnClick&&n.addEventListener("click",e(this,H).button,p),e(this,x).getControls().getContainer().addEventListener("controlschanged",e(this,H).controls.controlschanged,p),e(this,x).getContainer().addEventListener("keydown",this._enterSpaceKeyEvent,p),e(this,C).addEventListener("click",e(this,H).button,p)}destroy(){var t;Object.keys(e(this,H).media).forEach(s=>{e(this,x).getElement().removeEventListener(s,e(this,H).media[s])}),(t=e(this,x).getOptions().media)!=null&&t.pauseOnClick&&e(this,x).getElement().removeEventListener("click",e(this,H).button),e(this,x).getControls().getContainer().removeEventListener("controlschanged",e(this,H).controls.controlschanged),e(this,x).getContainer().removeEventListener("keydown",this._enterSpaceKeyEvent),e(this,C).removeEventListener("click",e(this,H).button),e(this,C).remove()}_enterSpaceKeyEvent(t){var s;const i=t.which||t.keyCode||0;((s=document?.activeElement)==null?void 0:s.classList.contains("op-controls__playpause"))&&(i===13||i===32)&&e(this,H).button(t)}}x=new WeakMap,C=new WeakMap,H=new WeakMap,cs=new WeakMap,us=new WeakMap;function He(g,t){const s=Math.floor(g%1*0);let i=Math.floor(g),n=Math.floor(i/60);const a=Math.floor(n/60),l=r=>{const d=r.toString();return r<10?r<=0?"00":`0${d}`:d};return n%=60,i%=60,`${a>0?`${l(a)}:`:""}${l(n)}:${l(i)}${s?`:${l(s)}`:""}`}class Zs{constructor(t,s,i){h(this,w,void 0),h(this,S,void 0),h(this,E,void 0),h(this,Ke,void 0),h(this,ye,void 0),h(this,Ee,void 0),h(this,W,{container:{},controls:{},global:{},media:{},slider:{}}),h(this,Ot,!1),h(this,ps,void 0),h(this,ms,void 0),o(this,w,t),o(this,ps,s),o(this,ms,i),this._enterSpaceKeyEvent=this._enterSpaceKeyEvent.bind(this)}create(){var t;const{labels:s,progress:i}=e(this,w).getOptions();o(this,S,document.createElement("div")),e(this,S).className=`op-controls__progress op-control__${e(this,ps)}`,e(this,S).tabIndex=0,e(this,S).setAttribute("aria-label",s?.progressSlider||""),e(this,S).setAttribute("aria-valuemin","0"),e(this,S).setAttribute("aria-valuenow","0"),e(this,S).setAttribute("role","slider"),o(this,E,document.createElement("input")),e(this,E).type="range",e(this,E).className="op-controls__progress--seek",e(this,E).tabIndex=-1,e(this,E).setAttribute("min","0"),e(this,E).setAttribute("step","0.1"),e(this,E).value="0",e(this,E).setAttribute("aria-label",s?.progressRail||""),e(this,E).setAttribute("role","slider"),o(this,Ke,document.createElement("progress")),e(this,Ke).className="op-controls__progress--buffer",e(this,Ke).setAttribute("max","100"),e(this,Ke).value=0,o(this,ye,document.createElement("progress")),e(this,ye).className="op-controls__progress--played",e(this,ye).setAttribute("max","100"),e(this,ye).value=0,e(this,S).appendChild(e(this,E)),e(this,S).appendChild(e(this,ye)),e(this,S).appendChild(e(this,Ke)),!_e&&!pe&&(o(this,Ee,document.createElement("span")),e(this,Ee).className="op-controls__tooltip",e(this,Ee).tabIndex=-1,e(this,Ee).innerHTML="00:00",e(this,S).appendChild(e(this,Ee)));const n=()=>{var c;e(this,E).classList.contains("error")&&e(this,E).classList.remove("error");const v=e(this,w).activeElement();if(v.duration!==1/0&&!e(this,w).getElement().getAttribute("op-live__enabled")&&!e(this,w).getElement().getAttribute("op-dvr__enabled")){const L=e(this,w).isMedia()?v.currentTime:v.duration-v.currentTime;e(this,E).value=L.toString(),Number.isNaN(v.duration)||(e(this,E).setAttribute("max",`${v.duration}`),e(this,S).setAttribute("aria-valuemax",v.duration.toString()))}else e(this,w).getElement().getAttribute("op-dvr__enabled")?(e(this,E).setAttribute("max","1"),e(this,E).value="1",e(this,E).style.backgroundSize="100% 100%",e(this,ye).value=1,e(this,S).setAttribute("aria-valuemax","1"),e(this,S).setAttribute("aria-hidden","false")):(c=e(this,w).getOptions().live)!=null&&c.showProgress||e(this,S).setAttribute("aria-hidden","true")};let a=0;const l=((t=e(this,w).getOptions().progress)==null?void 0:t.duration)||0,r=me(e(this,w).getElement());e(this,W).media.loadedmetadata=n.bind(this),e(this,W).controls.controlschanged=n.bind(this),e(this,W).media.progress=c=>{var v;const L=c.target;if(L.duration!==1/0&&!e(this,w).getElement().getAttribute("op-live__enabled")){if(L.duration>0){for(let M=0,B=L.buffered.length;M<B;M++)if(L.buffered.start(L.buffered.length-1-M)<L.currentTime){e(this,Ke).value=L.buffered.end(L.buffered.length-1-M)/L.duration*100;break}}}else!e(this,w).getElement().getAttribute("op-dvr__enabled")&&e(this,S).getAttribute("aria-hidden")==="false"&&!((v=e(this,w).getOptions().live)!=null&&v.showProgress)&&e(this,S).setAttribute("aria-hidden","true")},e(this,W).media.waiting=()=>{r&&!e(this,E).classList.contains("loading")&&e(this,E).classList.add("loading"),r&&e(this,E).classList.contains("error")&&e(this,E).classList.remove("error")},e(this,W).media.playererror=()=>{r&&!e(this,E).classList.contains("error")&&e(this,E).classList.add("error"),r&&e(this,E).classList.contains("loading")&&e(this,E).classList.remove("loading")},e(this,W).media.pause=()=>{const c=e(this,w).activeElement();if(c.duration!==1/0&&!e(this,w).getElement().getAttribute("op-live__enabled")){const v=c.currentTime;e(this,S).setAttribute("aria-valuenow",v.toString()),e(this,S).setAttribute("aria-valuetext",He(v))}},e(this,W).media.play=()=>{r&&e(this,E).classList.contains("loading")&&e(this,E).classList.remove("loading"),r&&e(this,E).classList.contains("error")&&e(this,E).classList.remove("error"),e(this,w).activeElement().duration!==1/0&&!e(this,w).getElement().getAttribute("op-live__enabled")&&(e(this,S).removeAttribute("aria-valuenow"),e(this,S).removeAttribute("aria-valuetext"))},e(this,W).media.playing=()=>{r&&e(this,E).classList.contains("loading")&&e(this,E).classList.remove("loading"),r&&e(this,E).classList.contains("error")&&e(this,E).classList.remove("error")},e(this,W).media.timeupdate=()=>{var c;const v=e(this,w).activeElement();if(v.duration!==1/0&&(!e(this,w).getElement().getAttribute("op-live__enabled")||e(this,w).getElement().getAttribute("op-dvr__enabled"))){(!e(this,E).getAttribute("max")||e(this,E).getAttribute("max")==="0"||parseFloat(e(this,E).getAttribute("max")||"-1")!==v.duration)&&(Number.isNaN(v.duration)||e(this,E).setAttribute("max",`${v.duration}`),e(this,S).setAttribute("aria-hidden","false"));const L=v.duration-v.currentTime+1>=100?100:v.duration-v.currentTime+1,M=e(this,w).isMedia()?v.currentTime:L,B=parseFloat(e(this,E).min),ve=parseFloat(e(this,E).max);e(this,E).value=M.toString(),e(this,E).style.backgroundSize=`${(M-B)*100/(ve-B)}% 100%`,e(this,ye).value=v.duration<=0||Number.isNaN(v.duration)||!Number.isFinite(v.duration)?l:M/v.duration*100,e(this,w).getElement().getAttribute("op-dvr__enabled")&&Math.floor(e(this,ye).value)>=99&&(a=v.currentTime,e(this,S).setAttribute("aria-hidden","false"))}else!e(this,w).getElement().getAttribute("op-dvr__enabled")&&e(this,S).getAttribute("aria-hidden")==="false"&&!((c=e(this,w).getOptions().live)!=null&&c.showProgress)&&e(this,S).setAttribute("aria-hidden","true")},e(this,W).media.durationchange=()=>{const c=e(this,w).activeElement(),v=e(this,w).isMedia()?c.currentTime:c.duration-c.currentTime;Number.isNaN(c.duration)||(e(this,E).setAttribute("max",`${c.duration}`),e(this,S).setAttribute("aria-valuemax",c.duration.toString())),e(this,ye).value=c.duration<=0||Number.isNaN(c.duration)||!Number.isFinite(c.duration)?l:v/c.duration*100},e(this,W).media.ended=()=>{e(this,E).style.backgroundSize="0% 100%",e(this,E).getAttribute("max")&&e(this,E).setAttribute("max","0"),e(this,Ke).value=0,e(this,ye).value=0};const d=c=>{const v=e(this,w).activeElement(),L=c.target,M=parseFloat(L.value);if(e(this,E).classList.contains("op-progress--pressed")||M<v.currentTime&&!i?.allowRewind||M>v.currentTime&&!i?.allowSkip){e(this,E).value=v.currentTime.toString();return}e(this,E).classList.add(".op-progress--pressed");const B=parseFloat(L.min),ve=parseFloat(L.max),xe=parseFloat(L.value);e(this,E).style.backgroundSize=`${(xe-B)*100/(ve-B)}% 100%`,e(this,ye).value=v.duration<=0||Number.isNaN(v.duration)||!Number.isFinite(v.duration)?l:xe/v.duration*100,e(this,w).getElement().getAttribute("op-dvr__enabled")?v.currentTime=Math.round(e(this,ye).value)>=99?a:xe:v.currentTime=xe,e(this,E).classList.remove(".op-progress--pressed")},u=c=>{const v=e(this,w).activeElement(),L=c.which||c.keyCode||0,M=e(this,E),B=Math.round(Number(M.value)),ve=Math.round(v.currentTime);(B<ve&&i?.allowRewind||B>=ve&&i?.allowSkip)&&(L===1||L===0)&&e(this,w).isMedia()&&!v.paused&&(v.pause(),o(this,Ot,!0))},A=()=>{const c=e(this,w).activeElement();e(this,Ot)===!0&&e(this,w).isMedia()&&c.paused&&(c.play(),o(this,Ot,!1))},m=c=>{var v;const L=e(this,w).activeElement();if(L.duration!==1/0){const{changedTouches:M}=c,qe=((((v=M[0])==null?void 0:v.pageX)||0)-ss(e(this,S)).left)/e(this,S).offsetWidth*L.duration;(qe<L.currentTime&&i?.allowRewind||qe>L.currentTime&&i?.allowSkip)&&(e(this,E).value=qe.toString(),d(c),L.paused||(L.pause(),o(this,Ot,!0)))}};e(this,W).slider.input=d.bind(this),e(this,W).slider.change=d.bind(this),e(this,W).slider.mousedown=u.bind(this),e(this,W).slider.mouseup=A.bind(this),e(this,W).slider.touchstart=m.bind(this),e(this,W).slider.touchend=A.bind(this),!_e&&!pe&&(e(this,W).container.mousemove=c=>{const v=e(this,w).activeElement();if(v.duration!==1/0&&!e(this,w).isAd()){const L=c.pageX;let M=L-ss(e(this,S)).left;const B=e(this,Ee).offsetWidth/2,ve=M/e(this,S).offsetWidth,xe=ve*v.duration,qe=e(this,w).getContainer(),as=qe.offsetWidth-e(this,Ee).offsetWidth;M<=0||L-ss(qe).left<=B?M=0:L-ss(qe).left>=as?M=as-ss(e(this,E)).left-10:M-=B,ve>=0&&ve<=1?e(this,Ee).classList.add("op-controls__tooltip--visible"):e(this,Ee).classList.remove("op-controls__tooltip--visible"),e(this,Ee).style.left=`${M}px`,e(this,Ee).innerHTML=Number.isNaN(xe)?"00:00":He(xe)}},e(this,W).global.mousemove=c=>{(!c.target.closest(".op-controls__progress")||e(this,w).isAd())&&e(this,Ee).classList.remove("op-controls__tooltip--visible")}),Object.keys(e(this,W).media).forEach(c=>{e(this,w).getElement().addEventListener(c,e(this,W).media[c],p)}),Object.keys(e(this,W).slider).forEach(c=>{e(this,E).addEventListener(c,e(this,W).slider[c],p)}),e(this,S).addEventListener("keydown",e(this,w).getEvents().keydown,p),e(this,S).addEventListener("mousemove",e(this,W).container.mousemove,p),document.addEventListener("mousemove",e(this,W).global.mousemove,p),e(this,w).getContainer().addEventListener("keydown",this._enterSpaceKeyEvent,p),e(this,w).getControls().getContainer().addEventListener("controlschanged",e(this,W).controls.controlschanged,p),e(this,w).getControls().getLayer(e(this,ms)).appendChild(e(this,S))}destroy(){Object.keys(e(this,W)).forEach(t=>{e(this,w).getElement().removeEventListener(t,e(this,W)[t])}),Object.keys(e(this,W).slider).forEach(t=>{e(this,E).removeEventListener(t,e(this,W).slider[t])}),e(this,S).removeEventListener("keydown",e(this,w).getEvents().keydown),e(this,S).removeEventListener("mousemove",e(this,W).container.mousemove),document.removeEventListener("mousemove",e(this,W).global.mousemove),e(this,w).getContainer().removeEventListener("keydown",this._enterSpaceKeyEvent),e(this,w).getControls().getContainer().removeEventListener("controlschanged",e(this,W).controls.controlschanged),e(this,Ke).remove(),e(this,ye).remove(),e(this,E).remove(),!_e&&!pe&&e(this,Ee).remove(),e(this,S).remove()}_enterSpaceKeyEvent(t){const s=e(this,w).activeElement(),i=e(this,w).isAd(),n=t.which||t.keyCode||0;if(!i&&n>=48&&n<=57&&s.duration!==1/0){let a=0;for(let l=48,r=57;l<=r;l++)l<n&&a++;s.currentTime=s.duration*(.1*a),t.preventDefault(),t.stopPropagation()}}}w=new WeakMap,S=new WeakMap,E=new WeakMap,Ke=new WeakMap,ye=new WeakMap,Ee=new WeakMap,W=new WeakMap,Ot=new WeakMap,ps=new WeakMap,ms=new WeakMap;class qs{constructor(t,s,i){h(this,q,void 0),h(this,_t,{}),h(this,Ae,void 0),h(this,D,void 0),h(this,z,{global:{},media:{}}),h(this,bt,""),h(this,vs,void 0),h(this,fs,void 0),o(this,q,t),o(this,vs,s),o(this,fs,i),this._enterSpaceKeyEvent=this._enterSpaceKeyEvent.bind(this)}create(){const{labels:t}=e(this,q).getOptions();o(this,Ae,document.createElement("button")),e(this,Ae).className=`op-controls__settings op-control__${e(this,vs)}`,e(this,Ae).tabIndex=0,e(this,Ae).title=t?.settings||"",e(this,Ae).setAttribute("aria-controls",e(this,q).id),e(this,Ae).setAttribute("aria-pressed","false"),e(this,Ae).setAttribute("aria-label",t?.settings||""),o(this,D,document.createElement("div")),e(this,D).className="op-settings",e(this,D).setAttribute("aria-hidden","true"),e(this,D).innerHTML='<div class="op-settings__menu" role="menu"></div>',this.clickEvent=()=>{e(this,Ae).setAttribute("aria-pressed","true");const s=e(this,q).getContainer().querySelectorAll(".op-settings");for(let i=0,n=s.length;i<n;++i)s[i]!==e(this,D)&&s[i].setAttribute("aria-hidden","true");e(this,D).setAttribute("aria-hidden",e(this,D).getAttribute("aria-hidden")==="false"?"true":"false")},this.hideEvent=()=>{let s;s&&typeof window<"u"&&window.cancelAnimationFrame(s),typeof window<"u"&&(s=window.requestAnimationFrame(()=>{e(this,D).innerHTML=e(this,bt),e(this,D).setAttribute("aria-hidden","true")}))},this.removeEvent=s=>{const{id:i,type:n}=s.detail;this.removeItem(i,n)},this.clickEvent=this.clickEvent.bind(this),this.hideEvent=this.hideEvent.bind(this),this.removeEvent=this.removeEvent.bind(this),e(this,z).media.controlshidden=this.hideEvent.bind(this),e(this,z).media.settingremoved=this.removeEvent.bind(this),e(this,z).media.play=this.hideEvent.bind(this),e(this,z).media.pause=this.hideEvent.bind(this),e(this,q).getContainer().addEventListener("keydown",this._enterSpaceKeyEvent,p),e(this,z).global.click=s=>{const{target:i}=s,n=i;if(n?.closest(`#${e(this,q).id}`)&&n?.classList.contains("op-speed__option")){const a=n?.getAttribute("data-value")||"";e(this,q).getMedia().playbackRate=parseFloat(a.replace("speed-",""))}},e(this,z).global.resize=this.hideEvent.bind(this),e(this,Ae).addEventListener("click",this.clickEvent,p),Object.keys(e(this,z)).forEach(s=>{e(this,q).getElement().addEventListener(s,e(this,z).media[s],p)}),document.addEventListener("click",e(this,z).global.click,p),document.addEventListener("keydown",e(this,z).global.click,p),typeof window<"u"&&window.addEventListener("resize",e(this,z).global.resize,p),e(this,q).getControls().getLayer(e(this,fs)).appendChild(e(this,Ae)),e(this,q).getContainer().appendChild(e(this,D))}destroy(){e(this,Ae).removeEventListener("click",this.clickEvent),Object.keys(e(this,z)).forEach(t=>{e(this,q).getElement().removeEventListener(t,e(this,z).media[t])}),document.removeEventListener("click",e(this,z).global.click),document.removeEventListener("keydown",e(this,z).global.click),typeof window<"u"&&window.removeEventListener("resize",e(this,z).global.resize),e(this,z).global["settings.submenu"]!==void 0&&(document.removeEventListener("click",e(this,z).global["settings.submenu"]),e(this,q).getElement().removeEventListener("controlshidden",this.hideEvent)),e(this,q).getContainer().removeEventListener("keydown",this._enterSpaceKeyEvent),e(this,D).remove(),e(this,Ae).remove()}addSettings(){const t=e(this,q).getMedia(),{labels:s}=e(this,q).getOptions();let i=1;return e(this,q)&&t&&(i=t.defaultPlaybackRate!==t.playbackRate?t.playbackRate:t.defaultPlaybackRate),{className:"op-speed__option",default:i.toString(),key:"speed",name:s?.speed||"",subitems:[{key:"0.25",label:"0.25"},{key:"0.5",label:"0.5"},{key:"0.75",label:"0.75"},{key:"1",label:s?.speedNormal||""},{key:"1.25",label:"1.25"},{key:"1.5",label:"1.5"},{key:"2",label:"2"}]}}addItem(t,s,i,n,a){const l=`${s}-${Ne(i,!0)}`,r=document.createElement("div");r.className="op-settings__menu-item",r.tabIndex=0,r.setAttribute("role","menuitemradio"),r.innerHTML=`<div class="op-settings__menu-label" data-value="${l}">${t}</div>`;const d=n?n.find(A=>A.key===i):null;d&&(r.innerHTML+=`<div class="op-settings__menu-content" tabindex="0">${d.label}</div>`);const u=e(this,D).querySelector(".op-settings__menu");if(u&&u.appendChild(r),o(this,bt,e(this,D).innerHTML),n){const A=`
                <div class="op-settings__header">
                    <button type="button" class="op-settings__back" tabindex="0">${t}</button>
                </div>
                <div class="op-settings__menu" role="menu" id="menu-item-${s}">
                    ${n.map(m=>`
                    <div class="op-settings__submenu-item" role="menuitemradio" aria-checked="${i===m.key?"true":"false"}">
                        <div class="op-settings__submenu-label ${a||""}" tabindex="0" data-value="${s}-${m.key}">
                            ${m.label}
                        </div>
                    </div>`).join("")}
                </div>`;e(this,_t)[s]=A}e(this,z).global["settings.submenu"]=A=>{const m=A.target;if(m.closest(`#${e(this,q).id}`)){if(m.classList.contains("op-settings__back"))e(this,D).classList.add("op-settings--sliding"),setTimeout(()=>{e(this,D).innerHTML=e(this,bt),e(this,D).classList.remove("op-settings--sliding")},100);else if(m.classList.contains("op-settings__menu-content")){const c=m.parentElement?m.parentElement.querySelector(".op-settings__menu-label"):null,v=c?c.getAttribute("data-value"):null,L=v?v.split("-"):[];if(L.length>0){L.pop();const M=L.join("-").replace(/^\-|\-$/,"");typeof e(this,_t)[M]<"u"&&(e(this,D).classList.add("op-settings--sliding"),setTimeout(()=>{e(this,D).innerHTML=e(this,_t)[M],e(this,D).classList.remove("op-settings--sliding")},100))}}else if(m.classList.contains("op-settings__submenu-label")){const c=m.getAttribute("data-value"),v=c?c.replace(`${s}-`,""):"",L=m.innerText,M=e(this,D).querySelector(`#menu-item-${s} .op-settings__submenu-item[aria-checked=true]`);M&&(M.setAttribute("aria-checked","false"),m.parentElement&&m.parentElement.setAttribute("aria-checked","true"),e(this,_t)[s]=e(this,D).innerHTML,e(this,D).classList.add("op-settings--sliding"),setTimeout(()=>{e(this,D).innerHTML=e(this,bt);const B=e(this,D).querySelector(`.op-settings__menu-label[data-value="${s}-${i}"]`);B&&(B.setAttribute("data-value",`${c}`),B.nextElementSibling&&(B.nextElementSibling.textContent=L)),i=v,o(this,bt,e(this,D).innerHTML),e(this,D).classList.remove("op-settings--sliding")},100))}}else this.hideEvent()},document.addEventListener("click",e(this,z).global["settings.submenu"],p),e(this,q).getElement().addEventListener("controlshidden",this.hideEvent,p)}removeItem(t,s,i=2){const n=e(this,q).getElement().querySelector(`.op-settings__submenu-label[data-value=${s}-${t}]`);if(n&&n.remove(),e(this,q).getElement().querySelectorAll(`.op-settings__submenu-label[data-value^=${s}]`).length<i){delete e(this,_t)[s];const a=e(this,q).getElement().querySelector(`.op-settings__menu-label[data-value^=${s}]`),l=a?a.closest(".op-settings__menu-item"):null;l&&l.remove()}}_enterSpaceKeyEvent(t){var s,i,n,a;const l=t.which||t.keyCode||0,r=e(this,q).isAd(),d=(s=document?.activeElement)==null?void 0:s.classList.contains("op-controls__settings"),u=((i=document?.activeElement)==null?void 0:i.classList.contains("op-settings__menu-content"))||((n=document?.activeElement)==null?void 0:n.classList.contains("op-settings__back"))||((a=document?.activeElement)==null?void 0:a.classList.contains("op-settings__submenu-label"));r||(d&&(l===13||l===32)?(this.clickEvent(),t.preventDefault(),t.stopPropagation()):u&&(l===13||l===32)&&(e(this,z).global["settings.submenu"](t),t.preventDefault(),t.stopPropagation()))}}q=new WeakMap,_t=new WeakMap,Ae=new WeakMap,D=new WeakMap,z=new WeakMap,bt=new WeakMap,vs=new WeakMap,fs=new WeakMap;class ei{constructor(t,s,i){h(this,Q,void 0),h(this,fe,void 0),h(this,$e,void 0),h(this,oe,void 0),h(this,Ge,void 0),h(this,De,{controls:{},media:{}}),h(this,gs,void 0),h(this,_s,void 0),o(this,Q,t),o(this,gs,s),o(this,_s,i)}create(){const{labels:t,progress:s}=e(this,Q).getOptions();o(this,fe,document.createElement("time")),e(this,fe).className="op-controls__current",e(this,fe).setAttribute("role","timer"),e(this,fe).setAttribute("aria-live","off"),e(this,fe).setAttribute("aria-hidden","false"),e(this,fe).innerText="0:00";const i=s?.showCurrentTimeOnly||!1;i||(o(this,$e,document.createElement("span")),e(this,$e).className="op-controls__time-delimiter",e(this,$e).setAttribute("aria-hidden","false"),e(this,$e).innerText="/",o(this,oe,document.createElement("time")),e(this,oe).className="op-controls__duration",e(this,oe).setAttribute("aria-hidden","false"),e(this,oe).innerText=He(s?.duration||0));const n=e(this,Q).getControls().getLayer(e(this,_s));o(this,Ge,document.createElement("span")),e(this,Ge).className=`op-controls-time op-control__${e(this,gs)}`,e(this,Ge).appendChild(e(this,fe)),i||(e(this,Ge).appendChild(e(this,$e)),e(this,Ge).appendChild(e(this,oe))),n.appendChild(e(this,Ge));const a=()=>{var r;const d=e(this,Q).activeElement();if(d.duration!==1/0&&!e(this,Q).getElement().getAttribute("op-live__enabled")){if(!i){const u=Number.isNaN(d.duration)?((r=e(this,Q).getOptions().progress)==null?void 0:r.duration)||0:d.duration;e(this,oe).innerText=He(u)}e(this,fe).innerText=He(d.currentTime)}else i||(e(this,oe).setAttribute("aria-hidden","true"),e(this,$e).setAttribute("aria-hidden","true"))};e(this,De).media.loadedmetadata=a.bind(this),e(this,De).controls.controlschanged=a.bind(this);const{showLabel:l}=e(this,Q).getOptions().live||{};e(this,De).media.timeupdate=()=>{const r=e(this,Q).activeElement();if(r.duration!==1/0&&!e(this,Q).getElement().getAttribute("op-live__enabled")&&!e(this,Q).getElement().getAttribute("op-dvr__enabled")){const d=He(r.duration);!i&&!Number.isNaN(r.duration)&&d!==e(this,oe).innerText?(e(this,oe).innerText=d,e(this,oe).setAttribute("aria-hidden","false"),e(this,$e).setAttribute("aria-hidden","false")):(i||d!==e(this,oe).innerText)&&(e(this,fe).innerText=l?t?.live||"":He(r.currentTime)),e(this,fe).innerText=He(r.currentTime)}else e(this,Q).getElement().getAttribute("op-dvr__enabled")?(i||(e(this,oe).setAttribute("aria-hidden","true"),e(this,$e).setAttribute("aria-hidden","true")),e(this,fe).innerText=He(r.currentTime)):i||!e(this,Q).getElement().getAttribute("op-dvr__enabled")&&e(this,oe).getAttribute("aria-hidden")==="false"?(i||(e(this,oe).setAttribute("aria-hidden","true"),e(this,$e).setAttribute("aria-hidden","true")),e(this,fe).innerText=l?t?.live||"":He(r.currentTime)):e(this,fe).innerText=l?t?.live||"":He(r.currentTime)},e(this,De).media.ended=()=>{var r;const d=e(this,Q).activeElement(),u=Number.isNaN(d.duration)?((r=e(this,Q).getOptions().progress)==null?void 0:r.duration)||0:d.duration;!i&&e(this,Q).isMedia()&&(e(this,oe).innerText=He(u))},Object.keys(e(this,De).media).forEach(r=>{e(this,Q).getElement().addEventListener(r,e(this,De).media[r],p)}),e(this,Q).getControls().getContainer().addEventListener("controlschanged",e(this,De).controls.controlschanged,p)}destroy(){Object.keys(e(this,De).media).forEach(s=>{e(this,Q).getElement().removeEventListener(s,e(this,De).media[s])}),e(this,Q).getControls().getContainer().removeEventListener("controlschanged",e(this,De).controls.controlschanged),e(this,fe).remove();const{showCurrentTimeOnly:t}=e(this,Q).getOptions().progress||{};t||(e(this,$e).remove(),e(this,oe).remove()),e(this,Ge).remove()}}Q=new WeakMap,fe=new WeakMap,$e=new WeakMap,oe=new WeakMap,Ge=new WeakMap,De=new WeakMap,gs=new WeakMap,_s=new WeakMap;class ti{constructor(t,s,i){h(this,U,void 0),h(this,V,void 0),h(this,re,void 0),h(this,Qe,void 0),h(this,ge,void 0),h(this,le,{button:{},media:{},slider:{}}),h(this,nt,void 0),h(this,Gt,void 0),h(this,bs,void 0),o(this,U,t),o(this,nt,e(this,U).getMedia().volume),o(this,Gt,s),o(this,bs,i),this._enterSpaceKeyEvent=this._enterSpaceKeyEvent.bind(this)}create(){const{labels:t}=e(this,U).getOptions();o(this,re,document.createElement("div")),e(this,re).className=`op-controls__volume op-control__${e(this,Gt)}`,e(this,re).tabIndex=0,e(this,re).setAttribute("aria-valuemin","0"),e(this,re).setAttribute("aria-valuemax","100"),e(this,re).setAttribute("aria-valuenow",`${e(this,nt)}`),e(this,re).setAttribute("aria-valuetext",`${t?.volume||""}: ${e(this,nt)}`),e(this,re).setAttribute("aria-orientation","vertical"),e(this,re).setAttribute("aria-label",t?.volumeSlider||""),e(this,re).setAttribute("role","slider"),o(this,ge,document.createElement("input")),e(this,ge).type="range",e(this,ge).className="op-controls__volume--input",e(this,ge).tabIndex=-1,e(this,ge).value=e(this,U).getMedia().volume.toString(),e(this,ge).setAttribute("min","0"),e(this,ge).setAttribute("max","1"),e(this,ge).setAttribute("step","0.1"),e(this,ge).setAttribute("aria-label",t?.volumeControl||""),o(this,Qe,document.createElement("progress")),e(this,Qe).className="op-controls__volume--display",e(this,Qe).setAttribute("max","10"),e(this,Qe).value=e(this,U).getMedia().volume*10,e(this,re).appendChild(e(this,ge)),e(this,re).appendChild(e(this,Qe)),o(this,V,document.createElement("button")),e(this,V).type="button",e(this,V).className=`op-controls__mute op-control__${e(this,Gt)}`,e(this,V).tabIndex=0,e(this,V).title=t?.mute||"",e(this,V).setAttribute("aria-controls",e(this,U).id),e(this,V).setAttribute("aria-pressed","false"),e(this,V).setAttribute("aria-label",t?.mute||"");const s=a=>{const l=a.volume*1,r=Math.floor(l*100);e(this,ge).value=`${a.volume}`,e(this,Qe).value=l*10,e(this,re).setAttribute("aria-valuenow",`${r}`),e(this,re).setAttribute("aria-valuetext",`${t?.volume}: ${r}`)},i=a=>{const l=a.volume;l<=.5&&l>0?(e(this,V).classList.remove("op-controls__mute--muted"),e(this,V).classList.add("op-controls__mute--half")):l===0?(e(this,V).classList.add("op-controls__mute--muted"),e(this,V).classList.remove("op-controls__mute--half")):(e(this,V).classList.remove("op-controls__mute--muted"),e(this,V).classList.remove("op-controls__mute--half"))},n=a=>{const l=e(this,U).activeElement(),r=parseFloat(a.target.value);l.volume=r,l.muted=l.volume===0,o(this,nt,r);const d=e(this,U).getContainer().querySelector(".op-player__unmute");!l.muted&&d&&d.remove();const u=y("volumechange");e(this,U).getElement().dispatchEvent(u)};if(e(this,le).media.volumechange=()=>{const a=e(this,U).activeElement();s(a),i(a)},e(this,le).media.loadedmetadata=()=>{const a=e(this,U).activeElement();a.muted&&(a.volume=0);const l=y("volumechange");e(this,U).getElement().dispatchEvent(l)},e(this,le).slider.input=n.bind(this),e(this,le).slider.change=n.bind(this),e(this,le).button.click=()=>{e(this,V).setAttribute("aria-pressed","true");const a=e(this,U).activeElement();a.muted=!a.muted,a.muted?(a.volume=0,e(this,V).title=t?.unmute||"",e(this,V).setAttribute("aria-label",t?.unmute||"")):(a.volume=e(this,nt),e(this,V).title=t?.mute||"",e(this,V).setAttribute("aria-label",t?.mute||""));const l=y("volumechange");e(this,U).getElement().dispatchEvent(l)},e(this,V).addEventListener("click",e(this,le).button.click,p),Object.keys(e(this,le).media).forEach(a=>{e(this,U).getElement().addEventListener(a,e(this,le).media[a],p)}),Object.keys(e(this,le).slider).forEach(a=>{e(this,ge).addEventListener(a,e(this,le).slider[a],p)}),e(this,U).getContainer().addEventListener("keydown",this._enterSpaceKeyEvent,p),!pe&&!_e||!e(this,U).getOptions().useDeviceVolume){const a=e(this,U).getControls().getLayer(e(this,bs));a.appendChild(e(this,V)),a.appendChild(e(this,re))}}destroy(){e(this,V).removeEventListener("click",e(this,le).button.click),Object.keys(e(this,le).media).forEach(t=>{e(this,U).getElement().removeEventListener(t,e(this,le).media[t])}),Object.keys(e(this,le).slider).forEach(t=>{e(this,ge).removeEventListener(t,e(this,le).slider[t])}),e(this,U).getContainer().removeEventListener("keydown",this._enterSpaceKeyEvent),e(this,ge).remove(),e(this,Qe).remove(),e(this,re).remove()}_enterSpaceKeyEvent(t){var s;const i=t.which||t.keyCode||0,n=e(this,U).activeElement();((s=document?.activeElement)==null?void 0:s.classList.contains("op-controls__mute"))&&(i===13||i===32)&&(n.muted=!n.muted,n.volume=n.muted?0:e(this,nt),e(this,le).button.click(),t.preventDefault(),t.stopPropagation())}}U=new WeakMap,V=new WeakMap,re=new WeakMap,Qe=new WeakMap,ge=new WeakMap,le=new WeakMap,nt=new WeakMap,Gt=new WeakMap,bs=new WeakMap;class si{constructor(t){h(this,Qt,void 0),h(this,yt,void 0),h(this,he,void 0),h(this,b,void 0),h(this,Te,void 0),h(this,ys,void 0),this.events={media:{},mouse:{}},o(this,yt,0),o(this,ys,{Captions:Gs,Fullscreen:js,Levels:Ys,Play:Js,Progress:Zs,Settings:qs,Time:ei,Volume:ti}),o(this,b,t),this._setElements()}create(){e(this,b).getElement().controls=!1;const t=Re(e(this,b).getElement());this._createControlsLayer(),this._buildElements(),this.events.controlschanged=()=>{this.destroy(),this._setElements(),this.create()},this.events.ended=()=>{e(this,b).getContainer().classList.remove("op-controls--hidden")},e(this,b).getElement().addEventListener("controlschanged",this.events.controlschanged,p),e(this,b).getElement().addEventListener("ended",this.events.ended,p);const{alwaysVisible:s}=e(this,b).getOptions().controls||{};if(!s){const i=()=>{t&&(e(this,b).getContainer().classList.remove("op-controls--hidden"),this._stopControlTimer())};this.events.mouse.mouseenter=()=>{t&&!e(this,b).activeElement().paused&&(this._stopControlTimer(),e(this,b).activeElement().currentTime?(e(this,b).playBtn.setAttribute("aria-hidden",e(this,b).isMedia()?"false":"true"),e(this,b).loader.setAttribute("aria-hidden","true")):e(this,b).getOptions().showLoaderOnInit&&(e(this,b).playBtn.setAttribute("aria-hidden","true"),e(this,b).loader.setAttribute("aria-hidden","false")),e(this,b).getContainer().classList.remove("op-controls--hidden"),this._startControlTimer(2500))},this.events.mouse.mousemove=()=>{t&&!e(this,b).activeElement().paused&&(e(this,b).activeElement().currentTime?(e(this,b).loader.setAttribute("aria-hidden","true"),e(this,b).playBtn.setAttribute("aria-hidden",e(this,b).isMedia()?"false":"true")):(e(this,b).playBtn.setAttribute("aria-hidden",e(this,b).getOptions().showLoaderOnInit?"true":"false"),e(this,b).loader.setAttribute("aria-hidden",e(this,b).getOptions().showLoaderOnInit?"false":"true")),e(this,b).getContainer().classList.remove("op-controls--hidden"),this._startControlTimer(2500))},this.events.mouse.mouseleave=()=>{t&&!e(this,b).activeElement().paused&&this._startControlTimer(1e3)},this.events.media.play=()=>{t&&this._startControlTimer(e(this,b).getOptions().hidePlayBtnTimer||350)},this.events.media.loadedmetadata=i.bind(this),this.events.media.pause=i.bind(this),this.events.media.waiting=i.bind(this),this.events.media.stalled=i.bind(this),this.events.media.playererror=i.bind(this),Object.keys(this.events.media).forEach(n=>{e(this,b).getElement().addEventListener(n,this.events.media[n],p)}),pe||_e?e(this,b).getContainer().addEventListener("click",this.events.mouse.mouseenter,p):Object.keys(this.events.mouse).forEach(n=>{e(this,b).getContainer().addEventListener(n,this.events.mouse[n],p)}),t&&!e(this,b).activeElement().paused&&this._startControlTimer(3e3)}}destroy(){!pe&&!_e&&(Object.keys(this.events.mouse).forEach(t=>{e(this,b).getContainer().removeEventListener(t,this.events.mouse[t])}),Object.keys(this.events.media).forEach(t=>{e(this,b).getElement().removeEventListener(t,this.events.media[t])}),this._stopControlTimer()),e(this,b).getElement().removeEventListener("controlschanged",this.events.controlschanged),e(this,b).getElement().removeEventListener("ended",this.events.ended),Object.keys(e(this,Te)).forEach(t=>{e(this,Te)[t].forEach(s=>{s.custom?this._destroyCustomElement(s):typeof s.destroy=="function"&&s.destroy()})}),e(this,he).remove()}getContainer(){return e(this,he)}getLayer(t){return e(this,he).querySelector(`.op-controls-layer__${t}`)||e(this,he)}_createControlsLayer(){if(!e(this,he)||!e(this,b).getContainer().querySelector(".op-controls")){o(this,he,document.createElement("div")),e(this,he).className="op-controls",e(this,b).getContainer().appendChild(e(this,he));const t=document.createElement("div");t.className="op-status",t.innerHTML="<span></span>",t.tabIndex=-1,t.setAttribute("aria-hidden","true"),me(e(this,b).getElement())&&e(this,he).appendChild(t)}}_startControlTimer(t){const s=e(this,b).activeElement();this._stopControlTimer(),typeof window<"u"&&o(this,yt,window.setTimeout(()=>{if((!s.paused||!s.ended)&&Re(e(this,b).getElement())){e(this,b).getContainer().classList.add("op-controls--hidden"),e(this,b).playBtn.setAttribute("aria-hidden","true"),this._stopControlTimer();const i=y("controlshidden");e(this,b).getElement().dispatchEvent(i)}},t))}_stopControlTimer(){e(this,yt)!==0&&(clearTimeout(e(this,yt)),o(this,yt,0))}_setElements(){var t;const s=((t=e(this,b).getOptions().controls)==null?void 0:t.layers)||{};o(this,Te,{"bottom-left":[],"bottom-middle":[],"bottom-right":[],left:[],main:[],middle:[],right:[],"top-left":[],"top-middle":[],"top-right":[]});const i=Re(e(this,b).getElement()),n=me(e(this,b).getElement()),a=Object.keys(s),l=a.find(r=>/^(top|bottom)/.test(r));this._createControlsLayer(),a.forEach(r=>{const[d,u]=r.split("-");if(u){e(this,he).classList.contains("op-controls__stacked")||e(this,he).classList.add("op-controls__stacked");const m=`op-controls-layer__${d}`;if(!e(this,he).querySelector(`.${m}`)){const c=document.createElement("div");c.className=m,e(this,he).appendChild(c)}}else if(l){const m="op-controls-layer__center";if(!e(this,he).querySelector(`.${m}`)){const c=document.createElement("div");c.className=m,e(this,he).appendChild(c)}}const A=s?s[r]:null;A&&A.filter((m,c,v)=>v.indexOf(m)===c).forEach(m=>{const c=l&&!u?"center":d,v=`${m.charAt(0).toUpperCase()}${m.slice(1)}`,L=new(e(this,ys))[v](e(this,b),u||d,c);m==="settings"&&o(this,Qt,L),(i||m!=="fullscreen"&&n)&&e(this,Te)[r].push(L)})}),e(this,b).getCustomControls().forEach(r=>{const[d,u]=r.position.split("-"),A=l&&!u?"center":d;r.layer=A,r.position=u||d,typeof r.index=="number"?e(this,Te)[r.position].splice(r.index,0,r):r.position==="right"?e(this,Te)[r.position].unshift(r):e(this,Te)[r.position].push(r)})}_buildElements(){Object.keys(e(this,Te)).forEach(s=>{e(this,Te)[s].forEach(i=>{i.custom?this._createCustomElement(i):i.create()})}),Object.keys(e(this,Te)).forEach(s=>{e(this,Te)[s].forEach(i=>{const n=!e(this,b).getOptions().detachMenus||i instanceof qs,a=i;if(n&&!a.custom&&typeof a.addSettings=="function"){const l=a.addSettings();e(this,Qt)&&Object.keys(l).length&&e(this,Qt).addItem(l.name,l.key,l.default,l.subitems,l.className)}})});const t=y("controlschanged");e(this,he).dispatchEvent(t)}_hideCustomMenu(t){let s;s&&typeof window<"u"&&window.cancelAnimationFrame(s),typeof window<"u"&&(s=window.requestAnimationFrame(()=>{t.setAttribute("aria-hidden","true")}))}_toggleCustomMenu(t,s,i){e(this,b).getContainer().querySelectorAll(".op-settings").forEach(a=>{a.getAttribute("aria-hidden")==="false"&&a.id!==s.id&&a.setAttribute("aria-hidden","true")}),s.setAttribute("aria-hidden",s.getAttribute("aria-hidden")==="true"?"false":"true"),typeof i.click=="function"&&i.click(t)}_createCustomElement(t){const s=document.createElement(t.type);if(s.tabIndex=0,s.id=t.id,s.className=`op-controls__${t.id} op-control__${t.position} ${t.showInAds?"":"op-control__hide-in-ad"}`,t.styles&&Object.assign(s.style,t.styles),t.type==="button"&&t.icon?s.innerHTML=/\.(jpg|png|svg|gif)$/.test(t.icon)?`<img src="${Ne(t.icon)}"${t.alt?`alt="${Ne(t.alt)}"`:""}>`:Ne(t.icon):t.content&&(s.innerHTML=Ne(t.content,!1)),t.type==="button"&&t.title&&(s.title=Ne(t.title)),t.type==="img"&&t.alt&&(s.alt=Ne(t.alt)),t.type!=="button"&&t.click&&typeof t.click=="function"&&s.setAttribute("aria-role","button"),t.type==="button"&&t.subitems&&Array.isArray(t.subitems)&&t.subitems.length>0){const i=document.createElement("div");i.className="op-settings op-settings__custom",i.id=`${t.id}-menu`,i.setAttribute("aria-hidden","true");const n=t.subitems.map(a=>{let l="";return a.icon&&(l=/\.(jpg|png|svg|gif)$/.test(a.icon)?`<img src="${Ne(a.icon)}"${a.alt?`alt="${Ne(a.alt)}"`:""}>`:Ne(a.icon,!1)),`<div class="op-settings__menu-item" tabindex="0" ${a.title?`title="${a.title}"`:""} role="menuitemradio">
                    <div class="op-settings__menu-label" id="${a.id}" data-value="${t.id}-${a.id}">${l} ${a.label}</div>
                </div>`});i.innerHTML=`<div class="op-settings__menu" role="menu">${n.join("")}</div>`,e(this,b).getContainer().appendChild(i),t.subitems.forEach(a=>{const l=i.querySelector(`#${a.id}`);l&&a.click&&typeof a.click=="function"&&l.addEventListener("click",a.click,p)}),s.addEventListener("click",a=>this._toggleCustomMenu(a,i,t),p),e(this,b).getElement().addEventListener("controlshidden",()=>this._hideCustomMenu(i),p)}else t.click&&typeof t.click=="function"&&s.addEventListener("click",t.click,p);t.mouseenter&&typeof t.mouseenter=="function"&&s.addEventListener("mouseenter",t.mouseenter,p),t.mouseleave&&typeof t.mouseleave=="function"&&s.addEventListener("mouseleave",t.mouseleave,p),t.keydown&&typeof t.keydown=="function"&&s.addEventListener("keydown",t.keydown,p),t.blur&&typeof t.blur=="function"&&s.addEventListener("blur",t.blur,p),t.focus&&typeof t.focus=="function"&&s.addEventListener("focus",t.focus,p),t.layer&&(t.layer==="main"?e(this,b).getContainer().appendChild(s):this.getLayer(t.layer).appendChild(s)),t.init&&typeof t.init=="function"&&t.init(e(this,b))}_destroyCustomElement(t){const s=this.getContainer().querySelector(`.op-controls__${t.id}`);if(s){if(t.subitems&&Array.isArray(t.subitems)&&t.subitems.length>0){const i=e(this,b).getContainer().querySelector(`#${t.id}-menu`);i&&(t.subitems.forEach(n=>{const a=i.querySelector(`#${n.id}`);a&&n.click&&typeof n.click=="function"&&a.removeEventListener("click",n.click)}),s.removeEventListener("click",n=>this._toggleCustomMenu(n,i,t)),e(this,b).getElement().removeEventListener("controlshidden",()=>this._hideCustomMenu(i)),i.remove())}t.click&&typeof t.click=="function"&&s.removeEventListener("click",t.click),t.mouseenter&&typeof t.mouseenter=="function"&&s.removeEventListener("mouseenter",t.mouseenter),t.mouseleave&&typeof t.mouseleave=="function"&&s.removeEventListener("mouseleave",t.mouseleave),t.keydown&&typeof t.keydown=="function"&&s.removeEventListener("keydown",t.keydown),t.blur&&typeof t.blur=="function"&&s.removeEventListener("blur",t.blur),t.focus&&typeof t.focus=="function"&&s.removeEventListener("focus",t.focus),s.remove(),t.destroy&&typeof t.destroy=="function"&&t.destroy(e(this,b))}}}Qt=new WeakMap,yt=new WeakMap,he=new WeakMap,b=new WeakMap,Te=new WeakMap,ys=new WeakMap;class Os{constructor(t,s){h(this,Es,void 0),this.element=t,this.media=s,this.promise=new Promise(i=>{i()})}set instance(t){o(this,Es,t)}get instance(){return e(this,Es)}play(){return this.element.play()}pause(){this.element.pause()}set volume(t){this.element.volume=t}get volume(){return this.element.volume}set muted(t){this.element.muted=t}get muted(){return this.element.muted}set playbackRate(t){this.element.playbackRate=t}get playbackRate(){return this.element.playbackRate}set defaultPlaybackRate(t){this.element.defaultPlaybackRate=t}get defaultPlaybackRate(){return this.element.defaultPlaybackRate}set currentTime(t){this.element.currentTime=t}get currentTime(){return this.element.currentTime}get duration(){return this.element.duration}get paused(){return this.element.paused}get ended(){return this.element.ended}}Es=new WeakMap;class ii extends Os{constructor(t,s,i){super(t,s),h(this,X,void 0),h(this,Se,{}),h(this,ks,{}),o(this,ks,i),this._assign=this._assign.bind(this),this._preparePlayer=this._preparePlayer.bind(this),this.promise=typeof dashjs>"u"?Ts("https://cdn.dashjs.org/latest/dash.all.min.js"):new Promise(n=>{n({})}),this.promise.then(()=>{o(this,X,dashjs.MediaPlayer().create()),this.instance=e(this,X)})}canPlayType(t){return Fs&&t==="application/dash+xml"}load(){this._preparePlayer(),e(this,X).attachSource(this.media.src);const t=y("loadedmetadata");this.element.dispatchEvent(t),e(this,Se)||(o(this,Se,dashjs.MediaPlayer.events),Object.keys(e(this,Se)).forEach(s=>{e(this,X).on(e(this,Se)[s],this._assign)}))}destroy(){e(this,Se)&&(Object.keys(e(this,Se)).forEach(t=>{e(this,X).off(e(this,Se)[t],this._assign)}),o(this,Se,[])),e(this,X).reset()}set src(t){Ns(t)&&(this.destroy(),o(this,X,dashjs.MediaPlayer().create()),this._preparePlayer(),e(this,X).attachSource(t.src),o(this,Se,dashjs.MediaPlayer.events),Object.keys(e(this,Se)).forEach(s=>{e(this,X).on(e(this,Se)[s],this._assign)}))}get levels(){const t=[];if(e(this,X)){const s=e(this,X).getBitrateInfoListFor("video");s.length&&s.forEach(i=>{if(s[i]){const{height:n,name:a}=s[i],l={height:n,id:`${i}`,label:a||null};t.push(l)}})}return t}set level(t){t==="0"?e(this,X).setAutoSwitchQuality(!0):(e(this,X).setAutoSwitchQuality(!1),e(this,X).setQualityFor("video",t))}get level(){return e(this,X)?e(this,X).getQualityFor("video"):"-1"}_assign(t){if(t.type==="error"){const i=y("playererror",{detail:{message:t,type:"M(PEG)-DASH"}});this.element.dispatchEvent(i)}else{const s=y(t.type,{detail:t});this.element.dispatchEvent(s)}}_preparePlayer(){e(this,X).updateSettings({debug:{logLevel:dashjs.Debug.LOG_LEVEL_NONE},streaming:{fastSwitchEnabled:!0,scheduleWhilePaused:!1},...e(this,ks)||{}}),e(this,X).initialize(),e(this,X).attachView(this.element),e(this,X).setAutoPlay(!1)}}X=new WeakMap,Se=new WeakMap,ks=new WeakMap;class ni extends Os{constructor(t,s,i){super(t,s),h(this,ee,void 0),h(this,Fe,{}),h(this,As,{}),o(this,As,i),this.element=t,this.media=s,this._create=this._create.bind(this),this._assign=this._assign.bind(this),this.promise=typeof flvjs>"u"?Ts("https://cdn.jsdelivr.net/npm/flv.js@latest/dist/flv.min.js"):new Promise(n=>{n({})}),this.promise.then(this._create)}canPlayType(t){return Fs&&(t==="video/x-flv"||t==="video/flv")}load(){e(this,ee).unload(),e(this,ee).detachMediaElement(),e(this,ee).attachMediaElement(this.element),e(this,ee).load();const t=y("loadedmetadata");this.element.dispatchEvent(t),e(this,Fe)||(o(this,Fe,flvjs.Events),Object.keys(e(this,Fe)).forEach(s=>{e(this,ee).on(e(this,Fe)[s],(...i)=>this._assign(e(this,Fe)[s],i))}))}destroy(){e(this,ee).destroy(),o(this,ee,null)}set src(t){Hs(t)&&(this.destroy(),this._create())}get levels(){const t=[];return e(this,ee)&&e(this,ee).levels&&e(this,ee).levels.length&&Object.keys(e(this,ee).levels).forEach(s=>{const{height:i,name:n}=e(this,ee).levels[s],a={height:i,id:s,label:n||null};t.push(a)}),t}set level(t){e(this,ee).currentLevel=t}get level(){return e(this,ee)?e(this,ee).currentLevel:"-1"}_create(){const{configs:t,...s}=e(this,As)||{};flvjs.LoggingControl.enableDebug=s?.debug||!1,flvjs.LoggingControl.enableVerbose=s?.debug||!1;const i={...s,type:"flv",url:this.media.src};o(this,ee,flvjs.createPlayer(i,t||{})),this.instance=e(this,ee),e(this,Fe)||(o(this,Fe,flvjs.Events),Object.keys(e(this,Fe)).forEach(n=>{e(this,ee).on(e(this,Fe)[n],(...a)=>this._assign(e(this,Fe)[n],a))}))}_assign(t,s){if(t==="error"){const i={detail:{data:s,message:`${s[0]}: ${s[1]} ${s[2].msg}`,type:"FLV"}},n=y("playererror",i);this.element.dispatchEvent(n)}else{const i=y(t,{detail:{data:s}});this.element.dispatchEvent(i)}}}ee=new WeakMap,Fe=new WeakMap,As=new WeakMap;class ai extends Os{constructor(t,s,i,n){super(t,s),h(this,O,void 0),h(this,ie,{}),h(this,Xt,0),h(this,Yt,0),h(this,Wt,void 0),h(this,Ls,void 0),o(this,Wt,n||{}),this.element=t,this.media=s,o(this,Ls,i),this._create=this._create.bind(this),this._play=this._play.bind(this),this._pause=this._pause.bind(this),this._assign=this._assign.bind(this),this.promise=typeof Hls>"u"?Ts("https://cdn.jsdelivr.net/npm/hls.js@latest/dist/hls.min.js"):new Promise(a=>{a({})}),this.promise.then(this._create)}canPlayType(t){return zs()&&t==="application/x-mpegURL"}load(){e(this,O)&&(e(this,O).detachMedia(),e(this,O).loadSource(this.media.src),e(this,O).attachMedia(this.element));const t=y("loadedmetadata");this.element.dispatchEvent(t),e(this,ie)||(o(this,ie,Hls.Events),Object.keys(e(this,ie)).forEach(s=>{e(this,O).on(e(this,ie)[s],(...i)=>this._assign(e(this,ie)[s],i))}))}destroy(){e(this,O)&&e(this,O).stopLoad(),e(this,ie)&&Object.keys(e(this,ie)).forEach(t=>{e(this,O).off(e(this,ie)[t],(...s)=>this._assign(e(this,ie)[t],s))}),this.element.removeEventListener("play",this._play),this.element.removeEventListener("pause",this._pause),e(this,O)&&(e(this,O).destroy(),o(this,O,null))}set src(t){Ss(t)&&(this.destroy(),o(this,O,new Hls(e(this,Wt))),e(this,O).loadSource(t.src),e(this,O).attachMedia(this.element),o(this,ie,Hls.Events),Object.keys(e(this,ie)).forEach(s=>{e(this,O).on(e(this,ie)[s],(...i)=>this._assign(e(this,ie)[s],i))}))}get levels(){const t=[];return e(this,O)&&e(this,O).levels&&e(this,O).levels.length&&Object.keys(e(this,O).levels).forEach(s=>{const{height:i,name:n}=e(this,O).levels[s],a={height:i,id:s,label:n||null};t.push(a)}),t}set level(t){const s=Number(t);s&&s>-1?e(this,O).loadLevel=s:e(this,O).currentLevel=s}get level(){return e(this,O)?e(this,O).currentLevel:"-1"}_create(){const t=!!(this.element.preload==="auto"||e(this,Ls));e(this,Wt).autoStartLoad=t,o(this,O,new Hls(e(this,Wt))),this.instance=e(this,O),o(this,ie,Hls.Events),Object.keys(e(this,ie)).forEach(s=>{e(this,O).on(e(this,ie)[s],(...i)=>this._assign(e(this,ie)[s],i))}),t||(this.element.addEventListener("play",this._play,p),this.element.addEventListener("pause",this._pause,p))}_assign(t,s){if(t==="hlsError"){const i={detail:{data:s,message:s[1].details,type:"HLS"}},n=y("playererror",i);this.element.dispatchEvent(n);const a=s[1].type,{fatal:l}=s[1],r=s[1];if(l)switch(a){case"mediaError":const d=new Date().getTime();if(!e(this,Xt)||d-e(this,Xt)>3e3)o(this,Xt,new Date().getTime()),e(this,O).recoverMediaError();else if(!e(this,Yt)||d-e(this,Yt)>3e3)o(this,Yt,new Date().getTime()),console.warn("Attempting to swap Audio Codec and recover from media error"),e(this,O).swapAudioCodec(),e(this,O).recoverMediaError();else{console.error("Cannot recover, last media error recovery failed");const v=y(a,{detail:{data:r}});this.element.dispatchEvent(v)}break;case"networkError":console.error("Network error");const A=y(a,{detail:{data:r}});this.element.dispatchEvent(A);break;default:e(this,O).destroy();const m=y(a,{detail:{data:r}});this.element.dispatchEvent(m);break}else{const d=y(a,{detail:{data:r}});this.element.dispatchEvent(d)}}else{const i=s[1];if(t==="hlsLevelLoaded"&&i.live===!0){this.element.setAttribute("op-live__enabled","true");const a=y("timeupdate");this.element.dispatchEvent(a)}else if(t==="hlsLevelUpdated"&&i.live===!0&&i.totalduration>Bs){this.element.setAttribute("op-dvr__enabled","true");const a=y("timeupdate");this.element.dispatchEvent(a)}else if(t==="hlsFragParsingMetadata"){const a=y("metadataready",{detail:{data:s[1]}});this.element.dispatchEvent(a)}const n=y(t,{detail:{data:s[1]}});this.element.dispatchEvent(n)}}_play(){e(this,O)&&e(this,O).startLoad()}_pause(){e(this,O)&&e(this,O).stopLoad()}}O=new WeakMap,ie=new WeakMap,Xt=new WeakMap,Yt=new WeakMap,Wt=new WeakMap,Ls=new WeakMap;class Ws extends Os{constructor(t,s){if(super(t,s),h(this,Jt,void 0),h(this,Pt,[]),h(this,ws,!1),h(this,It,0),h(this,Rt,!1),h(this,Nt,void 0),!me(t)&&!Re(t))throw new TypeError("Native method only supports video/audio tags");this._clearTimeout=this._clearTimeout.bind(this),this._setTimeout=this._setTimeout.bind(this),this._dispatchError=this._dispatchError.bind(this),this._isDvrEnabled=this._isDvrEnabled.bind(this),this._readMediadataInfo=this._readMediadataInfo.bind(this),o(this,ws,Ss(s)),this.element.addEventListener("playing",this._clearTimeout,p),this.element.addEventListener("stalled",this._setTimeout,p),this.element.addEventListener("error",this._dispatchError,p),this.element.addEventListener("loadeddata",this._isDvrEnabled,p),this.element.textTracks.addEventListener("addtrack",this._readMediadataInfo,p)}canPlayType(t){return!!this.element.canPlayType(t).replace("no","")}load(){this.element.load()}destroy(){this.element.removeEventListener("playing",this._clearTimeout),this.element.removeEventListener("stalled",this._setTimeout),this.element.removeEventListener("error",this._dispatchError),this.element.removeEventListener("loadeddata",this._isDvrEnabled),this.element.textTracks.removeEventListener("addtrack",this._readMediadataInfo)}get levels(){if(!e(this,Pt).length){const t=this.element.querySelectorAll("source[title]");for(let s=0,i=t.length;s<i;++s){const n={height:0,id:`${s}`,label:t[s].getAttribute("title")||""};e(this,Pt).push(n)}}return e(this,Pt)}set level(t){const s=e(this,Pt).findIndex(i=>i.id===t);if(s>-1){o(this,Jt,this.levels[s]);const i=this.element.querySelectorAll("source[title]");for(let n=0,a=i.length;n<a;++n){const l=i[n].getAttribute("src");l&&parseInt(e(this,Jt).id,10)===n&&(this.element.src=l)}}}get level(){var t;return((t=e(this,Jt))==null?void 0:t.id)||"-1"}set src(t){this.element.src=t.src}_isDvrEnabled(){const t=this.element.seekable.end(this.element.seekable.length-1)-this.element.seekable.start(0);if(e(this,ws)&&t>Bs&&!this.element.getAttribute("op-dvr__enabled")){this.element.setAttribute("op-dvr__enabled","true");const s=y("timeupdate");this.element.dispatchEvent(s)}}_readMediadataInfo(t){var s;const i=t;((s=i?.track)==null?void 0:s.kind)==="metadata"&&(i.track.mode="hidden",i.track.addEventListener("cuechange",n=>{const a=n.target,l=a.activeCues?a.activeCues[0]:null;if(l){const r=y("metadataready",{detail:l});this.element.dispatchEvent(r)}},p))}_setTimeout(){!e(this,Rt)&&window!==void 0&&(o(this,Rt,!0),o(this,Nt,window.setInterval(()=>{if(e(this,It)>=30){clearInterval(e(this,Nt));const t="Media download failed part-way due to a network error",i=y("playererror",{detail:{data:{message:t,error:2},message:t,type:"HTML5"}});this.element.dispatchEvent(i),o(this,It,0),o(this,Rt,!1)}else Rs(this,It)._++},1e3)))}_clearTimeout(){e(this,Nt)&&(clearInterval(e(this,Nt)),o(this,It,0),o(this,Rt,!1))}_dispatchError(t){let s;const i=t.target,n=i?.error;switch(n?.code){case n?.MEDIA_ERR_ABORTED:s="Media playback aborted";break;case n?.MEDIA_ERR_NETWORK:s="Media download failed part-way due to a network error";break;case n?.MEDIA_ERR_DECODE:s=`Media playback aborted due to a corruption problem or because the
                    media used features your browser did not support.`;break;case n?.MEDIA_ERR_SRC_NOT_SUPPORTED:s=`Media could not be loaded, either because the server or network failed
                    or because the format is not supported.`;break;default:s="Unknown error occurred.";break}const a={detail:{data:{...t,message:s,error:n?.code},message:s,type:"HTML5"}},l=y("playererror",a);this.element.dispatchEvent(l)}}Jt=new WeakMap,Pt=new WeakMap,ws=new WeakMap,It=new WeakMap,Rt=new WeakMap,Nt=new WeakMap;class ns{constructor(t,s,i,n){h(this,P,void 0),h(this,k,void 0),h(this,de,void 0),h(this,xt,void 0),h(this,Xe,void 0),h(this,Zt,void 0),h(this,at,!1),h(this,Et,{media:{},optionsKey:{},rules:[]}),h(this,$t,void 0),o(this,P,t),o(this,Xe,s),o(this,de,this._getMediaFiles()),o(this,Et,n),o(this,Zt,i)}canPlayType(t){return e(this,k).canPlayType(t)}async load(){if(!e(this,at)){if(o(this,at,!0),!e(this,de).length)throw new TypeError("Media not set");e(this,k)&&typeof e(this,k).destroy=="function"&&(e(this,de).length===1&&e(this,de)[0].src===e(this,k).media.src||e(this,k).destroy()),e(this,de).some(t=>{try{o(this,k,this._invoke(t))}catch{o(this,k,new Ws(e(this,P),t))}return e(this,k).canPlayType(t.type)});try{if(e(this,k)===null)throw new TypeError("Media cannot be played with any valid media type");await e(this,k).promise,e(this,k).load()}catch(t){throw e(this,k)&&e(this,k).destroy(),t}}}async play(){return e(this,at)?await e(this,k).promise:(await this.load(),o(this,at,!1)),o(this,xt,e(this,k).play()),e(this,xt)}async pause(){e(this,xt)!==void 0&&await e(this,xt),e(this,k).pause()}destroy(){e(this,k)&&e(this,k).destroy()}set src(t){if(typeof t=="string"?e(this,de).push({src:t,type:is(t,e(this,P))}):Array.isArray(t)?o(this,de,t):typeof t=="object"&&e(this,de).push(t),o(this,de,e(this,de).filter(s=>s.src)),e(this,de).length>0){const[s]=e(this,de);e(this,P).src&&e(this,P).setAttribute("data-op-file",e(this,de)[0].src),e(this,P).src=s.src,o(this,$t,s),e(this,k)&&(e(this,k).src=s)}else e(this,P).src=""}get src(){return e(this,de)}get current(){return e(this,$t)}set mediaFiles(t){o(this,de,t)}get mediaFiles(){return e(this,de)}set volume(t){e(this,k)&&(e(this,k).volume=t)}get volume(){return e(this,k)?e(this,k).volume:e(this,P).volume}set muted(t){e(this,k)&&(e(this,k).muted=t)}get muted(){return e(this,k)?e(this,k).muted:e(this,P).muted}set playbackRate(t){e(this,k)&&(e(this,k).playbackRate=t)}get playbackRate(){return e(this,k)?e(this,k).playbackRate:e(this,P).playbackRate}set defaultPlaybackRate(t){e(this,k)&&(e(this,k).defaultPlaybackRate=t)}get defaultPlaybackRate(){return e(this,k)?e(this,k).defaultPlaybackRate:e(this,P).defaultPlaybackRate}set currentTime(t){e(this,k)&&(e(this,k).currentTime=t)}get currentTime(){return e(this,k)?e(this,k).currentTime:e(this,P).currentTime}get duration(){const t=e(this,k)?e(this,k).duration:e(this,P).duration;return t===1/0&&e(this,P).seekable&&e(this,P).seekable.length?e(this,P).seekable.end(0):t}get paused(){return e(this,k)?e(this,k).paused:e(this,P).paused}get ended(){return e(this,k)?e(this,k).ended:e(this,P).ended}set loaded(t){o(this,at,t)}get loaded(){return e(this,at)}set level(t){e(this,k)&&(e(this,k).level=t)}get level(){return e(this,k)?e(this,k).level:-1}get levels(){return e(this,k)?e(this,k).levels:[]}get instance(){return e(this,k)?e(this,k).instance:null}_getMediaFiles(){const t=[],s=e(this,P).querySelectorAll("source"),i=e(this,P).src;i&&t.push({src:i,type:e(this,P).getAttribute("type")||is(i,e(this,P))});for(let n=0,a=s.length;n<a;n++){const l=s[n],{src:r}=l;if(t.push({src:r,type:l.getAttribute("type")||is(r,e(this,P))}),n===0){const[d]=t;o(this,$t,d)}}return t.length||t.push({src:"",type:is("",e(this,P))}),t}_invoke(t){var s,i,n;const a=e(this,P).canPlayType("application/vnd.apple.mpegurl")||e(this,P).canPlayType("application/x-mpegURL");o(this,$t,t);const{layers:l}=e(this,Xe).controls||{};let r=!1;if(l&&Object.keys(l).forEach(d=>{const u=l?l[d]:null;u&&u.indexOf("levels")>-1&&(r=!0)}),Object.keys(e(this,Et).media).length){let d;return e(this,Et).rules.forEach(u=>{const A=u(t.src);if(A){const m=e(this,Et).media[A],c=e(this,Xe)[e(this,Et).optionsKey[A]]||void 0;d=m(e(this,P),t,e(this,Zt),c)}}),d?(d.create(),d):new Ws(e(this,P),t)}if(Ss(t)){if(a&&e(this,Xe).forceNative&&!r)return new Ws(e(this,P),t);const d=((s=e(this,Xe))==null?void 0:s.hls)||void 0;return new ai(e(this,P),t,e(this,Zt),d)}if(Ns(t)){const d=((i=e(this,Xe))==null?void 0:i.dash)||void 0;return new ii(e(this,P),t,d)}if(Hs(t)){const d=((n=e(this,Xe))==null?void 0:n.flv)||{debug:!1,type:"flv",url:t.src};return new ni(e(this,P),t,d)}return new Ws(e(this,P),t)}}P=new WeakMap,k=new WeakMap,de=new WeakMap,xt=new WeakMap,Xe=new WeakMap,Zt=new WeakMap,at=new WeakMap,Et=new WeakMap,$t=new WeakMap;class Ps{constructor(t,s,i,n,a){h(this,kt,void 0),h(this,Be,void 0),h(this,Oe,void 0),h(this,We,void 0),h(this,ot,void 0),h(this,Dt,void 0),h(this,ze,void 0),h(this,At,void 0),h(this,Ye,void 0),h(this,R,void 0),h(this,Lt,void 0),h(this,ce,void 0),h(this,f,void 0),h(this,Je,void 0),h(this,Le,void 0),h(this,Ms,void 0),h(this,Pe,void 0),h(this,ke,void 0),h(this,Ve,void 0),h(this,ne,void 0),h(this,wt,void 0),h(this,je,void 0),h(this,rt,void 0),h(this,lt,void 0),h(this,Ie,void 0),h(this,N,void 0),h(this,Ze,void 0),h(this,es,void 0),h(this,Ft,void 0),h(this,Bt,void 0),h(this,ts,void 0),h(this,Cs,void 0),h(this,et,void 0);var l,r,d,u;this.loadedAd=!1,o(this,kt,!1),o(this,Be,!1),o(this,Oe,!1),o(this,We,!1),o(this,ot,0),o(this,ze,!1),o(this,At,0),o(this,Ye,0),o(this,R,null),o(this,Je,[]),o(this,rt,!1),o(this,lt,!1),o(this,Ie,!1),o(this,Ze,0),o(this,Bt,0),o(this,ts,[]),o(this,Cs,!1),o(this,et,null);const A={autoPlayAdBreaks:!0,customClick:{enabled:!1,label:"Click here for more info"},audioSkip:{enabled:!0,label:"Skip Ad",remainingLabel:"Skip in [[secs]] seconds"},debug:!1,enablePreloading:!1,language:"en",loop:!1,numRedirects:4,publisherId:void 0,sdkPath:"https://imasdk.googleapis.com/js/sdkloader/ima3.js",sessionId:void 0,src:[],vpaidMode:"enabled"};o(this,Lt,t),o(this,Le,s),o(this,ce,t.getMedia()),o(this,f,t.getElement()),o(this,rt,i||!1),o(this,ze,t.getElement().muted),o(this,lt,n||!1),o(this,N,{...A,...a}),a?.customClick&&Object.keys(a.customClick).length&&(e(this,N).customClick={...A.customClick,...a.customClick}),o(this,Ie,!1),o(this,es,e(this,f).volume),o(this,Dt,e(this,es));const m=(l=e(this,N))!=null&&l.debug?(d=(r=e(this,N))==null?void 0:r.sdkPath)==null?void 0:d.replace(/(\.js$)/,"_debug.js"):(u=e(this,N))==null?void 0:u.sdkPath;this.load=this.load.bind(this),this.resizeAds=this.resizeAds.bind(this),this._handleClickInContainer=this._handleClickInContainer.bind(this),this._handleSkipAds=this._handleSkipAds.bind(this),this._loaded=this._loaded.bind(this),this._error=this._error.bind(this),this._assign=this._assign.bind(this),this._contentLoadedAction=this._contentLoadedAction.bind(this),this._loadedMetadataHandler=this._loadedMetadataHandler.bind(this),this._contentEndedListener=this._contentEndedListener.bind(this),this._handleResizeAds=this._handleResizeAds.bind(this),this._onContentPauseRequested=this._onContentPauseRequested.bind(this),this._onContentResumeRequested=this._onContentResumeRequested.bind(this),o(this,Ms,m&&(typeof google>"u"||typeof google.ima>"u")?Ts(m):new Promise(c=>{c()})),e(this,Ms).then(()=>{this.load()}).catch(c=>{let v="Ad script could not be loaded; please check if you have an AdBlock ";v+="turned on, or if you provided a valid URL is correct",console.error(`Ad error: ${v}.`);const M=y("playererror",{detail:{data:c,message:v,type:"Ads"}});e(this,f).dispatchEvent(M)})}load(t=!1){var s,i,n;if(typeof google>"u"||!google.ima||!t&&this.loadedAd&&e(this,N).autoPlayAdBreaks||!e(this,N).autoPlayAdBreaks&&!t)return;this.loadedAd=!0;const a=e(this,Lt).getContainer().querySelector(".op-ads");if(a&&a.parentNode&&a.parentNode.removeChild(a),o(this,We,!0),o(this,ke,document.createElement("div")),e(this,ke).className="op-ads",e(this,ke).tabIndex=-1,e(this,f).parentElement&&e(this,f).parentElement.insertBefore(e(this,ke),e(this,f).nextSibling),e(this,ke).addEventListener("click",this._handleClickInContainer),(s=e(this,N).customClick)!=null&&s.enabled&&(o(this,Ve,document.createElement("div")),e(this,Ve).className="op-ads__click-container",e(this,Ve).innerHTML=`<div class="op-ads__click-label">${e(this,N).customClick.label}</div>`,e(this,f).parentElement&&e(this,f).parentElement.insertBefore(e(this,Ve),e(this,f).nextSibling)),me(e(this,f))&&((i=e(this,N).audioSkip)!=null&&i.enabled)){if((n=e(this,N).audioSkip)!=null&&n.element){const{element:r}=e(this,N).audioSkip||{};if(typeof r=="string"){const d=document.getElementById(r);d&&o(this,ne,d)}else r instanceof HTMLElement&&o(this,ne,r)}else o(this,ne,document.createElement("button")),e(this,ne).className="op-ads__skip hidden",e(this,Lt).getControls().getContainer().appendChild(e(this,ne));e(this,ne)&&e(this,ne).addEventListener("click",this._handleSkipAds,p)}o(this,ts,e(this,ce).src);const l={disabled:google.ima.ImaSdkSettings.VpaidMode.DISABLED,enabled:google.ima.ImaSdkSettings.VpaidMode.ENABLED,insecure:google.ima.ImaSdkSettings.VpaidMode.INSECURE};google.ima.settings.setVpaidMode(l[e(this,N).vpaidMode||"enabled"]),google.ima.settings.setDisableCustomPlaybackForIOS10Plus(!0),google.ima.settings.setAutoPlayAdBreaks(e(this,N).autoPlayAdBreaks),google.ima.settings.setNumRedirects(e(this,N).numRedirects),google.ima.settings.setLocale(e(this,N).language),e(this,N).sessionId&&google.ima.settings.setSessionId(e(this,N).sessionId),e(this,N).publisherId&&google.ima.settings.setPpid(e(this,N).publisherId),google.ima.settings.setPlayerType("openplayerjs"),google.ima.settings.setPlayerVersion("3.0.0"),o(this,wt,new google.ima.AdDisplayContainer(e(this,ke),e(this,f),e(this,Ve))),o(this,Pe,new google.ima.AdsLoader(e(this,wt))),e(this,Pe).addEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,this._loaded,p),e(this,Pe).addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,this._error,p),typeof window<"u"&&window.addEventListener("resize",this._handleResizeAds,p),e(this,f).addEventListener("loadedmetadata",this._handleResizeAds,p),(e(this,rt)===!0||e(this,lt)===!0||t===!0||e(this,N).enablePreloading===!0||e(this,Ie)===!0)&&(e(this,Be)||(o(this,Be,!0),e(this,wt).initialize()),this._requestAds())}async play(){if(!e(this,Be)){o(this,Ie,!0),this._initNotDoneAds();return}if(e(this,R))try{!e(this,ot)&&e(this,Oe)===!1?e(this,R).start():e(this,R).resume(),o(this,Oe,!0);const t=y("play");e(this,f).dispatchEvent(t)}catch{this._resumeMedia()}}pause(){if(e(this,R)){o(this,Oe,!1),e(this,R).pause();const t=y("pause");e(this,f).dispatchEvent(t)}}destroy(){var t,s;e(this,R)&&(e(this,R).removeEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,this._error),e(this,Je)&&e(this,Je).forEach(l=>{e(this,R).removeEventListener(l,this._assign)})),o(this,Je,[]);const i=e(this,Lt).getControls(),n=i?i.events.mouse:{};Object.keys(n).forEach(l=>{e(this,ke)&&e(this,ke).removeEventListener(l,n[l])}),e(this,Pe)&&(e(this,Pe).removeEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,this._error),e(this,Pe).removeEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,this._loaded));const a=!Array.isArray(e(this,Le))||e(this,Ze)>e(this,Le).length;e(this,R)&&a&&e(this,R).destroy(),(t=e(this,N).customClick)!=null&&t.enabled&&e(this,Ve)&&e(this,Ve).remove(),(s=e(this,N).audioSkip)!=null&&s.enabled&&e(this,ne)&&(e(this,ne).removeEventListener("click",this._handleSkipAds),e(this,ne).remove()),(_e||pe)&&e(this,f).removeEventListener("loadedmetadata",this._contentLoadedAction),e(this,f).removeEventListener("loadedmetadata",this._handleResizeAds),e(this,f).removeEventListener("loadedmetadata",this._loadedMetadataHandler),e(this,f).removeEventListener("ended",this._contentEndedListener),typeof window<"u"&&window.removeEventListener("resize",this._handleResizeAds),e(this,ke)&&(e(this,ke).removeEventListener("click",this._handleClickInContainer),e(this,ke).remove()),this.loadPromise=null,this.loadedAd=!1,o(this,Be,!1),o(this,Ie,!1),o(this,At,0),o(this,Ye,0),o(this,et,null)}resizeAds(t,s){if(e(this,R)){const i=e(this,f),n=i.getAttribute("data-fullscreen")==="true"?google.ima.ViewMode.FULLSCREEN:google.ima.ViewMode.NORMAL;let a=t;const l=t?t.toString():"";t&&l.indexOf("%")>-1&&e(this,f).parentElement&&(a=e(this,f).parentElement.offsetWidth*(parseInt(l,10)/100));let r=s;const d=s?s.toString():"";s&&d.indexOf("%")>-1&&e(this,f).parentElement&&(r=e(this,f).parentElement.offsetHeight*(parseInt(d,10)/100));let u;u&&typeof window<"u"&&window.cancelAnimationFrame(u),typeof window<"u"&&(u=window.requestAnimationFrame(()=>{e(this,R).resize(a||i.offsetWidth,r||i.offsetHeight,n)}))}}getAdsManager(){return e(this,R)}getAdsLoader(){return e(this,Pe)}started(){return e(this,We)}set src(t){o(this,Le,t)}set isDone(t){o(this,Be,t)}set playRequested(t){o(this,Ie,t)}set volume(t){e(this,R)&&(o(this,Dt,t),e(this,R).setVolume(t),this._setMediaVolume(t),o(this,ze,t===0))}get volume(){return e(this,R)?e(this,R).getVolume():e(this,es)}set muted(t){e(this,R)&&(t?(e(this,R).setVolume(0),o(this,ze,!0),this._setMediaVolume(0)):(e(this,R).setVolume(e(this,Dt)),o(this,ze,!1),this._setMediaVolume(e(this,Dt))))}get muted(){return e(this,ze)}set currentTime(t){o(this,Ye,t)}get currentTime(){return e(this,Ye)}get duration(){return e(this,At)}get paused(){return!e(this,Oe)}get ended(){return e(this,kt)}_assign(t){var s,i;const n=t.getAd();switch(n&&o(this,et,n),t.type){case google.ima.AdEvent.Type.LOADED:if(!n.isLinear())this._onContentResumeRequested();else if(Ht&&Re(e(this,f))&&(e(this,f).controls=!1),o(this,At,n.getDuration()),o(this,Ye,n.getDuration()),!e(this,Cs)&&!_e&&!pe){const d=y("waiting");e(this,f).dispatchEvent(d);const u=y("loadedmetadata");e(this,f).dispatchEvent(u),this.resizeAds()}break;case google.ima.AdEvent.Type.STARTED:if(n.isLinear()){e(this,f).parentElement&&!e(this,f).parentElement.classList.contains("op-ads--active")&&e(this,f).parentElement.classList.add("op-ads--active"),e(this,ce).paused||e(this,ce).pause(),o(this,Oe,!0);const d=y("play");e(this,f).dispatchEvent(d);let u;if(u||(this.resizeAds(),u=!0),e(this,ce).ended){o(this,kt,!1);const A=y("adsmediaended");e(this,f).dispatchEvent(A)}typeof window<"u"&&o(this,ot,window.setInterval(()=>{if(e(this,Oe)===!0){o(this,Ye,Math.round(e(this,R).getRemainingTime()));const A=y("timeupdate");e(this,f).dispatchEvent(A)}},350))}break;case google.ima.AdEvent.Type.COMPLETE:case google.ima.AdEvent.Type.SKIPPED:if(n.isLinear()){if(t.type===google.ima.AdEvent.Type.SKIPPED){const d=y("adsskipped");e(this,f).dispatchEvent(d)}e(this,f).parentElement&&e(this,f).parentElement.classList.remove("op-ads--active"),o(this,Oe,!1),clearInterval(e(this,ot))}break;case google.ima.AdEvent.Type.VOLUME_CHANGED:this._setMediaVolume(this.volume);break;case google.ima.AdEvent.Type.VOLUME_MUTED:if(n.isLinear()){const d=y("volumechange");e(this,f).dispatchEvent(d)}break;case google.ima.AdEvent.Type.ALL_ADS_COMPLETED:if(n.isLinear()&&(o(this,Oe,!1),o(this,kt,!0),o(this,ot,0),o(this,ze,!1),o(this,We,!1),o(this,et,null),e(this,f).parentElement&&e(this,f).parentElement.classList.remove("op-ads--active"),this.destroy(),e(this,f).currentTime>=e(this,f).duration)){const d=y("ended");e(this,f).dispatchEvent(d)}break;case google.ima.AdEvent.Type.CLICK:const a=y("pause");e(this,f).dispatchEvent(a);break;case google.ima.AdEvent.Type.AD_BREAK_READY:e(this,N).autoPlayAdBreaks||this.play();break;case google.ima.AdEvent.Type.AD_PROGRESS:const l=t.getAdData(),r=e(this,et)?e(this,et).getSkipTimeOffset():-1;if(e(this,ne))if(r!==-1){const d=e(this,R).getAdSkippableState(),u=Math.ceil(r-l.currentTime);e(this,ne).classList.remove("hidden"),d?(e(this,ne).textContent=((s=e(this,N).audioSkip)==null?void 0:s.label)||"",e(this,ne).classList.remove("disabled")):(e(this,ne).textContent=((i=e(this,N).audioSkip)==null?void 0:i.remainingLabel.replace("[[secs]]",u.toString()))||"",e(this,ne).classList.add("disabled"))}else e(this,ne).classList.add("hidden");break}if(t.type===google.ima.AdEvent.Type.LOG){const a=t.getAdData();if(a.adError){const l=a.adError.getMessage();console.warn(`Ad warning: Non-fatal error occurred: ${l}`);const r={detail:{data:a.adError,message:l,type:"Ads"}},d=y("playererror",r);e(this,f).dispatchEvent(d)}}else{const a=y(`ads${t.type}`);e(this,f).dispatchEvent(a)}}_error(t){const s=t.getError(),i={detail:{data:s,message:s.toString(),type:"Ads"}},n=y("playererror",i);e(this,f).dispatchEvent(n);const a=[100,101,102,300,301,302,303,400,401,402,403,405,406,407,408,409,410,500,501,502,503,900,901,1005];Array.isArray(e(this,Le))&&e(this,Le).length>1&&e(this,Ze)<e(this,Le).length-1?(Rs(this,Ze)._++,this.destroy(),o(this,We,!0),o(this,Ie,!0),this.load(!0),console.warn(`Ad warning: ${s.toString()}`)):(a.indexOf(s.getErrorCode())>-1?(e(this,R)&&e(this,R).destroy(),console.error(`Ad error: ${s.toString()}`)):console.warn(`Ad warning: ${s.toString()}`),o(this,et,null),(e(this,rt)===!0||e(this,lt)===!0||e(this,We)===!0)&&(o(this,Oe,!1),this._resumeMedia()))}_loaded(t){const s=new google.ima.AdsRenderingSettings;s.restoreCustomPlaybackStateOnAdBreakComplete=!1,s.enablePreloading=e(this,N).enablePreloading,o(this,R,t.getAdsManager(e(this,f),s)),this._start(e(this,R)),this.loadPromise=new Promise(i=>{i()})}_start(t){e(this,Ve)&&t.isCustomClickTrackingUsed()&&e(this,Ve).classList.add("op-ads__click-container--visible"),t.addEventListener(google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED,this._onContentPauseRequested,p),t.addEventListener(google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED,this._onContentResumeRequested,p),o(this,Je,[google.ima.AdEvent.Type.ALL_ADS_COMPLETED,google.ima.AdEvent.Type.CLICK,google.ima.AdEvent.Type.VIDEO_CLICKED,google.ima.AdEvent.Type.VIDEO_ICON_CLICKED,google.ima.AdEvent.Type.AD_PROGRESS,google.ima.AdEvent.Type.AD_BUFFERING,google.ima.AdEvent.Type.IMPRESSION,google.ima.AdEvent.Type.DURATION_CHANGE,google.ima.AdEvent.Type.USER_CLOSE,google.ima.AdEvent.Type.LINEAR_CHANGED,google.ima.AdEvent.Type.SKIPPABLE_STATE_CHANGED,google.ima.AdEvent.Type.AD_METADATA,google.ima.AdEvent.Type.INTERACTION,google.ima.AdEvent.Type.COMPLETE,google.ima.AdEvent.Type.FIRST_QUARTILE,google.ima.AdEvent.Type.LOADED,google.ima.AdEvent.Type.MIDPOINT,google.ima.AdEvent.Type.PAUSED,google.ima.AdEvent.Type.RESUMED,google.ima.AdEvent.Type.USER_CLOSE,google.ima.AdEvent.Type.STARTED,google.ima.AdEvent.Type.THIRD_QUARTILE,google.ima.AdEvent.Type.SKIPPED,google.ima.AdEvent.Type.VOLUME_CHANGED,google.ima.AdEvent.Type.VOLUME_MUTED,google.ima.AdEvent.Type.LOG]),e(this,N).autoPlayAdBreaks||e(this,Je).push(google.ima.AdEvent.Type.AD_BREAK_READY);const s=e(this,Lt).getControls(),i=s?s.events.mouse:{};if(Object.keys(i).forEach(n=>{e(this,ke)&&e(this,ke).addEventListener(n,i[n],p)}),e(this,Je).forEach(n=>{t.addEventListener(n,this._assign,p)}),e(this,rt)===!0||e(this,lt)===!0||e(this,Ie)===!0){if(o(this,Ie,!1),!e(this,Be)){this._initNotDoneAds();return}t.init(e(this,f).offsetWidth,e(this,f).offsetHeight,e(this,f).parentElement&&e(this,f).parentElement.getAttribute("data-fullscreen")==="true"?google.ima.ViewMode.FULLSCREEN:google.ima.ViewMode.NORMAL),t.start();const n=y("play");e(this,f).dispatchEvent(n)}else e(this,N).enablePreloading===!0&&t.init(e(this,f).offsetWidth,e(this,f).offsetHeight,e(this,f).parentElement&&e(this,f).parentElement.getAttribute("data-fullscreen")==="true"?google.ima.ViewMode.FULLSCREEN:google.ima.ViewMode.NORMAL)}_initNotDoneAds(){e(this,wt)?(o(this,Be,!0),e(this,wt).initialize(),_e||pe?(o(this,Ft,this._contentLoadedAction),e(this,f).addEventListener("loadedmetadata",this._contentLoadedAction,p),e(this,f).load()):this._contentLoadedAction()):(this.load(),this.loadedAd=!1)}_contentEndedListener(){o(this,kt,!0),o(this,Oe,!1),o(this,We,!1),e(this,Pe).contentComplete()}_onContentPauseRequested(){e(this,f).removeEventListener("ended",this._contentEndedListener),o(this,Bt,e(this,ce).currentTime),e(this,We)?e(this,ce).pause():o(this,We,!0);const t=y("play");e(this,f).dispatchEvent(t)}_onContentResumeRequested(){if(e(this,f).addEventListener("ended",this._contentEndedListener,p),e(this,f).addEventListener("loadedmetadata",this._loadedMetadataHandler,p),_e||pe)e(this,ce).src=e(this,ts),e(this,ce).load(),this._prepareMedia(),e(this,f).parentElement&&e(this,f).parentElement.classList.add("op-ads--active");else{const t=y("loadedmetadata");e(this,f).dispatchEvent(t)}}_loadedMetadataHandler(){Array.isArray(e(this,Le))?(Rs(this,Ze)._++,e(this,Ze)<=e(this,Le).length-1?(e(this,R)&&e(this,R).destroy(),e(this,Pe).contentComplete(),o(this,Ie,!0),o(this,We,!0),o(this,Be,!1),this.load(!0)):(e(this,N).autoPlayAdBreaks||this._resetAdsAfterManualBreak(),this._prepareMedia())):e(this,f).seekable.length?e(this,f).seekable.end(0)>e(this,Bt)&&(e(this,N).autoPlayAdBreaks||this._resetAdsAfterManualBreak(),this._prepareMedia()):setTimeout(this._loadedMetadataHandler,100)}_resumeMedia(){if(o(this,ot,0),o(this,ze,!1),o(this,We,!1),o(this,At,0),o(this,Ye,0),e(this,f).parentElement&&e(this,f).parentElement.classList.remove("op-ads--active"),e(this,ce).ended){const t=y("ended");e(this,f).dispatchEvent(t)}else try{e(this,ce).play(),setTimeout(()=>{const t=y("play");e(this,f).dispatchEvent(t)},50)}catch(t){console.error(t)}}_requestAds(){o(this,je,new google.ima.AdsRequest);const t=Array.isArray(e(this,Le))?e(this,Le)[e(this,Ze)]:e(this,Le);Us(t)?e(this,je).adsResponse=t:e(this,je).adTagUrl=t;const s=e(this,f).parentElement?e(this,f).parentElement.offsetWidth:0,i=e(this,f).parentElement?e(this,f).parentElement.offsetHeight:0;e(this,je).linearAdSlotWidth=s,e(this,je).linearAdSlotHeight=i,e(this,je).nonLinearAdSlotWidth=s,e(this,je).nonLinearAdSlotHeight=i/3,e(this,je).setAdWillAutoPlay(e(this,rt)),e(this,je).setAdWillPlayMuted(e(this,lt)),e(this,Pe).requestAds(e(this,je))}_contentLoadedAction(){e(this,Ft)&&(e(this,f).removeEventListener("loadedmetadata",e(this,Ft)),o(this,Ft,null)),this._requestAds()}_resetAdsAfterManualBreak(){e(this,R)&&e(this,R).destroy(),e(this,Pe).contentComplete(),o(this,Be,!1),o(this,Ie,!0)}_prepareMedia(){e(this,ce).currentTime=e(this,Bt),e(this,f).removeEventListener("loadedmetadata",this._loadedMetadataHandler),this._resumeMedia()}_setMediaVolume(t){e(this,ce).volume=t,e(this,ce).muted=t===0}_handleClickInContainer(){if(e(this,ce).paused){const t=y("paused");e(this,f).dispatchEvent(t),this.pause()}}_handleResizeAds(){this.resizeAds()}_handleSkipAds(){e(this,R).skip()}}kt=new WeakMap,Be=new WeakMap,Oe=new WeakMap,We=new WeakMap,ot=new WeakMap,Dt=new WeakMap,ze=new WeakMap,At=new WeakMap,Ye=new WeakMap,R=new WeakMap,Lt=new WeakMap,ce=new WeakMap,f=new WeakMap,Je=new WeakMap,Le=new WeakMap,Ms=new WeakMap,Pe=new WeakMap,ke=new WeakMap,Ve=new WeakMap,ne=new WeakMap,wt=new WeakMap,je=new WeakMap,rt=new WeakMap,lt=new WeakMap,Ie=new WeakMap,N=new WeakMap,Ze=new WeakMap,es=new WeakMap,Ft=new WeakMap,Bt=new WeakMap,ts=new WeakMap,Cs=new WeakMap,et=new WeakMap;const xs=class st{constructor(t,s){h(this,Mt,void 0),h(this,J,void 0),h(this,tt,void 0),h(this,_,void 0),h(this,ht,void 0),h(this,K,void 0),h(this,ue,void 0),h(this,dt,void 0),h(this,Ct,void 0),h(this,Tt,void 0),h(this,ct,void 0),h(this,jt,void 0),h(this,T,void 0),h(this,ut,void 0),h(this,St,void 0),h(this,pt,void 0);var i;this.proxy=null,o(this,tt,""),o(this,ue,{}),o(this,dt,!1),o(this,Tt,!1),o(this,ct,!1),o(this,jt,!1),o(this,ut,[]),o(this,pt,{controls:{alwaysVisible:!1,layers:{left:["play","time","volume"],middle:["progress"],right:["captions","settings","fullscreen"]}},defaultLevel:void 0,detachMenus:!1,forceNative:!0,height:0,hidePlayBtnTimer:350,labels:{auto:"Auto",captions:"CC/Subtitles",click:"Click to unmute",fullscreen:"Fullscreen",lang:{en:"English"},levels:"Quality Levels",live:"Live Broadcast",mediaLevels:"Change Quality",mute:"Mute",off:"Off",pause:"Pause",play:"Play",progressRail:"Time Rail",progressSlider:"Time Slider",settings:"Player Settings",speed:"Speed",speedNormal:"Normal",tap:"Tap to unmute",toggleCaptions:"Toggle Captions",unmute:"Unmute",volume:"Volume",volumeControl:"Volume Control",volumeSlider:"Volume Slider"},live:{showLabel:!0,showProgress:!1},media:{pauseOnClick:!1},mode:"responsive",onError:n=>console.error(n),pauseOthers:!0,progress:{allowRewind:!0,allowSkip:!0,duration:0,showCurrentTimeOnly:!1},showLoaderOnInit:!1,startTime:0,startVolume:1,step:0,useDeviceVolume:!0,width:0}),o(this,_,t instanceof HTMLMediaElement?t:document.getElementById(t)),e(this,_)&&(o(this,dt,e(this,_).autoplay||!1),typeof s!="string"&&!Array.isArray(s)&&this._mergeOptions(s),e(this,_).volume=e(this,T).startVolume||1,e(this,T).ads&&e(this,T).ads.src&&o(this,ht,e(this,T).ads.src),(((i=e(this,T))==null?void 0:i.startTime)||0)>0&&(e(this,_).currentTime=e(this,T).startTime||0),o(this,Ct,e(this,_).volume)),this._autoplay=this._autoplay.bind(this),this._enableKeyBindings=this._enableKeyBindings.bind(this)}static init(){st.instances={};const t=document.querySelectorAll("video.op-player, audio.op-player");for(let s=0,i=t.length;s<i;s++){const n=t[s],a=n.getAttribute("data-op-settings"),l=a?JSON.parse(a):{};new st(n,l).init()}}static addMedia(t,s,i,n){st.customMedia.media[s]=n,st.customMedia.optionsKey[s]=t,st.customMedia.rules.push(i)}async init(){this._isValid()&&(this._wrapInstance(),await this._prepareMedia(),this._createPlayButton(),this._createUID(),this._createControls(),this._setEvents(),st.instances[this.id]=this)}async load(){return e(this,K)?(e(this,K).loaded=!1,this.isMedia()?e(this,K).load():void 0):(await this._prepareMedia(),e(this,K).load())}async play(){return e(this,K).loaded||(await e(this,K).load(),e(this,K).loaded=!0),e(this,J)?(e(this,J).playRequested=!0,await e(this,J).loadPromise,e(this,J).play()):e(this,K).play()}pause(){e(this,J)?e(this,J).pause():e(this,K).pause()}stop(){this.pause(),e(this,K)&&(e(this,K).currentTime=0,this.src=[{src:"",type:"video/mp4"}])}destroy(){var t;e(this,J)&&(e(this,J).pause(),e(this,J).destroy()),e(this,St)&&e(this,St).destroy();const s=e(this,_);e(this,K)&&e(this,K).destroy(),Object.keys(e(this,ue)).forEach(a=>{s.removeEventListener(a,e(this,ue)[a])}),this.getContainer().removeEventListener("keydown",this._enableKeyBindings),e(this,dt)&&!e(this,jt)&&Re(e(this,_))&&s.removeEventListener("canplay",this._autoplay),e(this,Mt)&&e(this,Mt).destroy(),Re(e(this,_))&&(this.playBtn&&this.playBtn.remove(),this.loader&&this.loader.remove()),(t=e(this,T))!=null&&t.onError&&e(this,_).removeEventListener("playererror",e(this,T).onError),s.controls=!0,s.setAttribute("id",e(this,tt)),s.removeAttribute("op-live__enabled"),s.removeAttribute("op-dvr__enabled");const i=e(this,T).mode==="fit"&&!me(s)?s.closest(".op-player__fit--wrapper"):s.parentElement;i&&i.parentNode&&i.parentNode.replaceChild(s,i),delete st.instances[e(this,tt)];const n=y("playerdestroyed");s.dispatchEvent(n)}getContainer(){return e(this,_).parentElement||e(this,_)}getControls(){return e(this,Mt)}getCustomControls(){return e(this,ut)}getElement(){return e(this,_)}getEvents(){return e(this,ue)}getOptions(){return e(this,T)}activeElement(){return e(this,J)&&e(this,J).started()?e(this,J):e(this,K)}isMedia(){return this.activeElement()instanceof ns}isAd(){return this.activeElement()instanceof Ps}getMedia(){return e(this,K)}getAd(){return e(this,J)}addCaptions(t){if(t.default){const a=e(this,_).querySelectorAll("track");for(let l=0,r=a.length;l<r;l++)a[l].default=!1}const s=e(this,_);let i=s.querySelector(`track[srclang="${t.srclang}"][kind="${t.kind}"]`);i?(i.src=t.src,i.label=t.label,i.default=t.default||!1):(i=document.createElement("track"),i.srclang=t.srclang,i.src=t.src,i.kind=t.kind,i.label=t.label,i.default=t.default||!1,s.appendChild(i));const n=y("controlschanged");s.dispatchEvent(n)}addControl(t){t.custom=!0,t.type="button",e(this,ut).push(t);const s=y("controlschanged");e(this,_).dispatchEvent(s)}addElement(t){t.custom=!0,e(this,ut).push(t);const s=y("controlschanged");e(this,_).dispatchEvent(s)}removeControl(t){e(this,ut).forEach((i,n)=>{i.id===t&&e(this,ut).splice(n,1)});const s=y("controlschanged");e(this,_).dispatchEvent(s)}async _prepareMedia(){var t;try{(t=e(this,T))!=null&&t.onError&&e(this,_).addEventListener("playererror",e(this,T).onError,p),e(this,dt)&&Re(e(this,_))&&e(this,_).addEventListener("canplay",this._autoplay,p),o(this,K,new ns(e(this,_),e(this,T),e(this,dt),st.customMedia));const s=e(this,_).getAttribute("preload");if((e(this,ht)||!s||s!=="none")&&(await e(this,K).load(),e(this,K).loaded=!0),!e(this,dt)&&e(this,ht)){const i=e(this,T)&&e(this,T).ads?e(this,T).ads:void 0;o(this,J,new Ps(this,e(this,ht),!1,!1,i))}}catch(s){console.error(s)}}enableDefaultPlayer(){let t=!0,s=0;this.proxy&&!this.proxy.paused&&(t=!1,s=this.proxy.currentTime,this.proxy.pause()),this.proxy=this,this.getElement().addEventListener("loadedmetadata",()=>{this.getMedia().currentTime=s,t||this.play()})}async loadAd(t){try{if(this.isAd())this.getAd().destroy(),this.getAd().src=t,this.getAd().loadedAd=!1,this.getAd().load();else{const s=e(this,T)&&e(this,T).ads?e(this,T).ads:void 0,i=!this.activeElement().paused||e(this,Tt);o(this,J,new Ps(this,t,i,e(this,ct),s))}}catch(s){console.error(s)}}set src(t){e(this,K)instanceof ns?(e(this,K).mediaFiles=[],e(this,K).src=t):typeof t=="string"?e(this,_).src=t:Array.isArray(t)?t.forEach(s=>{const i=document.createElement("source");i.src=s.src,i.type=s.type||is(s.src,e(this,_)),e(this,_).appendChild(i)}):typeof t=="object"&&(e(this,_).src=t.src)}get src(){return e(this,K).src}get id(){return e(this,tt)}_isValid(){const t=e(this,_);return!(!(t instanceof HTMLElement)||!me(t)&&!Re(t)||!t.classList.contains("op-player__media"))}_wrapInstance(){const t=document.createElement("div");t.className="op-player op-player__keyboard--inactive",t.className+=me(e(this,_))?" op-player__audio":" op-player__video",t.tabIndex=0,e(this,_).classList.remove("op-player"),e(this,_).parentElement&&e(this,_).parentElement.insertBefore(t,e(this,_)),t.appendChild(e(this,_));const s=document.createElement("div");if(s.className="op-status",s.innerHTML="<span></span>",s.tabIndex=-1,s.setAttribute("aria-hidden","true"),Re(e(this,_))&&e(this,_).parentElement&&e(this,_).parentElement.insertBefore(s,e(this,_)),t.addEventListener("keydown",()=>{t.classList.contains("op-player__keyboard--inactive")&&t.classList.remove("op-player__keyboard--inactive")},p),t.addEventListener("click",()=>{t.classList.contains("op-player__keyboard--inactive")||t.classList.add("op-player__keyboard--inactive")},p),e(this,T).mode==="fill"&&!me(e(this,_))&&!Ht)this.getContainer().classList.add("op-player__full");else if(e(this,T).mode==="fit"&&!me(e(this,_))){const i=this.getContainer();if(i.parentElement){const n=document.createElement("div");n.className="op-player__fit--wrapper",n.tabIndex=0,i.parentElement.insertBefore(n,i),n.appendChild(i),i.classList.add("op-player__fit")}}else{let i="";if(e(this,T).width){const n=typeof e(this,T).width=="number"?`${e(this,T).width}px`:e(this,T).width;i+=`width: ${n} !important;`}if(e(this,T).height){const n=typeof e(this,T).height=="number"?`${e(this,T).height}px`:e(this,T).height;i+=`height: ${n} !important;`}i&&t.setAttribute("style",i)}}_createControls(){Ht&&Re(e(this,_))&&this.getContainer().classList.add("op-player__ios--iphone"),o(this,Mt,new si(this)),e(this,Mt).create()}_createUID(){if(e(this,_).id)o(this,tt,e(this,_).id),e(this,_).removeAttribute("id");else{const t=crypto,s=typeof t.getRandomBytes=="function"?t.getRandomBytes:t.getRandomValues;o(this,tt,`op_${s(new Uint32Array(1))[0].toString(36).substr(2,9)}`)}e(this,_).parentElement&&(e(this,_).parentElement.id=e(this,tt))}_createPlayButton(){var t,s;me(e(this,_))||(this.playBtn=document.createElement("button"),this.playBtn.className="op-player__play",this.playBtn.tabIndex=0,this.playBtn.title=((t=e(this,T).labels)==null?void 0:t.play)||"",this.playBtn.innerHTML=`<span>${((s=e(this,T).labels)==null?void 0:s.play)||""}</span>`,this.playBtn.setAttribute("aria-pressed","false"),this.playBtn.setAttribute("aria-hidden","false"),this.loader=document.createElement("span"),this.loader.className="op-player__loader",this.loader.tabIndex=-1,this.loader.setAttribute("aria-hidden","true"),e(this,_).parentElement&&(e(this,_).parentElement.insertBefore(this.loader,e(this,_)),e(this,_).parentElement.insertBefore(this.playBtn,e(this,_))),this.playBtn.addEventListener("click",()=>{e(this,J)&&(e(this,J).playRequested=this.activeElement().paused),this.activeElement().paused?this.activeElement().play():this.activeElement().pause()},p))}_setEvents(){if(Re(e(this,_))){e(this,ue).loadedmetadata=()=>{const s=this.activeElement();e(this,T).showLoaderOnInit&&!_e&&!pe?(this.loader.setAttribute("aria-hidden","false"),this.playBtn.setAttribute("aria-hidden","true")):(this.loader.setAttribute("aria-hidden","true"),this.playBtn.setAttribute("aria-hidden","false")),s.paused&&(this.playBtn.classList.remove("op-player__play--paused"),this.playBtn.setAttribute("aria-pressed","false"))},e(this,ue).waiting=()=>{this.playBtn.setAttribute("aria-hidden","true"),this.loader.setAttribute("aria-hidden","false")},e(this,ue).seeking=()=>{const s=this.activeElement();this.playBtn.setAttribute("aria-hidden","true"),this.loader.setAttribute("aria-hidden",s instanceof ns?"false":"true")},e(this,ue).seeked=()=>{const s=this.activeElement();Math.round(s.currentTime)===0?(this.playBtn.setAttribute("aria-hidden","true"),this.loader.setAttribute("aria-hidden","false")):(this.playBtn.setAttribute("aria-hidden",s instanceof ns?"false":"true"),this.loader.setAttribute("aria-hidden","true"))},e(this,ue).play=()=>{var s;this.playBtn.classList.add("op-player__play--paused"),this.playBtn.title=((s=e(this,T).labels)==null?void 0:s.pause)||"",this.loader.setAttribute("aria-hidden","true"),e(this,T).showLoaderOnInit?this.playBtn.setAttribute("aria-hidden","true"):setTimeout(()=>{this.playBtn.setAttribute("aria-hidden","true")},e(this,T).hidePlayBtnTimer)},e(this,ue).playing=()=>{this.loader.setAttribute("aria-hidden","true"),this.playBtn.setAttribute("aria-hidden","true")},e(this,ue).pause=()=>{var s;const i=this.activeElement();this.playBtn.classList.remove("op-player__play--paused"),this.playBtn.title=((s=e(this,T).labels)==null?void 0:s.play)||"",e(this,T).showLoaderOnInit&&Math.round(i.currentTime)===0?(this.playBtn.setAttribute("aria-hidden","true"),this.loader.setAttribute("aria-hidden","false")):(this.playBtn.setAttribute("aria-hidden","false"),this.loader.setAttribute("aria-hidden","true"))},e(this,ue).ended=()=>{this.loader.setAttribute("aria-hidden","true"),this.playBtn.setAttribute("aria-hidden","true")};let t=!1;e(this,ue).timeupdate=()=>{if(e(this,_).loop&&this.isMedia()&&e(this,J)){const s=this.getMedia(),i=s.duration-s.currentTime;if(i>0&&i<=.25&&!t){t=!0;const n=y("ended");e(this,_).dispatchEvent(n)}else i===0&&(t=!1)}}}Object.keys(e(this,ue)).forEach(t=>{e(this,_).addEventListener(t,e(this,ue)[t],p)}),this.getContainer().addEventListener("keydown",this._enableKeyBindings,p)}_autoplay(){e(this,jt)||(o(this,jt,!0),e(this,_).removeEventListener("canplay",this._autoplay),Xs(e(this,_),e(this,Ct),t=>{o(this,Tt,t)},t=>{o(this,ct,t)},()=>{var t,s;if(e(this,ct)){this.activeElement().muted=!0,this.activeElement().volume=0;const i=y("volumechange");e(this,_).dispatchEvent(i);const n=document.createElement("div"),a=_e||pe?(t=e(this,T).labels)==null?void 0:t.tap:(s=e(this,T).labels)==null?void 0:s.click;n.className="op-player__unmute",n.innerHTML=`<span>${a}</span>`,n.tabIndex=0,n.addEventListener("click",()=>{this.activeElement().muted=!1,this.activeElement().volume=e(this,Ct);const r=y("volumechange");e(this,_).dispatchEvent(r),n.remove()},p);const l=this.getContainer();l.insertBefore(n,l.firstChild)}else this.activeElement().muted=e(this,_).muted,this.activeElement().volume=e(this,Ct);if(e(this,ht)){const i=e(this,T)&&e(this,T).ads?e(this,T).ads:void 0;o(this,J,new Ps(this,e(this,ht),e(this,Tt),e(this,ct),i))}else(e(this,Tt)||e(this,ct))&&this.play()}))}_mergeOptions(t){const s={...t||{}};if(o(this,T,{...e(this,pt),...s}),Object.keys(e(this,pt)).filter(n=>n!=="labels"&&typeof e(this,pt)[n]=="object").forEach(n=>{const a=s[n]||{};a&&Object.keys(a).length&&(e(this,T)[n]={...e(this,pt)[n],...a})}),s.labels){const n=s.labels?Object.keys(s.labels):[];let a={};n.forEach(l=>{const r=s.labels?s.labels[l]:null;r&&typeof r=="object"&&l==="lang"?Object.keys(r).forEach(d=>{const u=r?r[d]:null;u&&(a={...a,lang:{...a.lang,[d]:Ne(u)}})}):r&&(a={...a,[l]:Ne(r)})}),e(this,T).labels={...e(this,pt).labels,...a}}}_enableKeyBindings(t){var s,i;const n=t.which||t.keyCode||0,a=this.activeElement(),l=this.isAd(),r=(s=document?.activeElement)==null?void 0:s.classList.contains("op-player");switch(n){case 13:case 32:case 75:(r&&(n===13||n===32)||n===75)&&(a.paused?a.play():a.pause()),t.preventDefault(),t.stopPropagation();break;case 35:!l&&a.duration!==1/0&&(a.currentTime=a.duration,t.preventDefault(),t.stopPropagation());break;case 36:l||(a.currentTime=0,t.preventDefault(),t.stopPropagation());break;case 37:case 39:case 74:case 76:if(!l&&a.duration!==1/0){let u=5;const A=this.getOptions().step;A?u=n===74||n===76?A*2:A:(n===74||n===76)&&(u=10);const m=a.duration!==1/0?u:((i=this.getOptions().progress)==null?void 0:i.duration)||0;a.currentTime+=n===37||n===74?m*-1:m,a.currentTime<0?a.currentTime=0:a.currentTime>=a.duration&&(a.currentTime=a.duration),t.preventDefault(),t.stopPropagation()}break;case 38:case 40:const d=n===38?Math.min(a.volume+.1,1):Math.max(a.volume-.1,0);a.volume=d,a.muted=!(d>0),t.preventDefault(),t.stopPropagation();break;case 70:Re(e(this,_))&&!t.ctrlKey&&(o(this,St,new js(this,"","")),typeof e(this,St).fullScreenEnabled<"u"&&(e(this,St).toggleFullscreen(),t.preventDefault(),t.stopPropagation()));break;case 77:a.muted=!a.muted,a.muted?a.volume=0:a.volume=e(this,Ct),t.preventDefault(),t.stopPropagation();break;case 188:case 190:if(!l&&t.shiftKey){const u=a;u.playbackRate=n===188?Math.max(u.playbackRate-.25,.25):Math.min(u.playbackRate+.25,2);const A=this.getContainer().querySelector(".op-status>span");A&&(A.textContent=`${u.playbackRate}x`,A.parentElement&&A.parentElement.setAttribute("aria-hidden","false"),setTimeout(()=>{A.parentElement&&A.parentElement.setAttribute("aria-hidden","true")},500));const m=y("controlschanged");dispatchEvent(m),t.preventDefault(),t.stopPropagation()}else!l&&a.paused&&(a.currentTime+=1/25*(n===188?-1:1),t.preventDefault(),t.stopPropagation());break}}};Mt=new WeakMap,J=new WeakMap,tt=new WeakMap,_=new WeakMap,ht=new WeakMap,K=new WeakMap,ue=new WeakMap,dt=new WeakMap,Ct=new WeakMap,Tt=new WeakMap,ct=new WeakMap,jt=new WeakMap,T=new WeakMap,ut=new WeakMap,St=new WeakMap,pt=new WeakMap,xs.instances={},xs.customMedia={media:{},optionsKey:{},rules:[]};let Is=xs;const $s=Is;typeof window<"u"&&(window.OpenPlayer=Is,window.OpenPlayerJS=Is,Is.init());export{$s as default};
//# sourceMappingURL=openplayer.es.js.map
